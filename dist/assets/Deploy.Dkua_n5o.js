/*! Build: 2025-07-17T07:59:15.523Z
Version: 0.0.0 */
import{u as e,r as s,j as t,n as a,A as l,G as r,f as i,C as n,aM as c,as as d,R as m,aG as o,z as x}from"./vendor-react.D8SVeCGP.js";import{C as u,B as h}from"./components-admin.GT3qRZg5.js";import{m as y,o as p,q as j,r as N,t as f}from"./utils.C9ZsMnW6.js";import"./vendor-misc.qnLj5toF.js";import"./hooks.CTtJlocA.js";import"./vendor-stripe.B5MJ2ewd.js";import"./pages-dog.BrfoFXaJ.js";import"./vendor-supabase.RBPF72ft.js";function g(){const g=e(),[b,v]=s.useState(!1),[w,_]=s.useState(!1),[S,k]=s.useState(null),[L,O]=s.useState(null),[R,C]=s.useState(null),[J,U]=s.useState(!1);s.useEffect((()=>{const e=y("lastDeployment");if(e)try{const s=JSON.parse(e);k(s),s.site_id&&s.deploy_id&&I(s.site_id,s.deploy_id)}catch(s){!function(){try{"undefined"!=typeof window&&window.localStorage&&window.localStorage.removeItem("lastDeployment")}catch(e){}}()}}),[]);const D=async()=>{try{v(!0),O(null),C(null);const e=await N();k(e),C("デプロイが開始されました！ステータスを確認してください。"),j("lastDeployment",JSON.stringify(e)),q(e);const s=setInterval((async()=>{try{const t=await p(e.site_id,e.deploy_id);k(t),["ready","error","failed"].includes(t.status)&&(clearInterval(s),"ready"===t.status?C("デプロイが完了しました！以下のURLでサイトを確認できます。"):O("デプロイに失敗しました。詳細はNetlifyダッシュボードで確認してください。")),j("lastDeployment",JSON.stringify(t)),H(t)}catch(t){}}),5e3);return()=>clearInterval(s)}catch(e){O(e.message||"デプロイに失敗しました")}finally{v(!1)}},I=async(e,s)=>{try{_(!0),O(null);const t=await p(e,s);k(t),j("lastDeployment",JSON.stringify(t)),H(t),"ready"===t.status?C("デプロイが完了しています！以下のURLでサイトを確認できます。"):["error","failed"].includes(t.status)?O("デプロイに失敗しました。詳細はNetlifyダッシュボードで確認してください。"):C("デプロイは進行中です。ステータスを確認してください。")}catch(t){O(t.message||"デプロイステータスの確認に失敗しました")}finally{_(!1)}},q=e=>{try{const s=y("deploymentHistory");let t=s?JSON.parse(s):[];t.unshift({...e,created_at:(new Date).toISOString()}),t.length>10&&(t=t.slice(0,10)),j("deploymentHistory",JSON.stringify(t))}catch(s){}},H=e=>{try{const s=y("deploymentHistory");if(!s)return;let t=JSON.parse(s);t=t.map((s=>s.deploy_id===e.deploy_id?{...s,status:e.status,deploy_url:e.deploy_url}:s)),j("deploymentHistory",JSON.stringify(t))}catch(s){}};return t.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[t.jsx("div",{className:"flex items-center space-x-4 mb-6",children:t.jsxs(a,{to:"/dashboard",className:"flex items-center text-gray-600 hover:text-gray-800 transition-colors",children:[t.jsx(l,{className:"w-4 h-4 mr-2"}),"ダッシュボードに戻る"]})}),t.jsxs("div",{className:"text-center mb-8",children:[t.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-4 flex items-center justify-center",children:[t.jsx(r,{className:"w-8 h-8 text-blue-600 mr-3"}),"サイトをデプロイ"]}),t.jsx("p",{className:"text-lg text-gray-600",children:"あなたのアプリケーションをNetlifyにデプロイします"})]}),L&&t.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start",children:[t.jsx(i,{className:"w-5 h-5 text-red-600 mt-0.5 mr-3 flex-shrink-0"}),t.jsx("p",{className:"text-red-800",children:L})]}),R&&t.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start",children:[t.jsx(n,{className:"w-5 h-5 text-green-600 mt-0.5 mr-3 flex-shrink-0"}),t.jsx("p",{className:"text-green-800",children:R})]}),t.jsxs(u,{className:"p-6",children:[t.jsx("h2",{className:"text-xl font-semibold mb-6",children:"デプロイ設定"}),t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx(r,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),t.jsxs("div",{className:"text-sm text-blue-800",children:[t.jsx("p",{className:"font-medium mb-1",children:"Netlifyデプロイについて"}),t.jsx("p",{children:"このツールを使用すると、現在のプロジェクトをNetlifyに自動的にデプロイできます。デプロイが完了すると、公開URLが提供されます。"})]})]})}),S?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("h3",{className:"font-semibold mb-2",children:"最新のデプロイ情報"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"ステータス:"}),t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(e=>{switch(e){case"ready":return"text-green-600 bg-green-100";case"error":case"failed":return"text-red-600 bg-red-100";case"building":case"enqueued":case"processing":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}})(S.status)}`,children:(e=>{switch(e){case"ready":return"完了";case"error":case"failed":return"失敗";case"building":return"ビルド中";case"enqueued":return"待機中";case"processing":return"処理中";default:return e}})(S.status)})]}),S.deploy_url&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"公開URL:"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("a",{href:S.deploy_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 flex items-center",children:[S.deploy_url.replace(/^https?:\/\//,""),t.jsx(c,{className:"w-3 h-3 ml-1"})]}),t.jsx("button",{onClick:()=>{return e=S.deploy_url,void navigator.clipboard.writeText(e).then((()=>{U(!0),setTimeout((()=>U(!1)),2e3)}));var e},className:"text-gray-500 hover:text-gray-700",title:"URLをコピー",children:t.jsx(d,{className:"w-4 h-4"})})]})]}),S.claim_url&&!S.claimed&&t.jsx("div",{className:"mt-2",children:t.jsxs("a",{href:S.claim_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 flex items-center",children:["Netlifyでサイトを管理する",t.jsx(c,{className:"w-3 h-3 ml-1"})]})})]})]}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsxs(h,{onClick:()=>{(null==S?void 0:S.site_id)&&(null==S?void 0:S.deploy_id)&&I(S.site_id,S.deploy_id)},variant:"secondary",isLoading:w,children:[t.jsx(m,{className:"w-4 h-4 mr-2"}),"ステータスを更新"]}),t.jsxs(h,{onClick:D,isLoading:b,disabled:["building","enqueued","processing"].includes(S.status),children:[t.jsx(r,{className:"w-4 h-4 mr-2"}),"再デプロイ"]}),t.jsxs(h,{onClick:()=>g("/deployment-history"),variant:"secondary",children:[t.jsx(o,{className:"w-4 h-4 mr-2"}),"デプロイ履歴"]})]})]}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs(h,{onClick:D,isLoading:b,className:"w-full",children:[t.jsx(r,{className:"w-4 h-4 mr-2"}),"Netlifyにデプロイ"]}),t.jsxs(h,{onClick:async()=>{try{_(!0),O(null),"ready"===(await f({})).status&&C("デプロイが完了しています！以下のURLでサイトを確認できます。")}catch(e){O(e.message||"デプロイステータスの確認に失敗しました")}finally{_(!1)}},variant:"secondary",isLoading:w,className:"w-full",children:[t.jsx(x,{className:"w-4 h-4 mr-2"}),"デプロイステータスを確認"]})]}),J&&t.jsx("div",{className:"text-center text-sm text-green-600",children:"URLをコピーしました！"})]})]}),t.jsxs(u,{className:"p-6 bg-gray-50",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"デプロイについての注意事項"}),t.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[t.jsx("p",{children:"• デプロイには数分かかる場合があります"}),t.jsx("p",{children:"• デプロイが完了すると、公開URLが提供されます"}),t.jsx("p",{children:"• Netlifyアカウントをお持ちの場合は、サイトを自分のアカウントに移行できます"}),t.jsx("p",{children:"• 環境変数は自動的に設定されます"}),t.jsx("p",{children:"• 問題が発生した場合は、Netlifyダッシュボードで詳細を確認してください"})]})]})]})}export{g as Deploy};
