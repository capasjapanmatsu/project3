import{j as e}from"./ui-vendor-CTwuE44L.js";import{r as a,u as t,d as s,R as r}from"./react-vendor-BBLDtDmh.js";import{B as l,s as n}from"./index-BbveZyU8.js";import"./query-vendor-9fkSW1iq.js";import"./supabase-vendor-BcfcqyaE.js";function c(){const[c,o]=a.useState(""),[d,i]=a.useState(null),[m,u]=a.useState(!1),[f,h]=a.useState(null),[x,p]=a.useState(!1),j=t(),g=s(),b=new URLSearchParams(g.search).get("factorId");r.useEffect(()=>{(async()=>{if(b){u(!0),i(null);try{const{data:e,error:a}=await n.auth.mfa.challenge({factorId:b});if(a)throw a;h(e.id),p(!0)}catch(e){i(e.message||"チャレンジ作成に失敗しました")}finally{u(!1)}}})()},[b]);return e.jsxs("div",{className:"max-w-md mx-auto p-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"2ファクタ認証コード入力"}),e.jsx("p",{className:"mb-2",children:"認証アプリで生成された6桁のコードを入力してください。"}),e.jsx("input",{type:"text",value:c,onChange:e=>o(e.target.value),maxLength:6,className:"border px-2 py-1 mb-4 w-full text-center text-lg tracking-widest",placeholder:"123456",autoFocus:!0,disabled:!x}),d&&e.jsx("p",{className:"text-red-600 mb-4",children:d}),e.jsx(l,{onClick:async()=>{if(f&&b){u(!0),i(null);try{const{error:e}=await n.auth.mfa.verify({factorId:b,challengeId:f,code:c});if(e)throw e;j("/dashboard")}catch(e){i(e.message||"認証に失敗しました")}finally{u(!1)}}},disabled:m||6!==c.length||!x,children:"認証する"})]})}export{c as default};
