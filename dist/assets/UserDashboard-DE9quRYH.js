import{j as e,B as s,u as a,c as t,s as r}from"./index-T-nty6Ge.js";import{L as l,u as n,d as i,r as c}from"./vendor-BHVjIt_u.js";import{C as d}from"./Card-DW8Xk96S.js";import{D as o,a as m,g as x}from"./DogCard-DmuhXJFM.js";import{g,B as h,p,q as u,e as j,r as f,i as N,P as b,h as v,s as w,t as y,d as _,u as D,v as S,w as k,x as C,X as E,m as F,y as R,z as V,C as $,L as U}from"./ui-srxHNTHo.js";import{v as q,h as I}from"./vaccineUploadFixed-BUJgU_FH.js";import"./supabase-CKbzEL5D.js";import"./Input-B9o2mE6T.js";import"./Select-vQESp9mw.js";import"./dogBreeds-6lxY8Uni.js";import"./VaccineBadge-8kOlr-l0.js";const L=({dogs:s,user:a,selectedDog:t,showDogEditModal:r,isUpdatingDog:l,dogUpdateError:n,dogUpdateSuccess:i,dogFormData:c,dogImageFile:x,dogImagePreview:h,rabiesVaccineFile:p,comboVaccineFile:u,rabiesExpiryDate:j,comboExpiryDate:f,onDogSelect:N,onCloseDogEditModal:b,onUpdateDog:v,onDeleteDog:w,onDogImageSelect:y,onDogImageRemove:_,onRabiesVaccineSelect:D,onComboVaccineSelect:S,onFormDataChange:k,onRabiesExpiryDateChange:C,onComboExpiryDateChange:E})=>e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ•"}),"ç™»éŒ²æ¸ˆã¿ã®æ„›çŠ¬"]}),e.jsxs("a",{href:"/register-dog",className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-md text-sm font-medium inline-flex items-center",children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"æ„›çŠ¬ã‚’ç™»éŒ²"]})]}),0===s.length?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ•"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"ã¾ã æ„›çŠ¬ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“"}),e.jsx("p",{className:"text-sm mb-4",children:"ãƒ‰ãƒƒã‚°ãƒ©ãƒ³ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã«ã€æ„›çŠ¬ã®æƒ…å ±ã‚’ç™»éŒ²ã—ã¦ãã ã•ã„"}),e.jsxs("a",{href:"/register-dog",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md font-medium inline-flex items-center",children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"æ„›çŠ¬ã‚’ç™»éŒ²"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map((s=>e.jsx(o,{dog:s,onEdit:()=>N(s)},s.id)))}),r&&t&&e.jsx(m,{dog:t,isUpdating:l,error:n,success:i,dogFormData:c,dogImagePreview:h,onClose:b,onSubmit:v,onDelete:w,onFormChange:k,onImageSelect:y,onImageRemove:_,rabiesVaccineFile:p,comboVaccineFile:u,rabiesExpiryDate:j,comboExpiryDate:f,onRabiesVaccineSelect:D,onComboVaccineSelect:S,onRabiesExpiryDateChange:C,onComboExpiryDateChange:E})]}),M=({notifications:a,onMarkAsRead:t})=>{const r=s=>{switch(s){case"reservation":return e.jsx(N,{className:"w-4 h-4 text-blue-600"});case"message":return e.jsx(f,{className:"w-4 h-4 text-green-600"});case"park_approval":return e.jsx(j,{className:"w-4 h-4 text-purple-600"});case"vaccine_approval":return e.jsx(u,{className:"w-4 h-4 text-green-600"});default:return e.jsx(h,{className:"w-4 h-4 text-gray-600"})}};return e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[e.jsx(h,{className:"w-5 h-5 mr-2"}),"é€šçŸ¥",a.length>0&&e.jsx("span",{className:"ml-2 bg-red-500 text-white text-xs rounded-full px-2 py-1",children:a.length})]}),a.length>0&&e.jsxs(s,{variant:"secondary",size:"sm",onClick:()=>{a.forEach((e=>{t(e.id)}))},children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"ã™ã¹ã¦æ—¢èª­ã«ã™ã‚‹"]})]}),0===a.length?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸ””"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"æ–°ã—ã„é€šçŸ¥ã¯ã‚ã‚Šã¾ã›ã‚“"}),e.jsx("p",{className:"text-sm",children:"æœ€æ–°ã®æƒ…å ±ã‚„ãŠçŸ¥ã‚‰ã›ãŒã‚ã‚‹ã¨ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™"})]}):e.jsx("div",{className:"space-y-4",children:a.map((a=>e.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:r(a.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:a.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(a.created_at).toLocaleString("ja-JP")})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(s,{variant:"secondary",size:"sm",onClick:()=>t(a.id),className:"text-gray-600 hover:text-gray-800",children:e.jsx(p,{className:"w-4 h-4"})})})]},a.id)))})]})},P=({recentDogs:a,recentDogsError:t,isLoading:r=!1})=>{const l=e=>{const s=new Date(e),a=(new Date).getTime()-s.getTime(),t=Math.floor(a/864e5);return 0===t?"ä»Šæ—¥":1===t?"æ˜¨æ—¥":t<7?`${t}æ—¥å‰`:t<30?`${Math.floor(t/7)}é€±é–“å‰`:s.toLocaleDateString("ja-JP",{month:"short",day:"numeric"})};return r?e.jsx(d,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):t?e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"text-center py-8 text-red-500",children:[e.jsx(b,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ"}),e.jsx("p",{className:"text-sm",children:t})]})}):e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[e.jsx(v,{className:"w-5 h-5 mr-2"}),"æœ€è¿‘ä»²é–“å…¥ã‚Šã—ãŸãƒ¯ãƒ³ã¡ã‚ƒã‚“"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(w,{className:"w-4 h-4 mr-1"}),"æœ€æ–°8é ­"]})]}),0===a.length?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸ•"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"ã¾ã æ–°ã—ã„ä»²é–“ã¯ã„ã¾ã›ã‚“"}),e.jsx("p",{className:"text-sm",children:"æ–°ã—ãç™»éŒ²ã•ã‚ŒãŸãƒ¯ãƒ³ã¡ã‚ƒã‚“ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™"})]}):e.jsxs("div",{className:"space-y-4",children:[a.map((s=>e.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"flex-shrink-0 relative",children:[e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden border-2 border-white shadow-md",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="https://images.pexels.com/photos/58997/pexels-photo-58997.jpeg?auto=compress&cs=tinysrgb&w=300"}}):e.jsx("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:e.jsx(b,{className:"w-8 h-8 text-gray-400"})})}),e.jsx("div",{className:"absolute -top-1 -right-1 bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold",children:"âœ¨"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 truncate",children:[s.name,x(s.gender)]}),e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:s.breed})]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["ã‚ªã‚¹"===s.gender?"â™‚":"â™€"," ",s.gender]}),e.jsxs("span",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(w,{className:"w-3 h-3 mr-1"}),l(s.created_at),"ã«ç™»éŒ²"]})]})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"w-5 h-5 text-pink-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Welcome!"})]})})]},s.id))),8===a.length&&e.jsx("div",{className:"text-center pt-4",children:e.jsxs(s,{variant:"secondary",size:"sm",onClick:()=>{},children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"ã‚‚ã£ã¨è¦‹ã‚‹"]})})]})]})},B=({icon:s,label:a,value:t,color:r,trend:l})=>{const n={up:e.jsx(C,{className:"w-4 h-4 text-green-500"}),down:e.jsx(k,{className:"w-4 h-4 text-red-500"}),neutral:e.jsx(S,{className:"w-4 h-4 text-gray-500"})};return e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${{blue:"bg-blue-50 text-blue-600",green:"bg-green-50 text-green-600",purple:"bg-purple-50 text-purple-600",orange:"bg-orange-50 text-orange-600"}[r]}`,children:s}),e.jsx("div",{className:"flex items-center space-x-1",children:n[l]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t}),e.jsx("p",{className:"text-sm text-gray-600",children:a})]})]})},T=({dogs:s,ownedParks:a,recentReservations:t,profile:r})=>{const l={approved:s.filter((e=>e.vaccine_certifications?.some((e=>"approved"===e.status)))).length,pending:s.filter((e=>e.vaccine_certifications?.some((e=>"pending"===e.status)))).length,total:s.length},n={approved:a.filter((e=>"approved"===e.status)).length,pending:a.filter((e=>"pending"===e.status)).length,total:a.length},i=(()=>{const e=new Date;e.setDate(1),e.setHours(0,0,0,0);return{monthly:t.filter((s=>new Date(s.created_at)>=e)).length,total:t.length}})();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(B,{icon:e.jsx(b,{className:"w-6 h-6"}),label:"ç™»éŒ²æ¸ˆã¿ã®æ„›çŠ¬",value:s.length,color:"blue",trend:s.length>0?"up":"neutral"}),e.jsx(B,{icon:e.jsx(N,{className:"w-6 h-6"}),label:"ä»Šæœˆã®äºˆç´„",value:i.monthly,color:"green",trend:i.monthly>0?"up":"neutral"}),e.jsx(B,{icon:e.jsx(j,{className:"w-6 h-6"}),label:"æ‰€æœ‰æ–½è¨­",value:a.length,color:"purple",trend:a.length>0?"up":"neutral"}),e.jsx(B,{icon:e.jsx(D,{className:"w-6 h-6"}),label:"ç·äºˆç´„æ•°",value:i.total,color:"orange",trend:i.total>0?"up":"neutral"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(D,{className:"w-5 h-5 mr-2"}),"ãƒ¯ã‚¯ãƒãƒ³è¨¼æ˜Žæ›¸ã®çŠ¶æ³"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[l.total,"é ­ä¸­"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:"æ‰¿èªæ¸ˆã¿"})]}),e.jsxs("span",{className:"text-sm font-medium text-green-600",children:[l.approved,"é ­"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:"å¯©æŸ»ä¸­"})]}),e.jsxs("span",{className:"text-sm font-medium text-yellow-600",children:[l.pending,"é ­"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"}),e.jsx("span",{className:"text-sm",children:"æœªç™»éŒ²"})]}),e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[l.total-l.approved-l.pending,"é ­"]})]})]}),l.total>0&&e.jsx("div",{className:"mt-4 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:l.approved/l.total*100+"%"}})})]}),"owner"===r?.user_type&&e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(j,{className:"w-5 h-5 mr-2"}),"æ–½è¨­ç®¡ç†çŠ¶æ³"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[n.total,"æ–½è¨­"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:"é‹å–¶ä¸­"})]}),e.jsxs("span",{className:"text-sm font-medium text-green-600",children:[n.approved,"æ–½è¨­"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:"å¯©æŸ»ä¸­"})]}),e.jsxs("span",{className:"text-sm font-medium text-yellow-600",children:[n.pending,"æ–½è¨­"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"}),e.jsx("span",{className:"text-sm",children:"ãã®ä»–"})]}),e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[n.total-n.approved-n.pending,"æ–½è¨­"]})]})]}),n.total>0&&e.jsx("div",{className:"mt-4 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:n.approved/n.total*100+"%"}})})]})]})]})};function z({park:a,onClose:t}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold",children:[a.name,"ã®ç®¡ç†"]}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:e.jsx(E,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"åŸºæœ¬æƒ…å ±"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ä½æ‰€:"})," ",a.address]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:"})," ",(r=a.status,e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${{pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",confirmed:"bg-blue-100 text-blue-800",cancelled:"bg-gray-100 text-gray-800",first_stage_passed:"bg-blue-100 text-blue-800",second_stage_review:"bg-purple-100 text-purple-800",qr_testing:"bg-orange-100 text-orange-800"}[r]||"bg-gray-100 text-gray-800"}`,children:{pending:"æ‰¿èªå¾…ã¡",approved:"æ‰¿èªæ¸ˆã¿",rejected:"å´ä¸‹",confirmed:"ç¢ºå®š",cancelled:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«",first_stage_passed:"ç¬¬ä¸€å¯©æŸ»é€šéŽ",second_stage_review:"ç¬¬äºŒå¯©æŸ»ä¸­",qr_testing:"QRæ¤œæŸ»ä¸­"}[r]||r}))]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"æ–™é‡‘:"})," Â¥",a.price,"/æ—¥"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"æœ€å¤§åŽå®¹äººæ•°:"})," ",a.max_capacity,"äºº"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ç¾åœ¨ã®åˆ©ç”¨è€…æ•°:"})," ",a.current_occupancy,"äºº"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"è©•ä¾¡:"})," â˜…",a.average_rating.toFixed(1)," (",a.review_count,"ä»¶)"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"è¨­å‚™æƒ…å ±"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries({parking:"é§è»Šå ´",shower:"ã‚·ãƒ£ãƒ¯ãƒ¼è¨­å‚™",restroom:"ãƒˆã‚¤ãƒ¬",agility:"ã‚¢ã‚¸ãƒªãƒ†ã‚£è¨­å‚™",rest_area:"ä¼‘æ†©ã‚¹ãƒšãƒ¼ã‚¹",water_station:"çµ¦æ°´è¨­å‚™"}).map((([s,t])=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded "+(a.facilities[s]?"bg-green-500":"bg-gray-300")}),e.jsx("span",{className:"text-sm",children:t})]},s)))})]})]}),"first_stage_passed"===a.status&&e.jsx("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(u,{className:"w-5 h-5 text-blue-600 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"ç¬¬ä¸€å¯©æŸ»é€šéŽ"}),e.jsx("p",{className:"text-sm text-blue-800 mb-3",children:"ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ç¬¬ä¸€å¯©æŸ»ã«é€šéŽã—ã¾ã—ãŸã€‚æ¬¡ã¯è©³ç´°ãªæ–½è¨­æƒ…å ±ã¨ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãŒå¿…è¦ã§ã™ã€‚"}),e.jsx(l,{to:`/parks/${a.id}/second-stage`,children:e.jsx(s,{className:"bg-blue-600 hover:bg-blue-700",children:"ç¬¬äºŒå¯©æŸ»ã‚’é€²ã‚ã‚‹"})})]})]})}),"second_stage_review"===a.status&&e.jsx("div",{className:"mb-6 p-4 bg-purple-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(w,{className:"w-5 h-5 text-purple-600 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-purple-900 mb-2",children:"ç¬¬äºŒå¯©æŸ»ä¸­"}),e.jsx("p",{className:"text-sm text-purple-800",children:"ç¾åœ¨ã€ç®¡ç†è€…ãŒæ–½è¨­ç”»åƒã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚å¯©æŸ»ã«ã¯é€šå¸¸3-5å–¶æ¥­æ—¥ã‹ã‹ã‚Šã¾ã™ã€‚ çµæžœã¯ãƒ¡ãƒ¼ãƒ«ã¨ã‚¢ãƒ—ãƒªå†…é€šçŸ¥ã§ãŠçŸ¥ã‚‰ã›ã—ã¾ã™ã€‚"})]})]})}),"approved"===a.status&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"çµ±è¨ˆæƒ…å ±"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsx("h4",{className:"font-medium text-blue-900",children:"ä»Šæœˆã®äºˆç´„"})}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"32ä»¶"}),e.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"å‰æœˆæ¯” +12%"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(W,{className:"w-5 h-5 text-green-600"}),e.jsx("h4",{className:"font-medium text-green-900",children:"ä»Šæœˆã®åŽç›Š"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:"Â¥25,600"}),e.jsx("p",{className:"text-xs text-green-700 mt-1",children:"å‰æœˆæ¯” +8%"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(H,{className:"w-5 h-5 text-purple-600"}),e.jsx("h4",{className:"font-medium text-purple-900",children:"åˆ©ç”¨è€…æ•°"})]}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:"128äºº"}),e.jsx("p",{className:"text-xs text-purple-700 mt-1",children:"å‰æœˆæ¯” +15%"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["approved"===a.status&&e.jsx(l,{to:`/parks/${a.id}`,children:e.jsxs(s,{variant:"secondary",className:"w-full",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"å…¬é–‹ãƒšãƒ¼ã‚¸ã‚’è¦‹ã‚‹"]})}),"approved"===a.status&&e.jsx(l,{to:"/owner-payment-system",children:e.jsxs(s,{variant:"secondary",className:"w-full",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"åŽç›Šãƒ¬ãƒãƒ¼ãƒˆ"]})}),e.jsx(l,{to:"first_stage_passed"===a.status?`/parks/${a.id}/second-stage`:`/parks/${a.id}/manage`,children:e.jsx(s,{className:"w-full",children:"first_stage_passed"===a.status?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"ç¬¬äºŒå¯©æŸ»ã‚’é€²ã‚ã‚‹"]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"approved"===a.status?"è¨­å®šã‚’ç·¨é›†":"è©³ç´°ã‚’è¦‹ã‚‹"]})})})]})]})})});var r}function W({className:s}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[e.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),e.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]})}function H({className:s}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[e.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})}function A({className:s}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[e.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}function J(){const{user:l,logout:d}=a(),o=n(),m=i(),[x,g]=c.useState(null),[h,p]=c.useState([]),[j,f]=c.useState([]),[N,b]=c.useState([]),[v,w]=c.useState([]),[y,_]=c.useState([]),[D,S]=c.useState(!0);t();const[k,C]=c.useState(!1),[E,F]=c.useState(null),[R,V]=c.useState(!1),[B,W]=c.useState(null),[H,A]=c.useState(!1),[J,O]=c.useState(!1),[Q,G]=c.useState(""),[K,X]=c.useState(""),[Y,Z]=c.useState({name:"",breed:"",gender:"",birthDate:""}),[ee,se]=c.useState(null),[ae,te]=c.useState(null),[re,le]=c.useState(null),[ne,ie]=c.useState(null),[ce,de]=c.useState(""),[oe,me]=c.useState(""),[xe,ge]=c.useState([]),[he,pe]=c.useState(null);c.useEffect((()=>{l&&ue();(async()=>{const{data:e,error:s}=await r.from("dogs").select("*").order("created_at",{ascending:!1}).limit(8);s?pe(s.message||"ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼"):(ge(e||[]),pe(null))})(),m.search.includes("success=true")&&(C(!0),window.history.replaceState({},document.title,m.pathname),setTimeout((()=>C(!1)),5e3))}),[l,o,m]);const ue=async()=>{try{const[e,s,a,t,n,i]=await Promise.all([r.from("profiles").select("*").eq("id",l?.id).single(),r.from("dogs").select("*, vaccine_certifications(*)").eq("owner_id",l?.id).order("created_at",{ascending:!1}),r.from("dog_parks").select("*").eq("owner_id",l?.id).order("created_at",{ascending:!1}),r.from("reservations").select("*, dog_park:dog_parks(*), dog:dogs(*)").eq("user_id",l?.id).order("created_at",{ascending:!1}).limit(5),r.from("notifications").select("*").eq("user_id",l?.id).eq("read",!1).order("created_at",{ascending:!1}).limit(5),r.from("news_announcements").select("*").order("created_at",{ascending:!1}).limit(3)]);[e,s,a,t,n,i].forEach(((e,s)=>{e.error})),g(e.data),p(s.data||[]),f(a.data||[]),b(t.data||[]),w(n.data||[]),_(i.data||[])}catch(e){}finally{S(!1)}};return D?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"ãƒžã‚¤ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["ã‚ˆã†ã“ãã€",x?.name||"ãƒ¦ãƒ¼ã‚¶ãƒ¼","ã•ã‚“ï¼"]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:["owner"===x?.user_type&&e.jsxs("a",{href:"/owner-dashboard",className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md font-medium inline-flex items-center",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"ã‚ªãƒ¼ãƒŠãƒ¼ç”»é¢"]}),e.jsxs(s,{variant:"secondary",onClick:async()=>{try{await d(),o("/")}catch(e){}},children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ"]})]})]}),k&&e.jsxs("div",{className:"mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg flex items-center",children:[e.jsx(u,{className:"w-5 h-5 mr-2"}),"æ“ä½œãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸï¼"]}),e.jsxs("div",{className:"space-y-8",children:[e.jsx(T,{dogs:h,ownedParks:j,recentReservations:N,profile:x}),e.jsx(L,{dogs:h,user:l,selectedDog:B,showDogEditModal:H,isUpdatingDog:J,dogUpdateError:Q,dogUpdateSuccess:K,dogFormData:Y,dogImageFile:ee,dogImagePreview:ae,rabiesVaccineFile:re,comboVaccineFile:ne,rabiesExpiryDate:ce,comboExpiryDate:oe,onDogSelect:e=>{W(e);const s=new Date(e.birth_date).toISOString().split("T")[0];Z({name:e.name,breed:e.breed,gender:e.gender,birthDate:s}),te(e.image_url||null);const a=e.vaccine_certifications?.[0];de(a?.rabies_expiry_date||""),me(a?.combo_expiry_date||""),A(!0)},onCloseDogEditModal:()=>A(!1),onUpdateDog:async e=>{if(e.preventDefault(),B&&l){O(!0),G(""),X("");try{if(!(Y.name&&Y.breed&&Y.gender&&Y.birthDate))throw new Error("ã™ã¹ã¦ã®å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");if(!["ã‚ªã‚¹","ãƒ¡ã‚¹"].includes(Y.gender))throw new Error("æ€§åˆ¥ã¯ã€Œã‚ªã‚¹ã€ã¾ãŸã¯ã€Œãƒ¡ã‚¹ã€ã‚’é¸æŠžã—ã¦ãã ã•ã„");let e=null;if((re||ne)&&(e=await I(B.id,re||void 0,ne||void 0,ce,oe),!e.success))throw new Error(e.error||"ãƒ¯ã‚¯ãƒãƒ³è¨¼æ˜Žæ›¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ");const s={name:Y.name,breed:Y.breed,gender:Y.gender,birth_date:Y.birthDate};if(ee){const e=`profile_${Date.now()}_${ee.name}`,a=`${B.id}/${e}`,{error:t}=await r.storage.from("dog-images").upload(a,ee,{upsert:!0});if(t)throw t;s.image_url=r.storage.from("dog-images").getPublicUrl(a).data.publicUrl}const{error:a}=await r.from("dogs").update(s).eq("id",B.id);if(a)throw a;X("ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸï¼"),A(!1),await ue(),se(null),le(null),ie(null),de(""),me("")}catch(s){G(s instanceof Error?s.message:"ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®æƒ…å ±ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ")}finally{O(!1)}}},onDeleteDog:async e=>{if(window.confirm(`${e.name}ã®æƒ…å ±ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚`))try{O(!0);const{error:s}=await r.from("dogs").delete().eq("id",e.id);if(s)throw s;X(`${e.name}ã®æƒ…å ±ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚`),A(!1),await ue()}catch(s){G("ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®æƒ…å ±ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚")}finally{O(!1)}},onDogImageSelect:async e=>{const s=e.target.files?.[0];if(s)try{if(s.size>10485760)return void G("ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¯10MBä»¥ä¸‹ã«ã—ã¦ãã ã•ã„ã€‚");if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(s.type))return void G(`ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ç”»åƒå½¢å¼ã§ã™: ${s.type}`);se(s);const e=new FileReader;e.onload=e=>{te(e.target?.result)},e.readAsDataURL(s),G("")}catch(a){G("ç”»åƒã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸã€‚åˆ¥ã®ç”»åƒã‚’ãŠè©¦ã—ãã ã•ã„ã€‚")}},onDogImageRemove:async()=>{if(B?.image_url)try{O(!0),G("");const{error:e}=await r.from("dogs").update({image_url:null}).eq("id",B.id);if(e)return void G("ç”»åƒã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");se(null),te(null),W({...B,image_url:void 0}),await ue(),X("ç”»åƒã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚"),setTimeout((()=>X("")),3e3)}catch(e){G("ç”»åƒã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚")}finally{O(!1)}},onRabiesVaccineSelect:async e=>{const s=e.target.files?.[0];if(s){const e=q(s);if(!e.isValid)return void G(e.error||"ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ");le(s),G("")}else le(null)},onComboVaccineSelect:async e=>{const s=e.target.files?.[0];if(s){const e=q(s);if(!e.isValid)return void G(e.error||"ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ");ie(s),G("")}else ie(null)},onFormDataChange:Z,onRabiesExpiryDateChange:de,onComboExpiryDateChange:me}),v.length>0&&e.jsx(M,{notifications:v,onMarkAsRead:async e=>{try{await r.from("notifications").update({read:!0}).eq("id",e),w((s=>s.filter((s=>s.id!==e))))}catch(s){}}}),e.jsx(P,{recentDogs:xe,recentDogsError:he,isLoading:!1})]}),R&&E&&e.jsx(z,{park:E,onClose:()=>V(!1)})]})}export{J as UserDashboard};
