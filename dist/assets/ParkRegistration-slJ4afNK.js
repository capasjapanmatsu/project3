import{u as e,b as s,j as a,B as t}from"./index-Dp3tQatg.js";import{u as r,r as l,L as i}from"./vendor-Cwmn0chA.js";import{C as n}from"./Card-CPEZwr97.js";import{I as c}from"./Input-BBpqNzSy.js";import{a as d,l as o,a0 as x,F as m,Z as h,R as j,x as u,a1 as p,i as g,d as b}from"./ui-BHmKMuva.js";import"./supabase-Dzr8oIt2.js";function N(){const N=r(),{user:v}=e(),[y,w]=l.useState(!1),[k,C]=l.useState(""),[O,_]=l.useState(1),[S,A]=l.useState(""),[L,D]=l.useState(!1),[B,P]=l.useState([]),[q,R]=l.useState(!1),[Q,F]=l.useState(null),[E,V]=l.useState({isCurrentlyOperating:"",isOwnedLand:"",hasOwnerPermission:"",hasNeighborConsent:"",landArea:"",isAntiSocialForces:"",canVisitWeekly:"",canReachQuickly:"",name:"",description:"",address:"",maxCapacity:"10",largeDogArea:!0,smallDogArea:!0,privateBooths:!1,privateBoothCount:"0",facilities:{parking:!1,shower:!1,restroom:!1,agility:!1,rest_area:!1,water_station:!1},facilityDetails:""});l.useEffect((()=>{v?(I(),W()):N("/login")}),[v,N]);const W=async()=>{try{const{data:e,error:a}=await s.from("dog_parks").select("*").eq("owner_id",null==v?void 0:v.id).eq("status","rejected");if(a)throw a;P(e||[])}catch(e){}},I=async()=>{try{const{data:e,error:a}=await s.from("owner_verifications").select("status, verification_id").eq("user_id",null==v?void 0:v.id).maybeSingle();if(a)throw a;e&&"verified"===e.status?_(3):e&&e.verification_id&&await z(e.verification_id)}catch(e){}},z=async e=>{try{w(!0),C("");const{data:{session:a}}=await s.auth.getSession();if(!(null==a?void 0:a.access_token))throw new Error("認証が必要です");const t=await fetch("https://onmcivwxtzqajcovptgf.supabase.co/functions/v1/check-identity-verification",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.access_token}`},body:JSON.stringify({verificationId:e})});if(!t.ok){const e=await t.json();throw new Error(e.error||"本人確認ステータスの取得に失敗しました")}const r=await t.json();"verified"===r.status?_(3):"processing"===r.status?C("本人確認は処理中です。しばらく経ってから再度お試しください。"):C("本人確認に問題があります。もう一度お試しください。")}catch(a){C(a.message||"本人確認ステータスの取得に失敗しました")}finally{w(!1)}},T=async()=>{try{D(!0),C("");const{data:{session:e}}=await s.auth.getSession();if(!(null==e?void 0:e.access_token))throw new Error("認証が必要です");const a=await fetch("https://onmcivwxtzqajcovptgf.supabase.co/functions/v1/create-identity-verification",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`},body:JSON.stringify({returnUrl:`${window.location.origin}/register-park`})});if(!a.ok){const e=await a.json();throw new Error(e.error||"本人確認セッションの作成に失敗しました")}const{url:t,id:r}=await a.json();if(!t||!r)throw new Error("本人確認セッションの作成に失敗しました");const{error:l}=await s.from("owner_verifications").upsert({user_id:null==v?void 0:v.id,verification_id:r,status:"pending",created_at:(new Date).toISOString()},{onConflict:"user_id"});if(l)throw l;A(t)}catch(e){C(e.message||"本人確認セッションの作成に失敗しました"),_(1)}finally{D(!1)}},J=e=>{if(e.preventDefault(),C(""),E.isCurrentlyOperating){if("no"===E.isCurrentlyOperating){if(!E.isOwnedLand)return void C("予定地の所有状況を選択してください。");if("no"===E.isOwnedLand&&!E.hasOwnerPermission)return void C("土地所有者の許可について選択してください。");if(!E.hasNeighborConsent)return void C("近隣住民の理解について選択してください。")}if(!E.landArea||parseInt(E.landArea)<=0)C("広さを正しく入力してください。");else if(E.isAntiSocialForces)if("yes"!==E.isAntiSocialForces)if(E.canVisitWeekly)if(E.canReachQuickly){if("no"===E.isCurrentlyOperating){if("no"===E.isOwnedLand&&"no"===E.hasOwnerPermission)return void C("土地所有者の許可を得てからお申し込みください。借用地でのドッグラン運営には所有者の同意が必要です。");if("no"===E.hasNeighborConsent)return void C("近隣住民の理解を得てからお申し込みください。地域との良好な関係は運営において重要です。")}parseInt(E.landArea)<100?C("ドッグランの運営には最低100㎡以上の広さが必要です。"):"no"!==E.canVisitWeekly?"no"!==E.canReachQuickly?(_(2),T()):C("緊急時に1時間以内に施設に到着できることが必要です。迅速な対応ができる方のみお申し込みください。"):C("週に1度程度の訪問が必要です。施設の状況確認やメンテナンスのため、定期的な訪問ができる方のみお申し込みください。")}else C("緊急時の到着可否について選択してください。");else C("週1回の訪問可否について選択してください。");else C("反社会的勢力との関係がある場合、ドッグランの登録はできません。");else C("反社会的勢力との関係について選択してください。")}else C("現在の運営状況を選択してください。")},$=()=>{V({isCurrentlyOperating:"",isOwnedLand:"",hasOwnerPermission:"",hasNeighborConsent:"",landArea:"",isAntiSocialForces:"",canVisitWeekly:"",canReachQuickly:"",name:"",description:"",address:"",maxCapacity:"10",largeDogArea:!0,smallDogArea:!0,privateBooths:!1,privateBoothCount:"0",facilities:{parking:!1,shower:!1,restroom:!1,agility:!1,rest_area:!1,water_station:!1},facilityDetails:""}),_(1)};return 2===O?a.jsxs("div",{className:"max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-2xl font-bold text-center mb-8",children:"ドッグラン登録 - 本人確認"}),a.jsx(n,{className:"mb-6 bg-blue-50 border-blue-200",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(d,{className:"w-6 h-6 text-blue-600 mt-1"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"本人確認について"}),a.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[a.jsx("p",{children:"安全なプラットフォーム運営のため、ドッグランオーナーには本人確認が必要です。"}),a.jsx("p",{children:"以下の手順で本人確認を完了してください："}),a.jsxs("ol",{className:"list-decimal ml-5 space-y-1 mt-2",children:[a.jsx("li",{children:"「本人確認を開始」ボタンをクリックする"}),a.jsx("li",{children:"Stripeの本人確認ページが開きます"}),a.jsx("li",{children:"身分証明書（運転免許証、パスポートなど）をアップロード"}),a.jsx("li",{children:"顔写真を撮影して本人確認を完了"}),a.jsx("li",{children:"確認完了後、自動的にこのページに戻ります"})]})]})]})]})}),k&&a.jsx("div",{className:"mb-6 p-4 bg-red-50 rounded-lg",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx(o,{className:"w-5 h-5 text-red-600 mt-0.5"}),a.jsx("p",{className:"text-sm text-red-800",children:k})]})}),a.jsxs(n,{className:"p-6",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx(x,{className:"w-16 h-16 text-blue-600 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold",children:"本人確認"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"安全なプラットフォーム運営のため、ドッグランオーナーには本人確認が必要です。 Stripeの安全な本人確認サービスを使用して、身分証明書と顔写真による本人確認を行います。"})]}),a.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg mb-6",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx(o,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),a.jsxs("div",{className:"text-sm text-yellow-800",children:[a.jsx("p",{className:"font-medium mb-1",children:"必要な書類"}),a.jsxs("ul",{className:"space-y-1",children:[a.jsx("li",{children:"• 運転免許証、パスポート、マイナンバーカードのいずれか"}),a.jsx("li",{children:"• ウェブカメラまたはスマートフォンのカメラ（顔写真撮影用）"}),a.jsx("li",{children:"• 本人確認は通常5分程度で完了します"})]})]})]})}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(t,{variant:"secondary",onClick:()=>_(1),children:"前のステップに戻る"}),S?a.jsxs(t,{onClick:()=>window.location.href=S,isLoading:y,className:"bg-blue-600 hover:bg-blue-700",children:[a.jsx(d,{className:"w-4 h-4 mr-2"}),"本人確認を開始"]}):a.jsxs(t,{onClick:T,isLoading:L,className:"bg-blue-600 hover:bg-blue-700",children:[a.jsx(d,{className:"w-4 h-4 mr-2"}),"本人確認セッションを作成"]})]})]}),a.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(f,{className:"w-5 h-5 text-gray-600 mt-1"}),a.jsxs("div",{className:"text-sm text-gray-700",children:[a.jsx("p",{className:"font-medium mb-1",children:"プライバシーと安全性"}),a.jsx("p",{children:"本人確認情報は暗号化され、Stripeのセキュアなサーバーで安全に保管されます。 当サービスでは、本人確認が完了したかどうかの情報のみを保持し、身分証明書や顔写真などの個人情報は保存しません。"})]})]})})]}):1===O?a.jsxs("div",{className:"max-w-2xl mx-auto",children:[a.jsx("h1",{className:"text-2xl font-bold text-center mb-8",children:"ドッグラン登録 - 第一審査"}),a.jsx(n,{className:"mb-6 bg-blue-50 border-blue-200",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(m,{className:"w-6 h-6 text-blue-600 mt-1"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"審査プロセスについて"}),a.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"第一審査:"})," 基本的な条件の確認"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"本人確認:"})," 安全なプラットフォーム運営のための本人確認"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"第二審査:"})," 詳細な施設情報と書類審査"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"QRコード実証検査:"})," 実際の施設での動作確認"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"掲載・運営開始:"})," 一般公開と予約受付開始"]})]}),a.jsx("div",{className:"mt-3 flex items-center",children:a.jsxs(i,{to:"/owner-payment-system",className:"text-blue-600 hover:text-blue-800 flex items-center",children:[a.jsx(h,{className:"w-4 h-4 mr-1"}),a.jsx("span",{className:"text-sm font-medium",children:"料金体系と収益システムについて詳しく見る"})]})})]})]})}),B.length>0&&a.jsx(n,{className:"mb-6 bg-red-50 border-red-200",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(o,{className:"w-6 h-6 text-red-600 mt-1"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-red-900 mb-2",children:"却下された申請"}),a.jsx("p",{className:"text-sm text-red-800 mb-4",children:"以下の申請は審査の結果、却下されました。申請内容を見直して再提出するか、削除することができます。"}),a.jsx("div",{className:"space-y-4",children:B.map((e=>a.jsx("div",{className:"bg-white p-4 rounded-lg border border-red-200",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium",children:e.name}),a.jsx("p",{className:"text-sm text-gray-600",children:e.address}),a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["申請日: ",new Date(e.created_at).toLocaleDateString("ja-JP")]})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs(t,{size:"sm",variant:"secondary",onClick:$,children:[a.jsx(j,{className:"w-4 h-4 mr-1"}),"再申請"]}),a.jsxs(t,{size:"sm",variant:"secondary",className:"text-red-600 hover:text-red-700",onClick:()=>F(e.id),children:[a.jsx(u,{className:"w-4 h-4 mr-1"}),"削除"]})]})]})},e.id)))})]})]})}),a.jsx(n,{children:a.jsxs("form",{onSubmit:J,children:[k&&a.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg",children:k}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-lg font-bold text-gray-800 mb-3",children:"予定地は現在すでにドッグランを運営していますか？ *"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"yes",checked:"yes"===E.isCurrentlyOperating,onChange:e=>V({...E,isCurrentlyOperating:e.target.value,isOwnedLand:"",hasOwnerPermission:"",hasNeighborConsent:""}),className:"form-radio text-blue-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"はい"}),a.jsx("p",{className:"text-sm text-gray-600",children:"既にドッグランとして運営している施設です"})]})]}),a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"no",checked:"no"===E.isCurrentlyOperating,onChange:e=>V({...E,isCurrentlyOperating:e.target.value}),className:"form-radio text-blue-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"いいえ"}),a.jsx("p",{className:"text-sm text-gray-600",children:"新規でドッグランを開設予定です"})]})]})]})]}),"no"===E.isCurrentlyOperating&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-lg font-bold text-gray-800 mb-3",children:"予定地は所有地ですか？ *"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"yes",checked:"yes"===E.isOwnedLand,onChange:e=>V({...E,isOwnedLand:e.target.value,hasOwnerPermission:""}),className:"form-radio text-blue-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"はい"}),a.jsx("p",{className:"text-sm text-gray-600",children:"自己所有の土地です"})]})]}),a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"no",checked:"no"===E.isOwnedLand,onChange:e=>V({...E,isOwnedLand:e.target.value}),className:"form-radio text-blue-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"いいえ"}),a.jsx("p",{className:"text-sm text-gray-600",children:"賃貸または借用地です"})]})]})]})]}),"no"===E.isOwnedLand&&a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-lg font-bold text-gray-800 mb-3",children:"土地所有者の許可を得られていますか？ *"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"yes",checked:"yes"===E.hasOwnerPermission,onChange:e=>V({...E,hasOwnerPermission:e.target.value}),className:"form-radio text-blue-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"はい"}),a.jsx("p",{className:"text-sm text-gray-600",children:"土地所有者からドッグラン運営の許可を得ています"})]})]}),a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"no",checked:"no"===E.hasOwnerPermission,onChange:e=>V({...E,hasOwnerPermission:e.target.value}),className:"form-radio text-blue-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"いいえ"}),a.jsx("p",{className:"text-sm text-gray-600",children:"まだ土地所有者の許可を得ていません"})]})]})]})]}),("yes"===E.isOwnedLand||"no"===E.isOwnedLand)&&a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-lg font-bold text-gray-800 mb-3",children:"近隣住民の理解を得られていますか？ *"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"yes",checked:"yes"===E.hasNeighborConsent,onChange:e=>V({...E,hasNeighborConsent:e.target.value}),className:"form-radio text-blue-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"はい"}),a.jsx("p",{className:"text-sm text-gray-600",children:"近隣住民に説明し、理解を得ています"})]})]}),a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"no",checked:"no"===E.hasNeighborConsent,onChange:e=>V({...E,hasNeighborConsent:e.target.value}),className:"form-radio text-blue-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"いいえ"}),a.jsx("p",{className:"text-sm text-gray-600",children:"まだ近隣住民への説明ができていません"})]})]})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx(c,{label:a.jsx("span",{className:"text-lg font-bold text-gray-800",children:"広さ（㎡） *"}),type:"number",min:"1",value:E.landArea,onChange:e=>V({...E,landArea:e.target.value}),placeholder:"例: 500",required:!0}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"ドッグランの運営には最低100㎡以上の広さが必要です"})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-lg font-bold text-gray-800 mb-3",children:"施設までは週に1度程度、状況の確認やメンテナンスに行くことができますか？ *"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"yes",checked:"yes"===E.canVisitWeekly,onChange:e=>V({...E,canVisitWeekly:e.target.value}),className:"form-radio text-blue-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"はい"}),a.jsx("p",{className:"text-sm text-gray-600",children:"週に1度程度の訪問が可能です"})]})]}),a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"no",checked:"no"===E.canVisitWeekly,onChange:e=>V({...E,canVisitWeekly:e.target.value}),className:"form-radio text-blue-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"いいえ"}),a.jsx("p",{className:"text-sm text-gray-600",children:"週に1度程度の訪問は難しいです"})]})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-lg font-bold text-gray-800 mb-3",children:"緊急時に1時間以内に施設まで行ける場所ですか？ *"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"yes",checked:"yes"===E.canReachQuickly,onChange:e=>V({...E,canReachQuickly:e.target.value}),className:"form-radio text-blue-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"はい"}),a.jsx("p",{className:"text-sm text-gray-600",children:"緊急時に1時間以内に到着できます"})]})]}),a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"no",checked:"no"===E.canReachQuickly,onChange:e=>V({...E,canReachQuickly:e.target.value}),className:"form-radio text-blue-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"いいえ"}),a.jsx("p",{className:"text-sm text-gray-600",children:"緊急時に1時間以内の到着は難しいです"})]})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-lg font-bold text-gray-800 mb-3",children:"反社会的勢力との関係について *"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"no",checked:"no"===E.isAntiSocialForces,onChange:e=>V({...E,isAntiSocialForces:e.target.value}),className:"form-radio text-blue-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"いいえ"}),a.jsx("p",{className:"text-sm text-gray-600",children:"反社会的勢力との関係はありません"})]})]}),a.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"radio",value:"yes",checked:"yes"===E.isAntiSocialForces,onChange:e=>V({...E,isAntiSocialForces:e.target.value}),className:"form-radio text-red-600"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"はい"}),a.jsx("p",{className:"text-sm text-gray-600",children:"反社会的勢力との関係があります"})]})]})]}),a.jsx("div",{className:"mt-2 p-3 bg-red-50 rounded-lg",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx(p,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),a.jsx("p",{className:"text-sm text-red-800",children:"反社会的勢力との関係がある場合、ドッグランの登録はできません。当社は反社会的勢力との関係を一切認めておりません。"})]})})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-lg font-bold text-gray-800 mb-3",children:"予定設備 *"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries({parking:"駐車場",shower:"シャワー設備",restroom:"トイレ",agility:"アジリティ設備",rest_area:"休憩スペース",water_station:"給水設備"}).map((([e,s])=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:E.facilities[e],onChange:s=>V({...E,facilities:{...E.facilities,[e]:s.target.checked}}),className:"rounded text-blue-600"}),a.jsx("span",{className:"text-sm",children:s})]},e)))})]}),a.jsx("div",{className:"mt-6 p-4 bg-yellow-50 rounded-lg",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx(o,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),a.jsxs("div",{className:"text-sm text-yellow-800",children:[a.jsx("p",{className:"font-medium mb-1",children:"第一審査について"}),a.jsxs("ul",{className:"space-y-1 text-xs",children:[a.jsx("li",{children:"• 基本的な開設条件を満たしているかを確認します"}),a.jsx("li",{children:"• 通過後、本人確認を行います"}),a.jsx("li",{children:"• 本人確認後、詳細な施設情報の入力に進みます"}),a.jsx("li",{children:"• 第二審査では書類審査を行います"}),a.jsx("li",{children:"• 最終的にQRコード実証検査を経て掲載開始となります"})]})]})]})}),a.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[a.jsxs(i,{to:"/owner-payment-system",className:"text-blue-600 hover:text-blue-800 flex items-center",children:[a.jsx(h,{className:"w-4 h-4 mr-1"}),a.jsx("span",{className:"text-sm",children:"収益システムについて"})]}),a.jsx(t,{type:"submit",className:"w-1/2 bg-blue-600 hover:bg-blue-700",children:"第一審査を申し込む"})]})]})}),Q&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"申請を削除しますか？"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"この操作は取り消せません。申請を削除してもよろしいですか？"}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx(t,{variant:"secondary",onClick:()=>F(null),children:"キャンセル"}),a.jsxs(t,{className:"bg-red-600 hover:bg-red-700",isLoading:q,onClick:()=>(async e=>{try{R(!0);const{error:a}=await s.from("dog_parks").delete().eq("id",e);if(a)throw a;P((s=>s.filter((s=>s.id!==e)))),F(null)}catch(a){C(a.message||"ドッグランの削除に失敗しました")}finally{R(!1)}})(Q),children:[a.jsx(u,{className:"w-4 h-4 mr-2"}),"削除する"]})]})]})})]}):a.jsxs("div",{className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[a.jsx(g,{className:"w-6 h-6 text-green-600"}),a.jsx("span",{className:"text-green-800 font-medium",children:"第一審査通過・本人確認完了"})]}),a.jsx("h1",{className:"text-2xl font-bold mb-2",children:"ドッグラン登録 - 詳細情報入力"}),a.jsx("p",{className:"text-gray-600",children:"第一審査を通過し、本人確認が完了しました。詳細な施設情報を入力してください。"})]}),a.jsx(n,{className:"mb-6 bg-green-50 border-green-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(g,{className:"w-6 h-6 text-green-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-green-900",children:"第一審査・本人確認完了"}),a.jsx("p",{className:"text-sm text-green-800",children:"基本条件をクリアしました"})]})]}),a.jsx("div",{className:"text-right text-sm text-green-700",children:a.jsx("p",{children:"次のステップ: 第二審査（書類審査）"})})]})}),a.jsx(n,{children:a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),w(!0),C("");try{const{data:{user:e},error:a}=await s.auth.getUser();if(a||!e)throw new Error("ユーザー認証に失敗しました。再度ログインしてください。");const{error:t}=await s.from("profiles").update({user_type:"owner"}).eq("id",e.id);if(t)throw new Error("プロフィールの更新に失敗しました。");const{error:r}=await s.from("dog_parks").insert([{owner_id:e.id,name:E.name,description:E.description,address:E.address,price:800,max_capacity:parseInt(E.maxCapacity,10),large_dog_area:E.largeDogArea,small_dog_area:E.smallDogArea,private_booths:E.privateBooths,private_booth_count:parseInt(E.privateBoothCount,10),private_booth_price:5e3,facilities:E.facilities,facility_details:E.facilityDetails,status:"pending"}]);if(r)throw r;N("/owner-dashboard")}catch(a){C(a instanceof Error?a.message:"ドッグランの登録に失敗しました。もう一度お試しください。")}finally{w(!1)}},children:[k&&a.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg",children:k}),a.jsx(c,{label:"施設名 *",value:E.name,onChange:e=>V({...E,name:e.target.value}),required:!0}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"説明 *"}),a.jsx("textarea",{value:E.description,onChange:e=>V({...E,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4,required:!0})]}),a.jsx(c,{label:"住所 *",value:E.address,onChange:e=>V({...E,address:e.target.value}),required:!0}),a.jsxs("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg",children:[a.jsxs("h3",{className:"font-semibold text-blue-900 mb-2 flex items-center",children:[a.jsx(h,{className:"w-5 h-5 mr-2"}),"料金情報（全国統一）"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-800",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"通常利用料金"}),a.jsx("p",{children:"¥800/日（固定）"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"施設貸し切り料金"}),a.jsx("p",{children:"¥4,400/時間（固定）"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"サブスクリプション"}),a.jsx("p",{children:"¥3,800/月（全国共通）"})]})]}),a.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"※ 料金はシステムで自動設定されます。オーナー様の取り分は売上の80%です。"})]}),a.jsx(c,{label:"最大収容人数 *",type:"number",min:"1",value:E.maxCapacity,onChange:e=>V({...E,maxCapacity:e.target.value}),required:!0}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"対応犬種サイズ"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:E.largeDogArea,onChange:e=>V({...E,largeDogArea:e.target.checked}),className:"rounded text-blue-600"}),a.jsx("span",{children:"大型犬エリア"})]}),a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:E.smallDogArea,onChange:e=>V({...E,smallDogArea:e.target.checked}),className:"rounded text-blue-600"}),a.jsx("span",{children:"小型犬エリア"})]})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"flex items-center space-x-2 mb-3",children:[a.jsx("input",{type:"checkbox",checked:E.privateBooths,onChange:e=>V({...E,privateBooths:e.target.checked,privateBoothCount:e.target.checked?E.privateBoothCount:"0"}),className:"rounded text-blue-600"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"プライベートブースあり"})]}),E.privateBooths&&a.jsxs("div",{className:"ml-6",children:[a.jsx(c,{label:"ブース数",type:"number",min:"1",value:E.privateBoothCount,onChange:e=>V({...E,privateBoothCount:e.target.value})}),a.jsxs("div",{className:"mt-2 p-3 bg-blue-50 rounded-lg",children:[a.jsxs("p",{className:"text-sm text-blue-800",children:[a.jsx("span",{className:"font-medium",children:"プライベートブース料金:"})," ¥5,000/2時間（固定）"]}),a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"※ 料金はシステムで自動設定されます"})]})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"設備・サービス（第一審査で選択した内容を確認・修正できます）"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries({parking:"駐車場",shower:"シャワー設備",restroom:"トイレ",agility:"アジリティ設備",rest_area:"休憩スペース",water_station:"給水設備"}).map((([e,s])=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:E.facilities[e],onChange:s=>V({...E,facilities:{...E.facilities,[e]:s.target.checked}}),className:"rounded text-blue-600"}),a.jsx("span",{children:s})]},e)))})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"設備の詳細情報"}),a.jsx("textarea",{value:E.facilityDetails,onChange:e=>V({...E,facilityDetails:e.target.value}),placeholder:"設備やサービスについての詳細な情報を入力してください",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]}),a.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx(b,{className:"w-5 h-5 text-blue-600 mt-0.5"}),a.jsxs("div",{className:"text-sm text-blue-800",children:[a.jsx("p",{className:"font-medium mb-1",children:"第二審査について"}),a.jsxs("ul",{className:"space-y-1 text-xs",children:[a.jsx("li",{children:"• 詳細な施設情報と必要書類の審査を行います"}),a.jsx("li",{children:"• 審査期間は通常3-5営業日です"}),a.jsx("li",{children:"• 通過後、QRコード実証検査の日程調整を行います"}),a.jsx("li",{children:"• 実証検査完了後、一般公開となります"})]})]})]})}),a.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[a.jsxs(i,{to:"/owner-payment-system",className:"text-blue-600 hover:text-blue-800 flex items-center",children:[a.jsx(h,{className:"w-4 h-4 mr-1"}),a.jsx("span",{className:"text-sm",children:"収益システムについて"})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx(t,{type:"button",variant:"secondary",onClick:()=>_(1),children:"第一審査に戻る"}),a.jsx(t,{type:"submit",isLoading:y,className:"bg-blue-600 hover:bg-blue-700",children:"第二審査に申し込む"})]})]})]})})]})}function f({className:e}){return a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}export{N as ParkRegistration};
