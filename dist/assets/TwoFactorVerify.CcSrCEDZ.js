var e=(e,t,a)=>new Promise((s,r)=>{var l=e=>{try{o(a.next(e))}catch(t){r(t)}},n=e=>{try{o(a.throw(e))}catch(t){r(t)}},o=e=>e.done?s(e.value):Promise.resolve(e.value).then(l,n);o((a=a.apply(e,t)).next())});import{j as t,B as a,s}from"./index.Drgpoyph.js";import{r,d as l}from"./vendor.CKEClKZl.js";import{u as n,a as o}from"./router.B_7Atevv.js";import"./supabase.X3H3st79.js";import"./ui.C72fRZ1L.js";function c(){const[c,i]=r.useState(""),[d,u]=r.useState(null),[m,h]=r.useState(!1),[f,x]=r.useState(null),[p,j]=r.useState(!1),y=n(),g=o(),b=new URLSearchParams(g.search).get("factorId");l.useEffect(()=>{(()=>{e(this,null,function*(){if(b){h(!0),u(null);try{const{data:e,error:t}=yield s.auth.mfa.challenge({factorId:b});if(t)throw t;x(e.id),j(!0)}catch(e){u(e.message||"チャレンジ作成に失敗しました")}finally{h(!1)}}})})()},[b]);return t.jsxs("div",{className:"max-w-md mx-auto p-8",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:"2ファクタ認証コード入力"}),t.jsx("p",{className:"mb-2",children:"認証アプリで生成された6桁のコードを入力してください。"}),t.jsx("input",{type:"text",value:c,onChange:e=>i(e.target.value),maxLength:6,className:"border px-2 py-1 mb-4 w-full text-center text-lg tracking-widest",placeholder:"123456",autoFocus:!0,disabled:!p}),d&&t.jsx("p",{className:"text-red-600 mb-4",children:d}),t.jsx(a,{onClick:()=>e(this,null,function*(){if(f&&b){h(!0),u(null);try{const{error:e}=yield s.auth.mfa.verify({factorId:b,challengeId:f,code:c});if(e)throw e;y("/dashboard")}catch(e){u(e.message||"認証に失敗しました")}finally{h(!1)}}}),disabled:m||6!==c.length||!p,children:"認証する"})]})}export{c as default};
