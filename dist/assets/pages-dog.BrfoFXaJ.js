/*! Build: 2025-07-17T07:59:15.523Z
Version: 0.0.0 */
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/utils.C9ZsMnW6.js","assets/vendor-react.D8SVeCGP.js","assets/vendor-misc.qnLj5toF.js","assets/vendor-supabase.RBPF72ft.js"])))=>i.map(i=>d[i]);
import{j as e,f as s,X as r,z as t,S as a,ad as l,k as i,T as o,ae as n,F as c,af as d,r as m,n as x,A as g,P as u,ab as h,u as p,C as b,p as f,ag as j,ah as y,M as v}from"./vendor-react.D8SVeCGP.js";import{B as N,I as w,S as _,u as S,C as D}from"./components-admin.GT3qRZg5.js";import{b as C,s as E,l as $,v as k,j as I,k as q,n as P}from"./utils.C9ZsMnW6.js";const z={},M=function(e,s,r){let t=Promise.resolve();if(s&&s.length>0){let e=function(e){return Promise.all(e.map((e=>Promise.resolve(e).then((e=>({status:"fulfilled",value:e})),(e=>({status:"rejected",reason:e}))))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),a=(null==r?void 0:r.nonce)||(null==r?void 0:r.getAttribute("nonce"));t=e(s.map((e=>{if((e=function(e){return"/"+e}(e))in z)return;z[e]=!0;const s=e.endsWith(".css"),r=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const t=document.createElement("link");return t.rel=s?"stylesheet":"modulepreload",s||(t.as="script"),t.crossOrigin="",t.href=e,a&&t.setAttribute("nonce",a),document.head.appendChild(t),s?new Promise(((s,r)=>{t.addEventListener("load",s),t.addEventListener("error",(()=>r(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}function a(e){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=e,window.dispatchEvent(s),!s.defaultPrevented)throw e}return t.then((s=>{for(const e of s||[])"rejected"===e.status&&a(e.reason);return e().catch(a)}))},T=["柴犬","秋田犬","甲斐犬","紀州犬","四国犬","北海道犬","トイプードル","チワワ","ポメラニアン","ミニチュアダックスフンド","ヨークシャーテリア","マルチーズ","パグ","シーズー","ペキニーズ","パピヨン","ジャックラッセルテリア","ミニチュアピンシャー","イタリアングレーハウンド","キャバリア・キング・チャールズ・スパニエル","ボストンテリア","フレンチブルドッグ","ミニチュアシュナウザー","ウエストハイランドホワイトテリア","ケアーンテリア","ノーフォークテリア","ノーリッチテリア","スコティッシュテリア","ワイヤーフォックステリア","スムースフォックステリア","コーギー","ビーグル","アメリカンコッカースパニエル","イングリッシュコッカースパニエル","ブリタニースパニエル","ボーダーコリー","オーストラリアンシェパード","シェットランドシープドッグ","ウィペット","バセットハウンド","ブルテリア","スタッフォードシャーブルテリア","アメリカンピットブルテリア","エアデールテリア","ケリーブルーテリア","ソフトコーテッドウィートンテリア","ポルトガルウォータードッグ","スタンダードプードル","ミディアムプードル","ゴールデンレトリバー","ラブラドールレトリバー","シベリアンハスキー","アラスカンマラミュート","サモエド","バーニーズマウンテンドッグ","グレートピレニーズ","セントバーナード","ニューファンドランド","マスティフ","ブルマスティフ","ロットワイラー","ドーベルマン","ジャーマンシェパード","ベルジアンシェパード","ダルメシアン","ワイマラナー","ジャーマンショートヘアードポインター","ジャーマンワイヤーヘアードポインター","イングリッシュセッター","アイリッシュセッター","ゴードンセッター","ポインター","ヴィズラ","ブラッコイタリアーノ","スピノーネイタリアーノ","ローデシアンリッジバック","ファラオハウンド","アフガンハウンド","サルーキ","ボルゾイ","アイリッシュウルフハウンド","スコティッシュディアハウンド","グレートデーン","アイリッシュセッター","フラットコーテッドレトリバー","チェサピークベイレトリバー","ノヴァスコシアダックトーリングレトリバー","バセンジー","チャウチャウ","シャーペイ","ラサアプソ","チベタンテリア","チベタンスパニエル","プーリー","コモンドール","ハンガリアンビズラ","ワイヤーヘアードビズラ","ブリアード","ボースロン","ピレニアンシープドッグ","オールドイングリッシュシープドッグ","ビアデッドコリー","ラフコリー","スムースコリー","カーディガンウェルシュコーギー","ペンブロークウェルシュコーギー","フィニッシュスピッツ","ジャーマンスピッツ","キースホンド","エスキモードッグ","グリーンランドドッグ","アメリカンエスキモードッグ","ミックス犬（雑種）","その他"];function O({status:l,size:i="md",showIcon:o=!0,showText:n=!0,className:c=""}){const d=(e=>{switch(e){case"approved":return{icon:a,text:"承認済み",bgColor:"bg-green-100",textColor:"text-green-800",borderColor:"border-green-300",iconColor:"text-green-600",glow:"shadow-green-200 shadow-lg",pulse:"animate-pulse"};case"pending":return{icon:t,text:"審査中",bgColor:"bg-yellow-100",textColor:"text-yellow-800",borderColor:"border-yellow-300",iconColor:"text-yellow-600",glow:"shadow-yellow-200 shadow-md",pulse:""};case"rejected":return{icon:r,text:"却下",bgColor:"bg-red-100",textColor:"text-red-800",borderColor:"border-red-300",iconColor:"text-red-600",glow:"shadow-red-200 shadow-md",pulse:""};case"expired":return{icon:s,text:"期限切れ",bgColor:"bg-orange-100",textColor:"text-orange-800",borderColor:"border-orange-300",iconColor:"text-orange-600",glow:"shadow-orange-200 shadow-md",pulse:"animate-pulse"};default:return{icon:s,text:"未提出",bgColor:"bg-gray-100",textColor:"text-gray-800",borderColor:"border-gray-300",iconColor:"text-gray-600",glow:"",pulse:""}}})(l),m=(e=>{switch(e){case"sm":return{padding:"px-2 py-1",textSize:"text-xs",iconSize:"w-3 h-3",gap:"gap-1"};case"lg":return{padding:"px-4 py-2",textSize:"text-base",iconSize:"w-6 h-6",gap:"gap-3"};default:return{padding:"px-3 py-1.5",textSize:"text-sm",iconSize:"w-4 h-4",gap:"gap-2"}}})(i),x=d.icon;return e.jsxs("div",{className:`\n      inline-flex items-center font-medium rounded-full border-2\n      ${d.bgColor} \n      ${d.textColor} \n      ${d.borderColor}\n      ${d.glow}\n      ${d.pulse}\n      ${m.padding}\n      ${m.textSize}\n      ${m.gap}\n      ${c}\n    `,children:[o&&e.jsx(x,{className:`${m.iconSize} ${d.iconColor}`}),n&&e.jsx("span",{className:"font-semibold",children:d.text})]})}function R(e){var s;const r=null==(s=e.vaccine_certifications)?void 0:s[0];if(!r)return"none";const t=new Date,a=r.rabies_expiry_date?new Date(r.rabies_expiry_date):null,l=r.combo_expiry_date?new Date(r.combo_expiry_date):null;return"approved"===r.status?a&&a<t||l&&l<t?"expired":"approved":r.status||"none"}function V({dog:s,onEdit:r}){const t=R(s),a=F(s.gender);return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx(l,{className:"w-6 h-6 text-gray-500"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold",children:[s.name,a]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.breed," • ",s.gender]}),e.jsx("div",{className:"flex items-center space-x-2 mt-1",children:e.jsx(O,{status:t,size:"sm"})})]})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(N,{size:"sm",className:"bg-white hover:bg-gray-50 border border-gray-300 text-gray-700",onClick:()=>r(s),children:e.jsx(i,{className:"w-4 h-4"})})})]})}function F(e){return"オス"===e?"くん":"ちゃん"}function U({dog:s,isUpdating:t,error:l,success:i,dogFormData:m,dogImagePreview:x,onClose:g,onSubmit:u,onDelete:h,onFormChange:p,onImageSelect:b,onImageRemove:f,rabiesVaccineFile:j,comboVaccineFile:y,rabiesExpiryDate:v,comboExpiryDate:S,onRabiesVaccineSelect:D,onComboVaccineSelect:C,onRabiesExpiryDateChange:E,onComboExpiryDateChange:$}){if(!s)return null;const k=F(s.gender),I=R(s);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold",children:[s.name,k,"の情報編集"]}),e.jsxs("div",{className:"flex space-x-2",children:[h&&e.jsx("button",{type:"button",onClick:()=>{window.confirm(`${s.name}${k}を削除しますか？\n\nこの操作は元に戻せません。`)&&h(s)},className:"text-red-500 hover:text-red-700 p-1 rounded-lg hover:bg-red-50 transition-colors",title:"このワンちゃんを削除",children:e.jsx(o,{className:"w-5 h-5"})}),e.jsx("button",{onClick:g,className:"text-gray-500 hover:text-gray-700 p-1 rounded-lg hover:bg-gray-100 transition-colors",title:"編集を閉じる",children:e.jsx(r,{className:"w-5 h-5"})})]})]}),l&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg",children:l}),i&&e.jsxs("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-lg flex items-center",children:[e.jsx(a,{className:"w-5 h-5 mr-2"}),i]}),e.jsx("form",{onSubmit:u,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"基本情報"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ワンちゃんの写真"}),x?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:x,alt:"ワンちゃんのプレビュー",className:"w-full h-48 object-cover rounded-lg border-2 border-gray-300"}),e.jsx("button",{type:"button",onClick:f,className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:e.jsx(o,{className:"w-4 h-4"})})]}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:b,className:"hidden",id:"dog-image-edit"}),e.jsxs("label",{htmlFor:"dog-image-edit",className:"cursor-pointer flex flex-col items-center",children:[e.jsx(n,{className:"w-12 h-12 text-gray-400 mb-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"クリックして画像を選択"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, GIF (最大10MB)"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(w,{label:"名前",value:m.name,onChange:e=>p({...m,name:e.target.value}),required:!0}),e.jsx(_,{label:"犬種",options:T.map((e=>({value:e,label:e}))),value:m.breed,onChange:e=>p({...m,breed:e.target.value}),required:!0}),e.jsx(_,{label:"性別",options:[{value:"",label:"性別を選択してください"},{value:"オス",label:"オス"},{value:"メス",label:"メス"}],value:m.gender,onChange:e=>p({...m,gender:e.target.value}),required:!0}),e.jsx(w,{label:"生年月日",type:"date",value:m.birthDate,onChange:e=>p({...m,birthDate:e.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(a,{className:"w-5 h-5 mr-2"}),"ワクチン証明書"]}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"現在のステータス:"}),e.jsx(O,{status:I,size:"md"})]}),"pending"===I&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"新しい証明書をアップロードすると、再度承認待ち状態になります。"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"狂犬病ワクチン証明書"}),j?e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-800",children:j.name}),e.jsx("button",{type:"button",onClick:()=>{const e=document.getElementById("rabies-vaccine-edit");e&&(e.value=""),D({target:{files:[]}})},className:"text-red-600 hover:text-red-800",children:e.jsx(o,{className:"w-4 h-4"})})]})}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-gray-400 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:D,className:"hidden",id:"rabies-vaccine-edit"}),e.jsxs("label",{htmlFor:"rabies-vaccine-edit",className:"cursor-pointer flex flex-col items-center",children:[e.jsx(d,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"証明書をアップロード"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, GIF (最大10MB)"})]})]}),e.jsx(w,{label:"有効期限",type:"date",value:v,onChange:e=>E(e.target.value),className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"混合ワクチン証明書"}),y?e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-800",children:y.name}),e.jsx("button",{type:"button",onClick:()=>{const e=document.getElementById("combo-vaccine-edit");e&&(e.value=""),C({target:{files:[]}})},className:"text-red-600 hover:text-red-800",children:e.jsx(o,{className:"w-4 h-4"})})]})}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-gray-400 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:C,className:"hidden",id:"combo-vaccine-edit"}),e.jsxs("label",{htmlFor:"combo-vaccine-edit",className:"cursor-pointer flex flex-col items-center",children:[e.jsx(d,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"証明書をアップロード"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, GIF (最大10MB)"})]})]}),e.jsx(w,{label:"有効期限",type:"date",value:S,onChange:e=>$(e.target.value),className:"mt-2"})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"注意:"})," 新しいワクチン証明書をアップロードすると、管理者による再承認が必要になります。 承認されるまでドッグランのご利用はできません。"]})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(N,{type:"button",className:"bg-white hover:bg-gray-50 border border-gray-300 text-gray-700",onClick:g,children:"キャンセル"}),e.jsxs(N,{type:"submit",isLoading:t,children:[e.jsx(a,{className:"w-4 h-4 mr-2"}),"保存"]})]})]})})]})})})}const A=Object.freeze(Object.defineProperty({__proto__:null,DogManagement:function(){const{user:s}=S(),[r,t]=m.useState([]),[a,i]=m.useState(!0),[o,n]=m.useState(""),[c,d]=m.useState(!1),[h,p]=m.useState(null),[b,f]=m.useState(!1),[j,y]=m.useState(""),[v,w]=m.useState(""),[_,k]=m.useState(!1),[I,q]=m.useState({name:"",breed:"",gender:"",birthDate:""}),[P,z]=m.useState(null),[T,O]=m.useState(null),[R,F]=m.useState(null),[A,L]=m.useState(null),[Y,G]=m.useState(""),[B,W]=m.useState("");m.useEffect((()=>{s&&J()}),[s]);const J=async()=>{try{i(!0),n("");const e=await C((()=>E.from("dogs").select("*, vaccine_certifications(*)").eq("owner_id",null==s?void 0:s.id).order("created_at",{ascending:!1})));if(e.error)return $("error","Error fetching dogs",{error:e.error,userId:null==s?void 0:s.id}),void n("ワンちゃんの情報を取得できませんでした。");t(e.data||[])}catch(e){$("error","Exception in fetchDogs",{error:e,userId:null==s?void 0:s.id}),n("ワンちゃんの情報を取得できませんでした。")}finally{i(!1)}},K=e=>{var s;p(e),q({name:e.name,breed:e.breed,gender:e.gender,birthDate:e.birth_date}),O(e.image_url||null);const r=null==(s=e.vaccine_certifications)?void 0:s[0];r&&(G(r.rabies_expiry_date||""),W(r.combo_expiry_date||"")),d(!0)};return a?e.jsxs("div",{className:"flex justify-center items-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("p",{className:"ml-3 text-gray-600",children:"ワンちゃんの情報を読み込み中..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(x,{to:"/dashboard",className:"inline-flex items-center text-blue-600 hover:text-blue-800 mb-2",children:[e.jsx(g,{className:"w-4 h-4 mr-1"}),"ダッシュボードに戻る"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ワンちゃん管理"}),e.jsx("p",{className:"text-gray-600",children:"登録済みのワンちゃんの情報を管理できます"})]}),e.jsx(x,{to:"/register-dog",children:e.jsxs(N,{children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"新しいワンちゃんを登録"]})})]}),o&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:o}),v&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:v}),e.jsxs(D,{children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:[e.jsx(l,{className:"w-6 h-6 text-blue-600 mr-2"}),"登録済みワンちゃん (",r.length,"匹)"]})}),0===r.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(l,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"まだワンちゃんが登録されていません"}),e.jsx(x,{to:"/register-dog",children:e.jsxs(N,{children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"ワンちゃんを登録する"]})})]}):e.jsx("div",{className:"space-y-4",children:r.map((s=>e.jsx(V,{dog:s,onEdit:K},s.id)))})]}),c&&h&&e.jsx(U,{dog:h,isUpdating:b||_,error:j,success:v,dogFormData:I,dogImagePreview:T,onClose:()=>d(!1),onSubmit:async e=>{if(e.preventDefault(),h){f(!0),y(""),w("");try{const e={name:I.name,breed:I.breed,gender:I.gender,birth_date:I.birthDate};if(P){if(!P.type||!P.type.startsWith("image/"))throw new Error(`無効なファイル形式です: ${P.type}`);const s=`${h.id}/dog-photo.jpg`,r=`/storage/v1/object/dog-images/${s}`,{data:{session:t}}=await E.auth.getSession();if(!(null==t?void 0:t.access_token))throw new Error("認証されていません。ログインしてください。");const a=await fetch(r,{method:"PUT",headers:{Authorization:`Bearer ${t.access_token}`,"Content-Type":P.type,"Cache-Control":"3600"},body:P});if(!a.ok){const e=await a.text();throw $("error","❌ Direct upload failed",{error:e}),new Error(`直接アップロードに失敗しました: ${a.status} ${e}`)}await a.json();const{data:{publicUrl:l}}=E.storage.from("dog-images").getPublicUrl(s);e.image_url=l}const{error:s}=await E.from("dogs").update(e).eq("id",h.id);if(s)throw s;if(R&&A&&Y&&B){const e=R.name.split(".").pop()||"jpg",s=A.name.split(".").pop()||"jpg",r=Date.now(),t=`temp/${h.id}/rabies_${r}.${e}`,a=`temp/${h.id}/combo_${r}.${s}`,{debugAuthStatus:l}=await M((async()=>{const{debugAuthStatus:e}=await import("./utils.C9ZsMnW6.js").then((e=>e.aw));return{debugAuthStatus:e}}),__vite__mapDeps([0,1,2,3]));await l();const{directVaccineUpload:i}=await M((async()=>{const{directVaccineUpload:e}=await import("./utils.C9ZsMnW6.js").then((e=>e.ax));return{directVaccineUpload:e}}),__vite__mapDeps([0,1,2,3])),[o,n]=await Promise.all([i(t,R),i(a,A)]);if(!o.success||!n.success){$("error","🚨 === VACCINE UPLOAD ERROR DETAILS ==="),o.success||$("error","❌ Rabies upload error",{error:o.error}),n.success||$("error","❌ Combo upload error",{error:n.error});const e=o.error||n.error||"ワクチン証明書のアップロードに失敗しました。";throw new Error(`ワクチン証明書のアップロードに失敗しました: ${e}`)}const c=o.url,d=n.url,{error:m}=await E.from("vaccine_certifications").upsert([{dog_id:h.id,rabies_vaccine_image:c,combo_vaccine_image:d,rabies_expiry_date:Y,combo_expiry_date:B,status:"pending"}],{onConflict:"dog_id"});if(m)throw $("error","❌ Database save error",{error:m}),m.message&&m.message.includes("520")?new Error("一時的なサーバーエラーが発生しました。ファイルのアップロードは成功しましたが、データベースへの保存に失敗しました。しばらく待ってから再度お試しください。"):new Error(`データベースへの保存に失敗しました: ${m.message}`)}w("ワンちゃん情報を更新しました"),await J(),setTimeout((()=>{d(!1),w(""),z(null),O(null),F(null),L(null),G(""),W("")}),2e3)}catch(s){$("error","Error updating dog",{error:s,dogId:null==h?void 0:h.id});let e="ワンちゃん情報の更新に失敗しました";s instanceof Error&&(e=s.message.includes("520")||s.message.includes("Cloudflare")?"ワクチン証明書のアップロードは成功しましたが、一時的なサーバーエラーが発生しました。しばらく待ってから再度お試しください。":s.message.includes("アップロードに失敗しました")?s.message:`エラーが発生しました: ${s.message}`),y(e)}finally{f(!1)}}},onDelete:async e=>{var s;k(!0),y("");try{const{error:t}=await E.from("vaccine_certifications").delete().eq("dog_id",e.id);if(t&&$("warn","Error deleting vaccine certifications",{error:t,dogId:e.id}),e.image_url)try{const s=new URL(e.image_url).pathname.split("/"),r=s[s.length-1],t=`${e.id}/${r}`,{error:a}=await E.storage.from("dog-images").remove([t])}catch(r){}const a=null==(s=e.vaccine_certifications)?void 0:s[0];if(a){const e=[];if(a.rabies_vaccine_image&&e.push(a.rabies_vaccine_image),a.combo_vaccine_image&&e.push(a.combo_vaccine_image),e.length>0){const{error:s}=await E.storage.from("vaccine-certs").remove(e)}}const{error:l}=await E.from("dogs").delete().eq("id",e.id);if(l)throw $("error","Error deleting dog",{error:l,dogId:e.id}),l;await J(),d(!1),w(`${e.name}の情報を削除しました。`),setTimeout((()=>{w("")}),3e3)}catch(t){$("error","Error deleting dog",{error:t,dogId:null==e?void 0:e.id});const s=t.message||"ワンちゃんの削除に失敗しました";y(s)}finally{k(!1)}},onFormChange:q,onImageSelect:async e=>{var s;const r=null==(s=e.target.files)?void 0:s[0];if($("info","🔍 File selected:",r?{name:r.name,type:r.type,size:r.size,lastModified:r.lastModified,isFileObject:r instanceof File}:{message:"No file selected"}),r)try{if(!(r instanceof File))return void y("有効なファイルを選択してください。");if(r.size>10485760)return void y("画像ファイルは10MB以下にしてください。");if(!r.type||!r.type.startsWith("image/"))return void y(`画像ファイルを選択してください。選択されたファイルタイプ: ${r.type}`);if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(r.type))return void y(`サポートされていない画像形式です: ${r.type}`);z(r),$("info","✅ Dog image file set successfully:",{name:r.name,type:r.type,size:r.size});const e=new FileReader;e.onload=e=>{var s;O(null==(s=e.target)?void 0:s.result)},e.readAsDataURL(r)}catch(t){y("画像の処理に失敗しました。")}},onImageRemove:async()=>{if(h&&h.image_url)try{f(!0),y("");try{const e=new URL(h.image_url).pathname.split("/"),s=e[e.length-1],r=`${h.id}/${s}`,{error:t}=await E.storage.from("dog-images").remove([r])}catch(e){$("warn","Warning: Error processing image deletion",{error:e})}const s=await C((()=>E.from("dogs").update({image_url:null}).eq("id",h.id)));if(s.error)return $("error","Error updating dog image_url",{error:s.error,dogId:h.id}),void y("画像の削除に失敗しました。");z(null),O(null),p({...h,image_url:void 0}),await J(),$("info","✅ Dog image removed successfully",{dogId:h.id}),w("画像を削除しました。"),setTimeout((()=>{w("")}),3e3)}catch(s){$("error","Error removing dog image",{error:s,dogId:null==h?void 0:h.id}),y("画像の削除に失敗しました。")}finally{f(!1)}},rabiesVaccineFile:R,comboVaccineFile:A,rabiesExpiryDate:Y,comboExpiryDate:B,onRabiesVaccineSelect:async e=>{var s;const r=null==(s=e.target.files)?void 0:s[0];if(r){if(r.size>10485760)return void y("ワクチン証明書ファイルは10MB以下にしてください。");if(!r.type.startsWith("image/"))return void y("画像ファイルを選択してください。");F(r)}else F(null)},onComboVaccineSelect:async e=>{var s;const r=null==(s=e.target.files)?void 0:s[0];if(r){if(r.size>10485760)return void y("ワクチン証明書ファイルは10MB以下にしてください。");if(!r.type.startsWith("image/"))return void y("画像ファイルを選択してください。");L(r)}else L(null)},onRabiesExpiryDateChange:G,onComboExpiryDateChange:W})]})}},Symbol.toStringTag,{value:"Module"})),L=Object.freeze(Object.defineProperty({__proto__:null,DogRegistration:function(){const{user:s}=S(),[t,a]=m.useState(!1),[l,i]=m.useState(""),[o,c]=m.useState(null),[d,u]=m.useState(null),[h,p]=m.useState({name:"",breed:"",birthYear:"",birthMonth:"",birthDay:"",gender:"",rabiesVaccineImage:null,comboVaccineImage:null,rabiesExpiryDate:"",comboExpiryDate:""}),b=(new Date).getFullYear(),f=Array.from({length:21},((e,s)=>{const r=b-s;return{value:r.toString(),label:`${r}年`}})),j=Array.from({length:12},((e,s)=>{const r=s+1;return{value:r.toString().padStart(2,"0"),label:`${r}月`}})),y=()=>{if(!h.birthYear||!h.birthMonth||!h.birthDay)return!1;const e=parseInt(h.birthYear),s=parseInt(h.birthMonth),r=parseInt(h.birthDay),t=new Date(e,s-1,r);if(t>new Date)return!1;const a=new Date;return a.setFullYear(a.getFullYear()-20),!(t<a)},v=T.map((e=>({value:e,label:e})));return e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsxs(x,{to:"/dashboard",className:"inline-flex items-center text-blue-600 hover:text-blue-800 mb-2",children:[e.jsx(g,{className:"w-4 h-4 mr-1"}),"ダッシュボードに戻る"]}),e.jsx("h1",{className:"text-2xl font-bold",children:"ワンちゃん登録"}),e.jsx("p",{className:"text-gray-600",children:"新しいワンちゃんを登録して、ドッグランを利用しましょう"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-blue-900",children:"既に登録済みのワンちゃんがいますか？"}),e.jsx("p",{className:"text-sm text-blue-700",children:"登録済みのワンちゃんの情報を確認・編集できます"})]}),e.jsx(x,{to:"/dog-management",children:e.jsx(N,{variant:"secondary",size:"sm",children:"ワンちゃん管理"})})]})}),e.jsx(D,{children:e.jsxs("form",{onSubmit:async e=>{var r,t;e.preventDefault(),a(!0),i("");try{if(I.info("=== DOG REGISTRATION START ==="),I.info("Starting dog registration for user:",null==s?void 0:s.id),!y())return i("正しい生年月日を選択してください。"),void a(!1);if(!h.rabiesExpiryDate||!h.comboExpiryDate)return i("ワクチンの有効期限を入力してください。"),void a(!1);const e=new Date,n=new Date(h.rabiesExpiryDate),d=new Date(h.comboExpiryDate);if(n<=e||d<=e)return i("ワクチンの有効期限は今日より後の日付を入力してください。"),void a(!1);const m=`${h.birthYear}-${h.birthMonth}-${h.birthDay}`;let x;if("オス"===h.gender||"male"===h.gender||"male"===h.gender.toLowerCase())x="オス";else{if("メス"!==h.gender&&"female"!==h.gender&&"female"!==h.gender.toLowerCase())return i("性別を正しく選択してください。"),void a(!1);x="メス"}I.info("Original gender:",h.gender,"Normalized gender:",x);const{data:g,error:b}=await E.from("profiles").select("id, name, user_type").eq("id",null==s?void 0:s.id).maybeSingle();if(I.info("Profile check result:",g,b),b&&"PGRST116"!==b.code)throw I.error("Profile error:",b),b;if(g)I.info("Profile exists:",g);else{I.info("Creating profile for dog registration using upsert");const e=(null==(r=null==s?void 0:s.user_metadata)?void 0:r.name)||(null==(t=null==s?void 0:s.email)?void 0:t.split("@")[0])||"ユーザー",{data:a,error:l}=await E.from("profiles").upsert([{id:null==s?void 0:s.id,user_type:"user",name:e,postal_code:"",address:"",phone_number:""}],{onConflict:"id"}).select().single();if(l)throw I.error("Profile upsert error:",l),l;I.info("Profile upserted successfully:",a)}I.info("Registering dog with data:",{name:h.name,breed:h.breed,birth_date:m,gender:x,owner_id:null==s?void 0:s.id});const{data:f,error:j}=await E.from("dogs").insert([{name:h.name,breed:h.breed,birth_date:m,gender:x,owner_id:null==s?void 0:s.id}]).select().single();if(j)throw I.error("🚨 Dog registration error:",j),I.error("🚨 Error details:",{message:j.message,code:j.code,details:j.details,hint:j.hint}),j;I.info("✅ Dog registered successfully:",f),I.info("✅ Dog ID generated:",f.id);let v=null;if(o){I.info("Uploading dog image...");try{const e=o.name.split(".").pop()||"jpg",s=Date.now(),r=`${f.id}/profile_${s}.${e}`;I.info("Uploading to path:",r),I.info("🔧 Uploading dog image with Content-Type:",o.type);const{error:t}=await E.storage.from("dog-images").upload(r,o,{cacheControl:"3600",upsert:!0,contentType:o.type});if(t)throw I.error("Image upload error:",t),new Error(`画像のアップロードに失敗しました: ${t.message}`);I.info("Upload successful");const{data:{publicUrl:a}}=E.storage.from("dog-images").getPublicUrl(r);v=a,I.info("Public URL generated:",v);const{error:l}=await E.from("dogs").update({image_url:v}).eq("id",f.id);if(l)throw I.error("Error updating dog image URL:",l),new Error("画像URLの更新に失敗しました");I.info("Dog image URL updated successfully")}catch(l){I.error("Image processing error:",l),i("画像のアップロードに失敗しましたが、ワンちゃんの登録は完了しました。後でマイページから画像を追加できます。")}}if(h.rabiesVaccineImage&&h.comboVaccineImage){I.info("🧪 Starting vaccine certificates upload using utility...");const e=await q(f.id,h.rabiesVaccineImage,h.comboVaccineImage,h.rabiesExpiryDate,h.comboExpiryDate);e.success?I.info("✅ Vaccine certificates uploaded successfully"):(I.error("Vaccine upload failed:",e.error),i(`ワクチン証明書のアップロードに失敗しました: ${e.error}`))}I.info("Dog registration completed successfully"),P.success("ワンちゃんの登録が完了しました！"),p({name:"",breed:"",birthYear:"",birthMonth:"",birthDay:"",gender:"",rabiesVaccineImage:null,comboVaccineImage:null,rabiesExpiryDate:"",comboExpiryDate:""}),c(null),u(null)}catch(n){I.error("Registration error:",n),i("ワンちゃんの登録に失敗しました。もう一度お試しください。")}finally{a(!1)}},children:[l&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg",children:l}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ワンちゃんの写真（任意）"}),d?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:d,alt:"ワンちゃんのプレビュー",className:"w-full h-64 object-cover rounded-lg border-2 border-gray-300"}),e.jsx("button",{type:"button",onClick:()=>{c(null),u(null)},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:e.jsx(r,{className:"w-4 h-4"})}),o&&e.jsx("div",{className:"absolute bottom-2 left-2 bg-white bg-opacity-90 text-gray-800 text-xs px-2 py-1 rounded border shadow-sm",children:o.name})]}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var s;const r=null==(s=e.target.files)?void 0:s[0];if(r){if(I.info("Selected file:",r.name,r.size,r.type),r.size>10485760)return void i("画像ファイルは10MB以下にしてください。");if(!r.type.startsWith("image/"))return void i("画像ファイルを選択してください。");c(r);const e=new FileReader;e.onload=e=>{var s;u(null==(s=e.target)?void 0:s.result),I.info("Image preview created")},e.readAsDataURL(r),i("")}},className:"hidden",id:"dog-image"}),e.jsxs("label",{htmlFor:"dog-image",className:"cursor-pointer flex flex-col items-center",children:[e.jsx(n,{className:"w-12 h-12 text-gray-400 mb-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"クリックして画像を選択"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, GIF (最大10MB)"})]})]})]}),e.jsx(w,{label:"名前",value:h.name,onChange:e=>p({...h,name:e.target.value}),required:!0}),e.jsx(_,{label:"犬種",options:v,value:h.breed,onChange:e=>p({...h,breed:e.target.value}),required:!0}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"生年月日 *"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("div",{children:e.jsxs("select",{value:h.birthYear,onChange:e=>{p({...h,birthYear:e.target.value,birthDay:""})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"年"}),f.map((s=>e.jsx("option",{value:s.value,children:s.label},s.value)))]})}),e.jsx("div",{children:e.jsxs("select",{value:h.birthMonth,onChange:e=>{p({...h,birthMonth:e.target.value,birthDay:""})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"月"}),j.map((s=>e.jsx("option",{value:s.value,children:s.label},s.value)))]})}),e.jsx("div",{children:e.jsxs("select",{value:h.birthDay,onChange:e=>p({...h,birthDay:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:!h.birthYear||!h.birthMonth,children:[e.jsx("option",{value:"",children:"日"}),(()=>{if(!h.birthYear||!h.birthMonth)return Array.from({length:31},((e,s)=>{const r=s+1;return{value:r.toString().padStart(2,"0"),label:`${r}日`}}));const e=parseInt(h.birthYear),s=parseInt(h.birthMonth),r=new Date(e,s,0).getDate();return Array.from({length:r},((e,s)=>{const r=s+1;return{value:r.toString().padStart(2,"0"),label:`${r}日`}}))})().map((s=>e.jsx("option",{value:s.value,children:s.label},s.value)))]})})]}),h.birthYear&&h.birthMonth&&!h.birthDay&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"日を選択してください"}),h.birthYear&&h.birthMonth&&h.birthDay&&!y()&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:"正しい生年月日を選択してください（未来の日付や20年以上前の日付は選択できません）"})]}),e.jsx(_,{label:"性別",options:[{value:"",label:"性別を選択してください"},{value:"オス",label:"オス"},{value:"メス",label:"メス"}],value:h.gender,onChange:e=>p({...h,gender:e.target.value}),required:!0}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"ワクチン証明書"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"狂犬病ワクチン接種証明書 *"}),e.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var s;const r=null==(s=e.target.files)?void 0:s[0];if(r){const e=k(r);if(!e.isValid)return void i(e.error||"ファイルの検証に失敗しました");i("")}p({...h,rabiesVaccineImage:r||null})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"狂犬病ワクチン有効期限 *"}),e.jsx("input",{type:"date",value:h.rabiesExpiryDate,onChange:e=>p({...h,rabiesExpiryDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:(new Date).toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"混合ワクチン接種証明書 *"}),e.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var s;const r=null==(s=e.target.files)?void 0:s[0];if(r){const e=k(r);if(!e.isValid)return void i(e.error||"ファイルの検証に失敗しました");i("")}p({...h,comboVaccineImage:r||null})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"混合ワクチン有効期限 *"}),e.jsx("input",{type:"date",value:h.comboExpiryDate,onChange:e=>p({...h,comboExpiryDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:(new Date).toISOString().split("T")[0],required:!0})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-800",children:"※ ワクチン接種証明書は運営による確認後に承認されます。承認されるまでドッグランの利用はできません。"})}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("span",{className:"font-medium",children:"ワクチン証明書について:"}),e.jsx("br",{}),"• 管理者が確認しやすい形で保存されます",e.jsx("br",{}),"• 承認されると正式にワクチン情報として登録されます",e.jsx("br",{}),"• 承認後、全国のドッグランをご利用いただけます"]})})]}),e.jsx(N,{type:"submit",isLoading:t,className:"w-full",children:"ワンちゃんを登録する"})]})})]})}},Symbol.toStringTag,{value:"Module"})),Y=[{title:"ワンちゃんが食べてはいけない食べ物",image:"https://images.pexels.com/photos/1108099/pexels-photo-1108099.jpeg?auto=compress&w=300",path:"/dog-info/foods"},{title:"狂犬病予防や混合ワクチンの重要性",image:"https://images.pexels.com/photos/1404819/pexels-photo-1404819.jpeg?auto=compress&w=300",path:"/dog-info/vaccine"},{title:"犬種ごとにかかりやすい主な病気",image:"https://images.pexels.com/photos/1108098/pexels-photo-1108098.jpeg?auto=compress&w=300",path:"/dog-info/breeds"},{title:"フィラリア・ダニ・ノミなど寄生虫の危険性",image:"https://images.pexels.com/photos/458799/pexels-photo-458799.jpeg?auto=compress&w=300",path:"/dog-info/parasite"},{title:"ワンちゃん用おやつやおもちゃの重要性",image:"https://images.pexels.com/photos/1108097/pexels-photo-1108097.jpeg?auto=compress&w=300",path:"/dog-info/snack"},{title:"ドッグショーについて",image:"https://images.pexels.com/photos/458804/pexels-photo-458804.jpeg?auto=compress&w=300",path:"/dog-info/show"}],G=Object.freeze(Object.defineProperty({__proto__:null,default:function(){return e.jsxs("div",{className:"max-w-5xl mx-auto py-8 px-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"ワンちゃんについての情報発信"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:Y.map((s=>e.jsx(x,{to:s.path,className:"block group",children:e.jsxs("div",{className:"bg-white rounded-xl shadow hover:shadow-lg transition p-4 flex flex-col items-center cursor-pointer h-full",children:[e.jsx("img",{src:s.image,alt:s.title,className:"w-28 h-28 object-cover rounded-full mb-3 border-4 border-yellow-100 group-hover:border-yellow-400 transition"}),e.jsx("h2",{className:"text-base font-semibold text-center mb-1 group-hover:text-yellow-700 transition",children:s.title})]})},s.title)))})]})}},Symbol.toStringTag,{value:"Module"})),B=Object.freeze(Object.defineProperty({__proto__:null,default:function(){return e.jsxs("div",{className:"max-w-2xl mx-auto py-8 px-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4 text-center",children:"犬種ごとにかかりやすい主な病気"}),e.jsx("img",{src:"https://images.pexels.com/photos/1108098/pexels-photo-1108098.jpeg?auto=compress&w=400",alt:"犬種と病気",className:"w-full max-w-md mx-auto rounded-lg mb-6"}),e.jsx("p",{className:"mb-4",children:"犬種ごとに体質や遺伝的傾向があり、なりやすい病気も異なります。代表的な例と予防策を紹介します。"}),e.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[e.jsxs("li",{children:[e.jsx("b",{children:"ダックスフンド"}),"：椎間板ヘルニア（胴長短足のため）。→体重管理・段差注意"]}),e.jsxs("li",{children:[e.jsx("b",{children:"トイプードル"}),"：膝蓋骨脱臼（小型犬に多い）。→滑りにくい床・適度な運動"]}),e.jsxs("li",{children:[e.jsx("b",{children:"柴犬"}),"：アトピー性皮膚炎。→こまめなシャンプー・アレルゲン管理"]})]}),e.jsx("p",{children:"犬種ごとの特徴を知り、早期発見・予防に努めましょう。"})]})}},Symbol.toStringTag,{value:"Module"})),W=Object.freeze(Object.defineProperty({__proto__:null,default:function(){return e.jsxs("div",{className:"max-w-2xl mx-auto py-8 px-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4 text-center",children:"狂犬病予防や混合ワクチンの重要性"}),e.jsx("img",{src:"https://images.pexels.com/photos/1404819/pexels-photo-1404819.jpeg?auto=compress&w=400",alt:"ワクチン接種",className:"w-full max-w-md mx-auto rounded-lg mb-6"}),e.jsx("p",{className:"mb-4",children:"ワクチン接種はワンちゃんと社会全体を守るために不可欠です。狂犬病予防接種は法律で義務付けられており、未接種には罰則もあります。"}),e.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[e.jsx("li",{children:"狂犬病予防接種は年1回、飼い主の義務（狂犬病予防法）。"}),e.jsx("li",{children:"混合ワクチンは感染症からワンちゃんを守る。"}),e.jsx("li",{children:"未接種だと命に関わる病気や、他のワンちゃん・人への感染リスクも。"})]}),e.jsx("p",{children:"ワクチンは飼い主の責任。必ず動物病院で接種しましょう。"})]})}},Symbol.toStringTag,{value:"Module"})),J=Object.freeze(Object.defineProperty({__proto__:null,default:function(){return e.jsxs("div",{className:"max-w-2xl mx-auto py-8 px-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4 text-center",children:"ワンちゃんが食べてはいけない食べ物"}),e.jsx("img",{src:"https://images.pexels.com/photos/1108099/pexels-photo-1108099.jpeg?auto=compress&w=400",alt:"危険な食べ物",className:"w-full max-w-md mx-auto rounded-lg mb-6"}),e.jsx("p",{className:"mb-4",children:"ワンちゃんにとって危険な食べ物は意外と多く、誤食すると命に関わることもあります。代表的なものとその理由をまとめました。"}),e.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[e.jsxs("li",{children:[e.jsx("b",{children:"チョコレート"}),"：テオブロミンが中毒を起こし、嘔吐・けいれん・最悪の場合死に至ることも。"]}),e.jsxs("li",{children:[e.jsx("b",{children:"ぶどう・レーズン"}),"：腎不全を引き起こすことがあり、少量でも危険。"]}),e.jsxs("li",{children:[e.jsx("b",{children:"玉ねぎ・ねぎ類"}),"：赤血球を壊し、貧血や血尿の原因に。"]}),e.jsxs("li",{children:[e.jsx("b",{children:"アボカド"}),"：ペルシンという成分が中毒を起こす。"]}),e.jsxs("li",{children:[e.jsx("b",{children:"キシリトール"}),"：血糖値の急激な低下や肝障害を引き起こす。"]}),e.jsxs("li",{children:[e.jsx("b",{children:"アルコール・カフェイン"}),"：中枢神経に作用し、命に関わる。"]})]}),e.jsx("p",{children:"人間には無害でも、ワンちゃんには危険な食材が多くあります。食卓やゴミ箱の管理、誤食時の早期受診が大切です。"})]})}},Symbol.toStringTag,{value:"Module"})),K=Object.freeze(Object.defineProperty({__proto__:null,default:function(){return e.jsxs("div",{className:"max-w-2xl mx-auto py-8 px-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4 text-center",children:"ワンちゃん用おやつやおもちゃの重要性"}),e.jsx("img",{src:"https://images.pexels.com/photos/1108097/pexels-photo-1108097.jpeg?auto=compress&w=400",alt:"ワンちゃん用おやつとおもちゃ",className:"w-full max-w-md mx-auto rounded-lg mb-6"}),e.jsx("p",{className:"mb-4",children:"ワンちゃん用おやつやおもちゃは、歯みがき効果やストレス発散など、健康維持に役立ちます。選び方のポイントも紹介します。"}),e.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[e.jsx("li",{children:"歯みがきガムや噛むおもちゃは、歯石予防やストレス解消に役立つ。"}),e.jsx("li",{children:"安全な素材・サイズを選び、誤飲に注意。"}),e.jsx("li",{children:"与えすぎや壊れたおもちゃはNG。"})]}),e.jsx("p",{children:"ワンちゃんの性格や年齢に合ったものを選びましょう。"})]})}},Symbol.toStringTag,{value:"Module"})),H=Object.freeze(Object.defineProperty({__proto__:null,default:function(){return e.jsxs("div",{className:"max-w-2xl mx-auto py-8 px-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4 text-center",children:"フィラリア・ダニ・ノミなど寄生虫の危険性"}),e.jsx("img",{src:"https://images.pexels.com/photos/458799/pexels-photo-458799.jpeg?auto=compress&w=400",alt:"寄生虫対策",className:"w-full max-w-md mx-auto rounded-lg mb-6"}),e.jsx("p",{className:"mb-4",children:"寄生虫はワンちゃんの健康を脅かすだけでなく、人にも感染することがあります。主な症状や予防・対策を解説します。"}),e.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[e.jsxs("li",{children:[e.jsx("b",{children:"フィラリア"}),"：蚊が媒介し、心臓や肺に寄生。咳・元気消失・重症化で死に至る。"]}),e.jsxs("li",{children:[e.jsx("b",{children:"ノミ・ダニ"}),"：皮膚炎・貧血・バベシア症など。人にも感染することが。"]})]}),e.jsx("p",{children:"毎月の予防薬や、散歩後のチェックでしっかり対策しましょう。"})]})}},Symbol.toStringTag,{value:"Module"})),Q=Object.freeze(Object.defineProperty({__proto__:null,default:function(){return e.jsxs("div",{className:"max-w-2xl mx-auto py-8 px-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4 text-center",children:"ドッグショーについて"}),e.jsx("img",{src:"https://images.pexels.com/photos/458804/pexels-photo-458804.jpeg?auto=compress&w=400",alt:"ドッグショー",className:"w-full max-w-md mx-auto rounded-lg mb-6"}),e.jsx("p",{className:"mb-4",children:"ドッグショーはワンちゃん種ごとの美しさや能力を競うイベントです。観覧や参加の方法、今後の提案コーナーも紹介します。"}),e.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[e.jsx("li",{children:"ワンちゃん種ごとの美しさや能力を競うイベント。プロ・アマ問わず参加可能。"}),e.jsx("li",{children:"観覧は誰でもOK。ワンちゃん好き同士の交流の場にも。"}),e.jsx("li",{children:"「うちの子も出てみたい！」という方は、主催団体やクラブに相談を。"})]}),e.jsx("p",{children:"今後、地域のドッグショー情報や体験レポートも掲載予定です！"})]})}},Symbol.toStringTag,{value:"Module"})),X=Object.freeze(Object.defineProperty({__proto__:null,DogProfile:function(){const{id:s,dogId:r}=h(),{user:t}=S();p();const[a,i]=m.useState(null),[o,n]=m.useState(!0),[c,d]=m.useState(""),[u,w]=m.useState(""),[_,C]=m.useState(!1),[$,k]=m.useState(!1),[I,q]=m.useState([]),[P,z]=m.useState(!1),[M,T]=m.useState(0),[O,R]=m.useState(!1),V=s||r;m.useEffect((()=>{V&&(F(),t&&(U(),A()))}),[V,t]);const F=async()=>{try{n(!0),d("");const{data:e,error:s}=await E.from("dogs").select("*").eq("id",V).single();if(s)throw s;i(e),T(e.like_count||0);const{data:r,error:t}=await E.from("reservations").select("\n          *,\n          dog_park:dog_parks(*)\n        ").eq("dog_id",V).eq("status","confirmed");if(t)throw t;const a={};(r||[]).forEach((e=>{const s=e.park_id;e.dog_park&&(a[s]||(a[s]={park:e.dog_park,visits:0}),a[s].visits++)}));const l=Object.values(a).sort(((e,s)=>s.visits-e.visits)).slice(0,3);q(l)}catch(e){d("ワンちゃんの情報を取得できませんでした。")}finally{n(!1)}},U=async()=>{if(t&&V)try{const{data:e}=await E.from("dogs").select("owner_id").eq("id",V).single();if(!e)return;const{data:s,error:r}=await E.from("friend_requests").select("id, status").or(`and(requester_id.eq.${t.id},requested_id.eq.${e.owner_id}),and(requester_id.eq.${e.owner_id},requested_id.eq.${t.id})`).maybeSingle();!r&&s&&k(!0)}catch(e){}},A=async()=>{if(t&&V)try{const{data:e,error:s}=await E.from("dog_likes").select("id").eq("user_id",t.id).eq("dog_id",V).maybeSingle();!s&&e&&z(!0)}catch(e){}};return o?e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):c||!a?e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:e.jsxs(D,{className:"p-8 text-center",children:[e.jsx(l,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"ワンちゃんが見つかりません"}),e.jsx("p",{className:"text-gray-600 mb-6",children:c||"ワンちゃんの情報が見つかりませんでした。"}),e.jsx(x,{to:"/",children:e.jsxs(N,{variant:"primary",children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"ホームに戻る"]})})]})}):e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(x,{to:"/",className:"flex items-center text-gray-600 hover:text-gray-800 transition-colors",children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"ホームに戻る"]})}),u&&e.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start",children:[e.jsx(b,{className:"w-5 h-5 text-green-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsx("p",{className:"text-green-800",children:u})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(D,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-48 h-48 bg-gray-200 rounded-lg overflow-hidden",children:a.image_url?e.jsx("img",{src:a.image_url,alt:a.name,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="https://images.pexels.com/photos/58997/pexels-photo-58997.jpeg?auto=compress&cs=tinysrgb&w=300"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx(l,{className:"w-12 h-12"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:[a.name,(L=a.gender,"オス"===L?"くん":"ちゃん")]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"w-5 h-5 text-gray-500 mr-3"}),e.jsxs("span",{className:"text-lg text-gray-700",children:[(e=>{const s=new Date,r=new Date(e);let t=s.getFullYear()-r.getFullYear();const a=s.getMonth()-r.getMonth();return(a<0||0===a&&s.getDate()<r.getDate())&&t--,t})(a.birth_date),"歳"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(l,{className:"w-5 h-5 text-gray-500 mr-3"}),e.jsx("span",{className:"text-lg text-gray-700",children:a.breed})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{className:"w-5 h-5 text-gray-500 mr-3"}),e.jsx("span",{className:"text-lg text-gray-700",children:a.gender})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:"text-sm text-gray-600",children:[M,"件のいいね"]})}),t&&e.jsxs(N,{onClick:async()=>{if(t&&a&&!O){R(!0);try{if(P){const{error:e}=await E.from("dog_likes").delete().eq("user_id",t.id).eq("dog_id",a.id);if(e)throw e;z(!1),T((e=>e-1)),w("いいねを取り消しました")}else{const{error:e}=await E.from("dog_likes").insert({user_id:t.id,dog_id:a.id});if(e)throw e;z(!0),T((e=>e+1)),w("いいねしました")}setTimeout((()=>w("")),2e3)}catch(e){d("いいねの処理に失敗しました"),setTimeout((()=>d("")),3e3)}finally{R(!1)}}},disabled:O,variant:P?"primary":"secondary",size:"sm",className:"px-4 py-2 "+(P?"bg-pink-500 hover:bg-pink-600 text-white":"bg-white hover:bg-pink-50 text-pink-600 border-pink-300"),children:[e.jsx(j,{className:"w-4 h-4 mr-1 "+(P?"fill-current":"")}),P?"いいね済み":"いいね"]})]})}),t&&a.owner_id!==t.id&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("div",{className:"text-center",children:$?e.jsxs("div",{className:"flex items-center justify-center text-green-600",children:[e.jsx(b,{className:"w-5 h-5 mr-2"}),e.jsx("span",{className:"font-medium",children:"友達申請済み"})]}):e.jsxs(N,{onClick:async()=>{if(t&&a){C(!0);try{const{error:e}=await E.from("friend_requests").insert({requester_id:t.id,requested_id:a.owner_id,message:"ドッグランでお会いした際は、よろしくお願いします！"});if(e)throw e;k(!0),w("友達申請を送信しました"),setTimeout((()=>w("")),3e3)}catch(e){d("友達申請の送信に失敗しました"),setTimeout((()=>d("")),3e3)}finally{C(!1)}}},isLoading:_,className:"px-8 py-3",children:[e.jsx(y,{className:"w-5 h-5 mr-2"}),"友達申請を送る"]})}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"友達申請について"}),e.jsx("p",{children:"友達申請を送ると、相手の飼い主さんに通知が届きます。 承認されると、メッセージのやり取りができるようになります。"})]})})]})]})]})})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(D,{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(v,{className:"w-5 h-5 text-green-600 mr-2"}),"よく遊ぶドッグラン"]}),I.length>0?e.jsx("div",{className:"space-y-3",children:I.map(((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.park.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.visits,"回利用"]})]}),e.jsx("div",{className:"text-2xl",children:0===r?"🥇":1===r?"🥈":"🥉"})]},s.park.id)))}):e.jsx("p",{className:"text-gray-500",children:"まだドッグランの利用履歴がありません"})]}),e.jsxs(D,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"登録日"}),e.jsx("p",{className:"text-gray-700",children:new Date(a.created_at).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"})})]})]})]})]});var L}},Symbol.toStringTag,{value:"Module"}));export{V as D,O as V,M as _,U as a,A as b,L as c,G as d,B as e,W as f,R as g,J as h,K as i,H as j,Q as k,X as l};
