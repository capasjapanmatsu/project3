var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(s,t,n)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n,l=(e,s)=>{for(var t in s||(s={}))a.call(s,t)&&i(e,t,s[t]);if(n)for(var t of n(s))r.call(s,t)&&i(e,t,s[t]);return e},o=(e,s,t)=>new Promise(((n,a)=>{var r=e=>{try{l(t.next(e))}catch(s){a(s)}},i=e=>{try{l(t.throw(e))}catch(s){a(s)}},l=e=>e.done?n(e.value):Promise.resolve(e.value).then(r,i);l((t=t.apply(e,s)).next())}));import{j as c,B as d,C as m,u as x,s as u}from"./index.oOj2R_C7.js";import{L as h,R as f,r as g}from"./router.icJHpBzt.js";import{a as b,j as p,R as j,P as y,B as w,k as N,l as v,m as k,F as I,n as D,o as M,p as S,e as E,U as L,q as O,r as R}from"./ui.UnEvinBv.js";import{l as _}from"./logger.NUDfUq4J.js";import"./vendor.D1SiiUJb.js";import"./supabase.CZ8ekJUM.js";const C=({isLoggedIn:e})=>e?c.jsxs("section",{className:"text-center py-8",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"おかえりなさい！"}),c.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"今日も愛犬と素敵な時間をお過ごしください"}),c.jsxs("div",{className:"flex justify-center space-x-4",children:[c.jsx(h,{to:"/parks",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"ドッグランを探す"}),c.jsx(h,{to:"/dashboard",className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors font-medium",children:"マイページ"})]})]}):c.jsxs("section",{className:"text-center py-12",children:[c.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"愛犬とのお散歩を、もっと楽しく"}),c.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"近くのドッグランを見つけて、新しい出会いを見つけましょう"}),c.jsxs("div",{className:"flex justify-center space-x-4",children:[c.jsx(h,{to:"/register",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"無料で始める"}),c.jsx(h,{to:"/magic-link",className:"bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium",children:"Magic Linkで簡単ログイン"})]})]}),P=({isOffline:e,networkError:s,onRetryConnection:t})=>s?c.jsx("div",{className:"border rounded-lg p-4 mb-6 "+(e?"bg-orange-50 border-orange-200":"bg-red-50 border-red-200"),children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[e?c.jsx(b,{className:"w-6 h-6 text-orange-600"}):c.jsx(p,{className:"w-6 h-6 text-red-600"}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-medium "+(e?"text-orange-800":"text-red-800"),children:e?"オフラインモード":"接続エラー"}),c.jsx("p",{className:"text-sm whitespace-pre-line "+(e?"text-orange-700":"text-red-700"),children:s})]})]}),c.jsxs(d,{onClick:t,size:"sm",className:(e?"bg-orange-600 hover:bg-orange-700":"bg-red-600 hover:bg-red-700")+" text-white",children:[c.jsx(j,{className:"w-4 h-4 mr-2"}),"再接続"]})]})}):null,$=f.memo((({recentDogs:e,isOffline:s,isLoading:t=!1})=>{const n=g.useMemo((()=>[...e,...e]),[e]),a=g.useMemo((()=>Array.isArray(e)&&e.length>0),[e]);return c.jsxs("section",{className:"bg-gray-50 p-6 rounded-lg",children:[c.jsx("div",{className:"flex justify-between items-center mb-6",children:c.jsxs("div",{className:"relative",children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[c.jsx(y,{className:"w-6 h-6 text-blue-600 mr-2"}),"最近仲間入りしました！"]}),c.jsx("div",{className:"absolute -top-10 -left-16",children:c.jsx("div",{className:"bg-yellow-100 rounded-full px-4 py-2 text-yellow-800 font-bold transform -rotate-12",children:"New"})})]})}),c.jsx("div",{className:"overflow-hidden w-full relative",style:{height:140},children:t?c.jsx("div",{className:"flex items-center justify-center h-full",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),c.jsx("span",{className:"text-gray-600",children:"新しい仲間を探しています..."})]})}):a?c.jsx("div",{className:"flex items-center whitespace-nowrap",style:{width:"max-content",animation:"marquee 45s linear infinite",willChange:"transform",transform:"translateZ(0)"},children:n.map(((e,s)=>c.jsx(A,{dog:e},`${e.id}-${s}`)))}):c.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 text-center",children:c.jsxs("div",{children:[c.jsx(y,{className:"w-12 h-12 mx-auto mb-2 text-gray-400"}),c.jsx("p",{className:"text-lg font-medium",children:s?"オフライン中です":"新しい仲間を募集中！"}),c.jsx("p",{className:"text-sm mt-1",children:s?"接続を確認してください":"ワンちゃんの登録をお待ちしています"}),!s&&c.jsx("p",{className:"text-xs mt-2 text-gray-400",children:"登録されたワンちゃんがいません"}),c.jsxs("div",{className:"text-xs text-gray-400 mt-2",children:["Debug: dogs=",(null==e?void 0:e.length)||0,", offline=",s?"true":"false",", loading=",t?"true":"false"]})]})})}),c.jsx("style",{children:"\n          @keyframes marquee {\n            0% {\n              transform: translateX(0) translateZ(0);\n            }\n            100% {\n              transform: translateX(-50%) translateZ(0);\n            }\n          }\n          \n          /* GPUアクセラレーション用の最適化 */\n          .marquee-container {\n            backface-visibility: hidden;\n            -webkit-backface-visibility: hidden;\n            -moz-backface-visibility: hidden;\n            -ms-backface-visibility: hidden;\n            -webkit-transform: translateZ(0);\n            -moz-transform: translateZ(0);\n            -ms-transform: translateZ(0);\n            transform: translateZ(0);\n          }\n        "})]})})),A=f.memo((({dog:e})=>{const[s,t]=g.useState(!1),[n,a]=g.useState(!1),r=g.useMemo((()=>e.image_url?e.image_url.includes("supabase")?`${e.image_url}?width=80&height=80&quality=80`:e.image_url:null),[e.image_url]);return g.useEffect((()=>{if(r){(new Image).src=r}}),[r]),c.jsxs("div",{className:"inline-block mx-4 text-center",style:{width:100,flexShrink:0},children:[c.jsxs("div",{className:"relative w-20 h-20 mx-auto mb-2 bg-gray-200 rounded-full overflow-hidden",children:[!s&&!n&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:c.jsx("div",{className:"w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"})}),r&&!n?c.jsx("img",{src:r,alt:e.name,className:"w-full h-full object-cover transition-opacity duration-200 "+(s?"opacity-100":"opacity-0"),onLoad:()=>{t(!0)},onError:()=>{a(!0),t(!0)},loading:"eager",decoding:"sync",width:80,height:80}):c.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-2xl",children:"🐕"})]}),c.jsx("div",{className:"text-xs text-gray-600 truncate font-medium",children:e.name}),c.jsx("div",{className:"text-xs text-gray-500 truncate",children:e.breed})]})}));$.displayName="MarqueeDogsSection",A.displayName="DogCard";const T=({news:e,isOffline:s,isLoading:t,onRetryConnection:n})=>{const a=e=>{switch(e){case"news":return c.jsx(I,{className:"w-4 h-4"});case"announcement":return c.jsx(k,{className:"w-4 h-4"});case"sale":return c.jsx(v,{className:"w-4 h-4"});default:return c.jsx(w,{className:"w-4 h-4"})}},r=e=>({news:"お知らせ",announcement:"重要なお知らせ",sale:"セール情報"}[e]||e),i=({message:e})=>c.jsx(m,{className:"p-4",children:c.jsxs("div",{className:"text-center text-gray-500",children:[c.jsx(b,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),c.jsx("p",{children:e}),c.jsxs(d,{onClick:n,size:"sm",variant:"secondary",className:"mt-2",children:[c.jsx(j,{className:"w-4 h-4 mr-2"}),"再接続"]})]})}),l=()=>c.jsx(m,{className:"p-4",children:c.jsxs("div",{className:"text-center text-gray-500",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),c.jsx("p",{children:"新着情報を読み込み中..."})]})}),o=()=>c.jsx(m,{className:"p-4",children:c.jsxs("div",{className:"text-center text-gray-500",children:[c.jsx(w,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),c.jsx("p",{children:"現在、表示できる新着情報はありません"}),c.jsxs(d,{onClick:n,size:"sm",variant:"secondary",className:"mt-2",children:[c.jsx(j,{className:"w-4 h-4 mr-2"}),"再読み込み"]})]})});return c.jsxs("section",{className:"bg-blue-50 p-4 rounded-lg",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center",children:[c.jsx(w,{className:"w-5 h-5 text-blue-600 mr-2"}),"新着情報"]}),c.jsxs(h,{to:"/news",className:"text-blue-600 hover:text-blue-800 flex items-center text-sm",children:["すべて見る",c.jsx(N,{className:"w-4 h-4 ml-1"})]})]}),c.jsx("div",{className:"space-y-3",children:s?c.jsx(i,{message:"オフライン：新着情報を読み込めません"}):t?c.jsx(l,{}):0===e.length?c.jsx(o,{}):e.slice(0,2).map((e=>{return c.jsx(h,{to:`/news/${e.id}`,children:c.jsx(m,{className:"p-3 hover:shadow-md transition-shadow",children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[c.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex items-center ${t=e.category,{news:"bg-blue-100 text-blue-800",announcement:"bg-red-100 text-red-800",sale:"bg-green-100 text-green-800"}[t]||"bg-gray-100 text-gray-800"}`,children:[a(e.category),c.jsx("span",{className:"ml-1",children:r(e.category)})]}),e.is_important&&c.jsx("span",{className:"bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-medium",children:"重要"})]}),c.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:e.title}),e.content&&c.jsx("p",{className:"text-sm text-gray-600 line-clamp-1 mb-1",children:e.content}),c.jsx("p",{className:"text-xs text-gray-500",children:(s=e.created_at,new Date(s).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}))})]}),c.jsx(N,{className:"w-4 h-4 text-gray-400 ml-4"})]})})},e.id);var s,t}))}),c.jsx("div",{className:"mt-4 text-center",children:c.jsx(h,{to:"/news",children:c.jsxs(d,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:["すべての新着情報を見る",c.jsx(N,{className:"w-4 h-4 ml-2"})]})})})]})},z=()=>{const{user:e}=x();return c.jsx("section",{className:"relative overflow-hidden",children:c.jsxs("div",{className:"bg-gradient-to-r from-green-600 via-blue-600 to-purple-600 text-white p-8 rounded-xl shadow-2xl",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"bg-white/20 p-3 rounded-full",children:c.jsx(D,{className:"w-8 h-8"})}),c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold mb-2 flex items-center",children:[c.jsx(M,{className:"w-6 h-6 mr-2"}),"ドッグランオーナー募集中！"]}),c.jsx("p",{className:"text-lg opacity-90",children:"あなたの土地をドッグランとして活用しませんか？収益化のチャンスです"})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsx(h,{to:e?"/park-registration-agreement":"/register",children:c.jsxs(d,{className:"bg-white hover:bg-gray-100 text-purple-700 font-bold px-6 py-3 text-lg shadow-md",children:[c.jsx(S,{className:"w-5 h-5 mr-2"}),e?"オーナー契約に進む":"オーナー登録"]})}),c.jsx("p",{className:"text-sm opacity-80 mt-2",children:"初期費用無料・サポート充実"})]})]}),c.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"}),c.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full -ml-12 -mb-12"})]})})},U=({isLoggedIn:e})=>{const s=[{icon:c.jsx(E,{className:"h-12 w-12 text-blue-600 mx-auto mb-4 group-hover:scale-110 transition-transform"}),title:"簡単検索",description:"お近くのドッグランを簡単に見つけることができます",linkTo:"/parks",color:"text-blue-600"},{icon:c.jsx(L,{className:"h-12 w-12 text-purple-600 mx-auto mb-4 group-hover:scale-110 transition-transform"}),title:"コミュニティ",description:"愛犬家同士で交流を深めることができます",linkTo:e?"/community":"/login",color:"text-purple-600"},{icon:c.jsx(O,{className:"h-12 w-12 text-orange-600 mx-auto mb-4 group-hover:scale-110 transition-transform"}),title:"予約管理",description:"施設の予約をオンラインで簡単に管理",linkTo:e?"/dashboard":"/login",color:"text-orange-600"},{icon:c.jsx(R,{className:"h-12 w-12 text-green-600 mx-auto mb-4 group-hover:scale-110 transition-transform"}),title:"ペットショップ",description:"ペット用品をワンタッチで簡単注文",linkTo:"/shop",color:"text-green-600"}];return c.jsx("section",{className:"grid md:grid-cols-4 gap-8 mt-12",children:s.map(((e,s)=>c.jsxs(h,{to:e.linkTo,className:"text-center p-6 hover:bg-gray-50 rounded-lg transition-colors cursor-pointer group",children:[e.icon,c.jsx("h3",{className:"text-xl font-semibold mb-2",children:e.title}),c.jsx("p",{className:"text-gray-600",children:e.description})]},s)))})},q=()=>c.jsxs(c.Fragment,{children:[c.jsx("section",{className:"bg-blue-50 p-6 rounded-lg",children:c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-xl font-bold text-blue-900 mb-4",children:"ご利用前に必ずお読みください"}),c.jsx("p",{className:"text-blue-800 mb-4",children:"安全で楽しいドッグラン利用のため、利用ルールをご確認ください"}),c.jsx(h,{to:"/parks/rules",children:c.jsxs(d,{className:"bg-blue-600 hover:bg-blue-700",children:[c.jsx(I,{className:"w-4 h-4 mr-2"}),"ドッグラン利用ルールを確認"]})})]})}),c.jsxs("section",{className:"bg-blue-50 p-6 rounded-lg",children:[c.jsx("h2",{className:"text-2xl font-bold text-center text-blue-900 mb-6",children:"料金体系"}),c.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:"単発利用"}),c.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"¥800"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"1回の利用料金"}),c.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[c.jsx("li",{children:"• 最大3時間まで"}),c.jsx("li",{children:"• 愛犬3頭まで"}),c.jsx("li",{children:"• 全国の提携施設で利用可能"})]})]}),c.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-blue-600 text-white p-6 rounded-lg shadow-lg transform scale-105",children:[c.jsx("h3",{className:"text-xl font-semibold mb-3",children:"サブスクリプション"}),c.jsxs("div",{className:"text-3xl font-bold mb-2",children:["¥3,800",c.jsx("span",{className:"text-lg",children:"/月"})]}),c.jsx("p",{className:"mb-4 opacity-90",children:"使い放題プラン"}),c.jsxs("ul",{className:"text-sm space-y-1 opacity-90",children:[c.jsx("li",{children:"• 全国のドッグラン使い放題"}),c.jsx("li",{children:"• ペットショップ10%OFF"}),c.jsx("li",{children:"• 優先予約権"}),c.jsx("li",{children:"• 専用サポート"})]}),c.jsx("div",{className:"mt-4",children:c.jsx("span",{className:"bg-white text-purple-600 px-3 py-1 rounded-full text-xs font-medium",children:"おすすめ"})})]}),c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:"施設貸し切り"}),c.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"¥4,400"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"1時間の貸し切り料金"}),c.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[c.jsx("li",{children:"• 完全プライベート空間"}),c.jsx("li",{children:"• 愛犬制限なし"}),c.jsx("li",{children:"• イベント・パーティーに最適"})]})]})]}),c.jsx("div",{className:"text-center mt-8",children:c.jsx(h,{to:"/register",children:c.jsx(d,{className:"bg-blue-600 hover:bg-blue-700 text-lg px-8 py-3",children:"今すぐ始める"})})})]})]}),B=[{href:"#main-content",label:"メインコンテンツにスキップ"},{href:"#navigation",label:"ナビゲーションにスキップ"},{href:"#footer",label:"フッターにスキップ"}],F=({links:e=B,className:s=""})=>{const[t,n]=g.useState(!1);g.useEffect((()=>{const e=e=>{if("Escape"===e.key&&t){n(!1);const e=document.querySelector('a[href], button, textarea, input[type="text"], input[type="radio"], input[type="checkbox"], select');null==e||e.focus()}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[t]);const a=()=>n(!0),r=()=>n(!1);return c.jsxs("nav",{className:`skip-navigation fixed top-0 left-0 z-[9999] ${s}`,"aria-label":"スキップナビゲーション",children:[c.jsx("ul",{className:"flex flex-col",children:e.map(((e,s)=>c.jsx("li",{children:c.jsx("a",{href:e.href,className:`\n                inline-block px-4 py-2 bg-blue-700 text-white font-medium text-sm\n                transform transition-transform duration-200 border border-blue-800\n                focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-blue-700\n                ${t?"translate-y-0 opacity-100":"-translate-y-full opacity-0 sr-only focus:not-sr-only focus:translate-y-0 focus:opacity-100"}\n              `,onFocus:a,onBlur:r,onClick:s=>{s.preventDefault(),(e=>{const s=document.querySelector(e);if(s){s.scrollIntoView({behavior:"smooth",block:"start"});const e=s.querySelector('a[href], button, textarea, input, select, [tabindex]:not([tabindex="-1"])');e?e.focus():(s.tabIndex=-1,s.focus(),s.style.outline="none")}n(!1)})(e.href)},tabIndex:0,children:e.label})},e.href)))}),c.jsx("div",{className:"sr-only",children:c.jsx("p",{children:"このページのスキップリンクです。Tabキーでアクセスし、Enterキーで移動できます。 Escapeキーでスキップリンクを閉じることができます。"})})]})},Z={xs:0,sm:640,md:768,lg:1024,xl:1280,"2xl":1536};function J(e){const s=g.useMemo((()=>l(l({},Z),e)),[e]),[t,n]=g.useState({width:"undefined"!=typeof window?window.innerWidth:1024,height:"undefined"!=typeof window?window.innerHeight:768}),[a,r]=g.useState("md");g.useEffect((()=>{const e=()=>{const e=window.innerWidth;n({width:e,height:window.innerHeight}),e>=s["2xl"]?r("2xl"):e>=s.xl?r("xl"):e>=s.lg?r("lg"):e>=s.md?r("md"):e>=s.sm?r("sm"):r("xs")};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const i=e=>t.width>=s[e],o=e=>t.width<s[e],c=(e,n)=>t.width>=s[e]&&t.width<s[n],d=o("md"),m=c("md","lg"),x=i("lg"),u="ontouchstart"in window||navigator.maxTouchPoints>0,h="undefined"!=typeof window&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,f="undefined"!=typeof window&&window.matchMedia("(prefers-color-scheme: dark)").matches;return{windowSize:t,currentBreakpoint:a,breakpoints:s,isAbove:i,isBelow:o,isBetween:c,isMobile:d,isTablet:m,isDesktop:x,isTouchDevice:u,prefersReducedMotion:h,prefersDarkMode:f}}const H=g.forwardRef(((e,i)=>{var o=e,{children:d,animation:m="fadeIn",duration:x="normal",easing:u="ease-out",delay:h=0,repeat:f=!1,triggerOnce:g=!0,threshold:b=.1,as:p="div",respectReducedMotion:j=!0,fallbackAnimation:y="fadeIn",className:w=""}=o,N=((e,s)=>{var t={};for(var i in e)a.call(e,i)&&s.indexOf(i)<0&&(t[i]=e[i]);if(null!=e&&n)for(var i of n(e))s.indexOf(i)<0&&r.call(e,i)&&(t[i]=e[i]);return t})(o,["children","animation","duration","easing","delay","repeat","triggerOnce","threshold","as","respectReducedMotion","fallbackAnimation","className"]);const{prefersReducedMotion:v}=J(),k=j&&v,I=h>0?{animationDelay:`${h}ms`}:{},D=`${[{fadeIn:k?"opacity-100 transition-opacity":"opacity-0 animate-fade-in",slideUp:k?"transform-none transition-transform":"transform translate-y-4 animate-slide-up",slideDown:k?"transform-none transition-transform":"transform -translate-y-4 animate-slide-down",slideLeft:k?"transform-none transition-transform":"transform translate-x-4 animate-slide-left",slideRight:k?"transform-none transition-transform":"transform -translate-x-4 animate-slide-right",scale:k?"transform-none transition-transform":"transform scale-95 animate-scale-in",bounce:k?"transform-none":"animate-bounce",pulse:k?"opacity-100":"animate-pulse",spin:k?"transform-none":"animate-spin"}[k?y:m],{fast:"duration-200",normal:"duration-500",slow:"duration-1000"}[x],{linear:"ease-linear",ease:"ease","ease-in":"ease-in","ease-out":"ease-out","ease-in-out":"ease-in-out"}[u],!0===f?"animation-iteration-count-infinite":"number"==typeof f?`animation-iteration-count-${f}`:"","transition-all"].filter(Boolean).join(" ")} ${w}`.trim(),M=p;return c.jsx(M,(S=l({ref:i,className:D,style:l(l({},I),N.style),"aria-hidden":k?void 0:"false"},N),s(S,t({children:d}))));var S}));H.displayName="AnimatedElement";const W=g.forwardRef(((e,s)=>c.jsx(H,l({ref:s,animation:"fadeIn"},e))));W.displayName="FadeIn";const X=g.forwardRef(((e,s)=>c.jsx(H,l({ref:s,animation:"slideUp"},e))));X.displayName="SlideUp";function G(){const{user:e}=x(),[s,t]=g.useState([]),[n,a]=g.useState([]),[r,i]=g.useState(!1),[l,d]=g.useState(null),[m,h]=g.useState(!0),[f,b]=g.useState(!0),{isMobile:p,prefersReducedMotion:j}=J(),y=g.useMemo((()=>[{href:"#main-content",label:"メインコンテンツにスキップ"},{href:"#hero-section",label:"ヒーローセクションにスキップ"},{href:"#features-section",label:"機能紹介にスキップ"},{href:"#news-section",label:"新着情報にスキップ"},{href:"#usage-rules",label:"利用方法・料金にスキップ"}]),[]);g.useEffect((()=>{const e=()=>{i(!1),d(null)},s=()=>{i(!0),d("インターネット接続が切断されました。\nオフラインモードで表示しています。")};return window.addEventListener("online",e),window.addEventListener("offline",s),navigator.onLine||s(),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}}),[]);const w=6e5,N=g.useMemo((()=>new Map),[]),v=g.useCallback((e=>{const s=N.get(e);return s&&Date.now()-s.timestamp<w?s.data:(s&&N.delete(e),null)}),[N,w]),k=g.useCallback(((e,s)=>{N.set(e,{data:s,timestamp:Date.now()});try{localStorage.setItem(`dogpark_cache_${e}`,JSON.stringify({data:s,timestamp:Date.now()}))}catch(t){}}),[N]);g.useEffect((()=>{try{const e=localStorage.getItem("dogpark_cache_recentDogs");if(e){const s=JSON.parse(e);Date.now()-s.timestamp<w&&(N.set("recentDogs",s),t(s.data),h(!1),_.info("✅ ローカルストレージからキャッシュを復元:",s.data.length,"匹"))}}catch(e){}}),[N,w]);const I=g.useCallback((()=>o(null,null,(function*(){try{_.info("🐕 最近仲間入りしたワンちゃんを取得中...");const e=v("recentDogs");if(e)return _.info("✅ キャッシュから最近仲間入りしたワンちゃんを取得:",e.length,"匹"),t(e),h(!1),e;h(!0),d(null),_.info("🔍 データベースから直接取得...");const{data:s,error:n}=yield u.from("dogs").select("id, owner_id, name, breed, birth_date, gender, image_url, created_at").order("created_at",{ascending:!1}).limit(8);if(n)return _.warn("❌ Database error:",n),t([]),h(!1),[];_.info("✅ 最近仲間入りしたワンちゃん取得成功:",(null==s?void 0:s.length)||0,"匹");const a=s||[];return t(a),k("recentDogs",a),h(!1),a}catch(e){return _.warn("❌ Error fetching recent dogs:",e),t([]),h(!1),[]}}))),[v,k]),D=g.useCallback((()=>o(null,null,(function*(){try{_.info("📰 新着情報を取得中...");const e=v("news");if(e)return _.info("✅ キャッシュから新着情報を取得:",e.length,"件"),a(e),e;b(!0);const{data:s,error:t}=yield u.from("news_announcements").select("*").order("created_at",{ascending:!1}).limit(5);if(t)return _.error("❌ 新着情報取得エラー:",t),a([]),[];_.info("✅ 新着情報取得成功:",(null==s?void 0:s.length)||0,"件");const n=s||[];return a(n),k("news",n),n}catch(e){return _.error("❌ 新着情報取得例外:",e),a([]),[]}finally{b(!1),_.info("📰 新着情報取得処理完了")}}))),[v,k]),M=g.useCallback((()=>o(null,null,(function*(){_.info("🚀 高速データ取得を開始...");const e=Date.now();try{const s=new Promise(((e,s)=>{setTimeout((()=>s(new Error("Timeout"))),8e3)})),t=Promise.all([I(),D()]),[n,a]=yield Promise.race([t,s]),r=Date.now();return _.info(`✅ 高速データ取得完了: ${r-e}ms`),{dogs:n,news:a}}catch(s){_.error("❌ データ取得エラー:",s);const e={dogs:[],news:[]};try{const s=yield I();e.dogs=s}catch(t){_.warn("犬データの取得に失敗:",t)}try{const s=yield D();e.news=s}catch(n){_.warn("ニュースデータの取得に失敗:",n)}return e}}))),[I,D]);g.useEffect((()=>{0===s.length&&0===n.length&&M()}),[M,s.length,n.length]);const S=g.useCallback((()=>o(null,null,(function*(){N.clear(),yield M()}))),[M,N]),E=p?"fast":"normal",L=j?0:25,O=g.useMemo((()=>!!e),[e]);return c.jsxs(c.Fragment,{children:[c.jsx(F,{links:y}),c.jsxs("div",{className:"min-h-screen bg-gray-50",role:"main",children:[c.jsx(W,{duration:"fast",children:c.jsx(P,{isOffline:r,networkError:l,onRetryConnection:S})}),c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsx("section",{id:"hero-section","aria-label":"メインヒーロー",className:"focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 rounded-lg",tabIndex:-1,children:c.jsx(X,{duration:E,delay:0*L,children:c.jsx(C,{isLoggedIn:O})})}),c.jsx("section",{id:"news-section","aria-labelledby":"news-heading",className:"focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 rounded-lg",tabIndex:-1,children:c.jsxs(H,{animation:"slideUp",duration:E,delay:1*L,respectReducedMotion:!0,fallbackAnimation:"fadeIn",children:[c.jsx("h2",{id:"news-heading",className:"sr-only",children:"新着情報とお知らせ"}),c.jsx(T,{isOffline:r,onRetryConnection:S,news:n,isLoading:f})]})}),c.jsx("section",{"aria-label":"最近登録された愛犬たち",className:"focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 rounded-lg",tabIndex:-1,children:c.jsx(H,{animation:"slideUp",duration:E,delay:2*L,respectReducedMotion:!0,fallbackAnimation:"fadeIn",children:c.jsx($,{recentDogs:s,isOffline:r,isLoading:m})})}),c.jsxs("main",{id:"main-content",className:"space-y-12 py-8",children:[c.jsx("section",{id:"features-section","aria-labelledby":"features-heading",className:"focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 rounded-lg",tabIndex:-1,children:c.jsxs(H,{animation:"slideUp",duration:E,delay:3*L,respectReducedMotion:!0,fallbackAnimation:"fadeIn",children:[c.jsx("h2",{id:"features-heading",className:"sr-only",children:"アプリの主な機能"}),c.jsx(U,{isLoggedIn:O})]})}),c.jsx(H,{animation:"slideUp",duration:E,delay:4*L,respectReducedMotion:!0,fallbackAnimation:"fadeIn",children:c.jsx(z,{})}),c.jsx("section",{id:"usage-rules","aria-labelledby":"usage-heading",className:"focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 rounded-lg",tabIndex:-1,children:c.jsxs(H,{animation:"slideUp",duration:E,delay:5*L,respectReducedMotion:!0,fallbackAnimation:"fadeIn",children:[c.jsx("h2",{id:"usage-heading",className:"sr-only",children:"利用方法と料金について"}),c.jsx(q,{})]})})]})]})]}),c.jsxs("div",{"aria-live":"polite","aria-atomic":"true",className:"sr-only",id:"status-region",children:[r&&"オフラインモードです。",l&&"ネットワークエラーが発生しています。",m&&"データを読み込んでいます。"]}),c.jsx("div",{"aria-live":"assertive","aria-atomic":"true",className:"sr-only",id:"announcement-region"})]})}g.forwardRef(((e,s)=>c.jsx(H,l({ref:s,animation:"scale"},e)))).displayName="ScaleIn";export{G as Home};
