import{u as ye,s as o,j as e,B as l,C as m}from"./index-BB1ywuBb.js";import{u as _e,r,L as n}from"./react-vendor-Co5xHYdE.js";import{I as R}from"./Input-Bmh34ZUQ.js";import{R as Se,ao as E,Y as T,A as u,i as N,af as $,U as J,V as Ce,aG as ke,F as C,b as U,C as v,O as De,a as k,a3 as j,Q as K,z as A,a4 as Pe,v as ee,Z as ze,X as se,a5 as Fe}from"./ui-vendor-B2-VOB5s.js";import"./supabase-vendor-FDBaXLCh.js";function Ae(){const{user:d}=ye(),B=_e(),[g,te]=r.useState([]),[ae,M]=r.useState(!0),[le,O]=r.useState(!1),[re,ie]=r.useState(0),[ce,ne]=r.useState(0),[de,xe]=r.useState(0),[w,x]=r.useState(null),[Q,G]=r.useState(!1),[V,c]=r.useState(""),[W,p]=r.useState(""),[D,oe]=r.useState(!1),[X,P]=r.useState(!1),[z,me]=r.useState([]),[F,he]=r.useState(null),[je,y]=r.useState(!1),[ge,Y]=r.useState(!1),[qe,Le]=r.useState([]),[ue,Z]=r.useState([]),[I,H]=r.useState([]),[h,f]=r.useState({name:"",description:"",website:"",phone:"",status:"approved"}),_=async()=>{try{const{data:s,error:t}=await o.from("dog_parks").select("*").eq("owner_id",d?.id).order("created_at",{ascending:!1});if(t)throw t;te(s||[]),ie(25600),ne(32),xe(128)}catch{c("ドッグランの取得に失敗しました")}},S=async()=>{try{const{data:s,error:t}=await o.from("pet_facilities").select("*").eq("owner_id",d?.id).order("created_at",{ascending:!1});if(t)throw t;me(s||[])}catch{c("ペット施設の取得に失敗しました")}},pe=async()=>{O(!0);try{await Promise.all([_(),S()])}catch{c("データの更新に失敗しました")}finally{O(!1)}},fe=s=>{he(s),f({name:s.name,description:s.description||"",website:s.website||"",phone:s.phone||"",status:s.status}),y(!0)},be=async(s,t)=>{try{const{error:i}=await o.from("pet_facilities").update({status:t?"approved":"suspended",updated_at:new Date().toISOString()}).eq("id",s).eq("owner_id",d?.id);if(i)throw i;await S(),p("公開設定を更新しました"),setTimeout(()=>p(""),3e3)}catch(i){console.error("Error toggling facility status:",i),c("公開設定の更新に失敗しました"),setTimeout(()=>c(""),3e3)}},Ne=async s=>{if(s.preventDefault(),!!F)try{Y(!0),c("");const{error:t}=await o.from("pet_facilities").update({name:h.name,description:h.description,website:h.website,phone:h.phone,updated_at:new Date().toISOString()}).eq("id",F.id).eq("owner_id",d?.id);if(t)throw t;await S(),y(!1),p("施設情報を更新しました"),setTimeout(()=>p(""),3e3)}catch(t){console.error("Error updating facility:",t),c("施設情報の更新に失敗しました"),setTimeout(()=>c(""),3e3)}finally{Y(!1)}},ve=s=>{switch(s){case"pending":return{icon:v,label:"第一審査中",description:"申請内容を審査中です。しばらくお待ちください。",color:"bg-yellow-100 text-yellow-800"};case"first_stage_passed":return{icon:N,label:"第一審査通過（旧）",description:"第一審査を通過しました。（旧システム）",color:"bg-blue-100 text-blue-800"};case"second_stage_waiting":return{icon:u,label:"二次審査申し込み",description:"第一審査通過！スマートロックを購入し、第二審査を提出してください。",color:"bg-orange-100 text-orange-800",showSmartLockPurchase:!0};case"second_stage_review":return{icon:C,label:"第二審査中",description:"第二審査を実施中です。審査結果をお待ちください。",color:"bg-purple-100 text-purple-800"};case"smart_lock_testing":return{icon:k,label:"スマートロック認証待ち",description:"スマートロックの動作確認を行ってください。",color:"bg-indigo-100 text-indigo-800"};case"approved":return{icon:N,label:"承認済み・公開可能",description:"ドッグランの運営を開始できます！",color:"bg-green-100 text-green-800"};case"rejected":return{icon:u,label:"却下",description:"申請が却下されました。詳細をご確認ください。",color:"bg-red-100 text-red-800"};default:return{icon:v,label:"不明",description:"ステータスが不明です。",color:"bg-gray-100 text-gray-800"}}},we=async s=>{try{G(!0),c("");const{data:t}=await o.from("dog_park_facility_images").select("id").eq("park_id",s);if(t&&t.length>0){const{error:b}=await o.from("dog_park_facility_images").delete().eq("park_id",s);if(b)throw new Error("施設画像の削除に失敗しました。")}const{data:i}=await o.from("dog_park_review_stages").select("id").eq("park_id",s);if(i&&i.length>0){const{error:b}=await o.from("dog_park_review_stages").delete().eq("park_id",s);if(b)throw new Error("審査ステージの削除に失敗しました。")}const{error:a}=await o.from("dog_parks").delete().eq("id",s).eq("owner_id",d?.id);if(a)throw a;await _(),x(null),P(!1);const L=g.find(b=>b.id===s)?.name||"ドッグラン";p(`${L}の申請を完全に削除しました。再度ご利用の際は新規申請が必要です。`),setTimeout(()=>{p("")},5e3)}catch(t){c(t.message||"エラーが発生しました"),setTimeout(()=>{c("")},3e3)}finally{G(!1)}};if(r.useEffect(()=>{if(!d){B("/login");return}(async()=>{try{M(!0),c(""),await _(),await S()}catch(i){console.error("Error loading data:",i),c("データの取得に失敗しました。ページを再読み込みしてください。")}finally{M(!1)}})();const t=o.channel("dog_parks_changes").on("postgres_changes",{event:"*",schema:"public",table:"dog_parks",filter:`owner_id=eq.${d.id}`},i=>{console.log("Dog parks changed:",i),_()}).subscribe();return()=>{t.unsubscribe()}},[d,B]),ae)return e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(!d){c("ユーザー情報が取得できません");return}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"オーナーダッシュボード"}),e.jsx("p",{className:"text-gray-600",children:"ドッグランの登録・管理を行います"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(l,{variant:"secondary",onClick:pe,isLoading:le,className:"flex items-center",children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"更新"]}),e.jsx(n,{to:"/owner-payment-system",children:e.jsxs(l,{variant:"secondary",className:"flex items-center",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"収益システム"]})}),e.jsx(n,{to:"/register-park",children:e.jsxs(l,{children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"ドッグランを登録"]})})]})]}),V&&e.jsxs("div",{className:"bg-red-100 border border-red-300 text-red-800 rounded-lg p-4 flex items-start",children:[e.jsx(u,{className:"w-5 h-5 text-red-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsx("p",{children:V})]}),W&&e.jsxs("div",{className:"bg-green-100 border border-green-300 text-green-800 rounded-lg p-4 flex items-start",children:[e.jsx(N,{className:"w-5 h-5 text-green-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsx("p",{children:W})]}),e.jsxs("div",{className:"bg-gray-100 border border-gray-300 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"デバッグ情報"}),e.jsx(l,{variant:"secondary",size:"sm",onClick:()=>oe(!D),children:D?"隠す":"表示"})]}),D&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"ユーザーID:"})," ",d?.id]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"パーク数:"})," ",g.length]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"最終更新:"})," ",new Date().toLocaleString()]}),g.map(s=>e.jsxs("div",{className:"bg-white p-3 rounded border text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"名前:"})," ",s.name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ID:"})," ",s.id]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ステータス:"})," ",s.status]}),e.jsxs("div",{children:[e.jsx("strong",{children:"作成日:"})," ",new Date(s.created_at).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("strong",{children:"更新日:"})," ",s.updated_at?new Date(s.updated_at).toLocaleString():"なし"]})]},s.id))]})]}),g.some(s=>s.status==="approved")&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(m,{className:"p-6 hover:shadow-lg transition-shadow cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"今月の収益"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["¥",re.toLocaleString()]}),e.jsx("p",{className:"text-xs text-green-600",children:"前月比 +8%"})]}),e.jsx(E,{className:"w-8 h-8 text-green-600"})]}),e.jsx("div",{className:"mt-3 text-blue-600 text-sm flex items-center",children:e.jsxs(n,{to:"/owner-payment-system",className:"flex items-center",children:[e.jsx("span",{children:"詳細を見る"}),e.jsx($,{className:"w-4 h-4 ml-1"})]})})]}),e.jsxs(m,{className:"p-6 hover:shadow-lg transition-shadow cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"今月の予約"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[ce,"件"]}),e.jsx("p",{className:"text-xs text-blue-600",children:"前月比 +12%"})]}),e.jsx(Ie,{className:"w-8 h-8 text-blue-600"})]}),e.jsxs("div",{className:"mt-3 text-blue-600 text-sm flex items-center",children:[e.jsx("span",{children:"詳細を見る"}),e.jsx($,{className:"w-4 h-4 ml-1"})]})]}),e.jsxs(m,{className:"p-6 hover:shadow-lg transition-shadow cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"利用者数"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[de,"人"]}),e.jsx("p",{className:"text-xs text-purple-600",children:"前月比 +15%"})]}),e.jsx(J,{className:"w-8 h-8 text-purple-600"})]}),e.jsxs("div",{className:"mt-3 text-blue-600 text-sm flex items-center",children:[e.jsx("span",{children:"詳細を見る"}),e.jsx($,{className:"w-4 h-4 ml-1"})]})]})]}),e.jsx(m,{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"bg-white/20 p-3 rounded-full",children:e.jsx(Ce,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-1",children:"収益システム"}),e.jsx("p",{className:"text-sm opacity-90",children:"売上の80%がオーナー様に支払われます"})]})]}),e.jsx(n,{to:"/owner-payment-system",children:e.jsxs(l,{className:"bg-white text-gray-900 hover:bg-gray-100 hover:text-gray-900 font-bold",children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"詳細を見る"]})})]})}),e.jsx(m,{className:"bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(C,{className:"w-6 h-6 text-blue-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"審査プロセス"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm text-blue-800",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-bold",children:"1"}),e.jsx("span",{children:"第一審査（基本条件確認）"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-bold",children:"2"}),e.jsx("span",{children:"第二審査（書類審査）"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-bold",children:"3"}),e.jsx("span",{children:"QRコード実証検査"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-bold",children:"4"}),e.jsx("span",{children:"掲載・運営開始"})]})]})]})]})}),g.length===0?e.jsxs(m,{className:"text-center py-12",children:[e.jsx(U,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"まだドッグランが登録されていません"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"新しいドッグランを登録して、多くの愛犬家に利用してもらいましょう"}),e.jsx(n,{to:"/register-park",children:e.jsxs(l,{children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"ドッグランを登録する"]})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:g.map(s=>{const t=ve(s.status),i=t.icon;return e.jsxs(m,{className:"hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"flex justify-between items-start mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:s.name}),e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex items-center space-x-1 ${t.color}`,children:[e.jsx(i,{className:"w-4 h-4"}),e.jsx("span",{children:t.label})]})}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:t.description})]})}),e.jsx("p",{className:"text-gray-600 mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-sm",children:s.address})]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"24時間営業"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:["収容人数: ",s.max_capacity,"人"]}),e.jsxs("div",{children:["現在の利用者: ",s.current_occupancy,"人"]})]})]}),s.status==="approved"&&e.jsx("div",{className:"bg-green-50 p-3 rounded-lg mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{className:"w-4 h-4 text-yellow-500"}),e.jsxs("span",{children:["評価: ★",s.average_rating.toFixed(1)]})]}),e.jsx("div",{children:e.jsxs("span",{children:["レビュー: ",s.review_count,"件"]})}),e.jsx("div",{children:e.jsxs("span",{children:["現在の利用者: ",s.current_occupancy,"人"]})}),e.jsx("div",{children:e.jsxs("span",{children:["利用率: ",Math.round(s.current_occupancy/s.max_capacity*100),"%"]})})]})}),s.status==="pending"&&e.jsx("div",{className:"bg-yellow-50 p-3 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(u,{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"第一審査待ち"}),e.jsx("p",{children:"管理者による審査をお待ちください。通常3-5営業日で結果をお知らせします。"})]})]})}),s.status==="second_stage_waiting"&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 p-4 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(k,{className:"w-6 h-6 text-orange-600 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"text-sm text-orange-800",children:[e.jsx("p",{className:"font-bold mb-2 text-base",children:"🎉 第一審査通過おめでとうございます！"}),e.jsx("p",{className:"mb-3",children:"二次審査の申し込みが可能になりました。"}),e.jsx("div",{className:"mb-4 text-center",children:e.jsx(n,{to:`/parks/${s.id}/second-stage`,children:e.jsxs(l,{className:"bg-orange-600 hover:bg-orange-700 text-white px-6 py-2 rounded-lg font-medium",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"二次審査申し込み"]})})}),e.jsxs("div",{className:"mb-4 p-3 bg-white rounded-lg border border-orange-200",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-orange-700 mb-2",children:[e.jsx("span",{children:"進捗状況"}),e.jsx("span",{children:"1/3ステップ完了"})]}),e.jsx("div",{className:"w-full bg-orange-200 rounded-full h-2",children:e.jsx("div",{className:"bg-orange-600 h-2 rounded-full",style:{width:"33%"}})})]}),e.jsx("p",{className:"mb-3",children:"次のステップに進むため、以下の手順を完了してください："}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-start space-x-3 p-2 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"w-6 h-6 bg-green-600 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:"✓"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-semibold text-green-800",children:"第一審査通過"}),e.jsx("p",{className:"text-xs text-green-700 mt-1",children:"基本情報の審査が完了しました"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-2 bg-orange-50 rounded-lg border-2 border-orange-300",children:[e.jsx("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:"2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-semibold text-orange-800",children:"スマートロックの購入・設置"}),e.jsx("p",{className:"text-xs text-orange-700 mt-1",children:"ペットショップでスマートロックを購入し、設置してください"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-2 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-400 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:"3"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"第二審査（設備画像）の提出"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"設置完了後、設備画像をアップロードしてください"})]})]})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(n,{to:"/pet-shop",className:"flex-1",children:e.jsxs(l,{className:"w-full bg-orange-600 hover:bg-orange-700",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"ペットショップでスマートロック購入"]})})})]})})]})}),s.status==="first_stage_passed"&&e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(N,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"第一審査通過！（旧システム）"}),e.jsx("p",{children:"第二審査の詳細情報を入力してください。"})]})]})}),s.status==="second_stage_review"&&e.jsx("div",{className:"bg-purple-50 p-3 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(v,{className:"w-5 h-5 text-purple-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-purple-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"第二審査中"}),e.jsx("p",{children:"提出いただいた設備画像を審査中です。結果をお待ちください。"})]})]})}),s.status==="smart_lock_testing"&&e.jsx("div",{className:"bg-indigo-50 p-3 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(k,{className:"w-5 h-5 text-indigo-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-indigo-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"スマートロック動作確認"}),e.jsx("p",{children:"スマートロックの動作確認を行い、正常に作動することを確認してください。"})]})]})}),e.jsxs("div",{className:"flex space-x-2",children:[s.status==="qr_testing_ready"&&e.jsxs("div",{className:"flex justify-between w-full space-x-2",children:[e.jsx(n,{to:`/parks/${s.id}/publish-setup`,className:"flex-1",children:e.jsxs(l,{size:"sm",className:"w-full bg-green-600 hover:bg-green-700",children:[e.jsx(k,{className:"w-4 h-4 mr-1"}),"公開準備を開始"]})}),e.jsx(l,{size:"sm",variant:"secondary",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:a=>{a.preventDefault(),a.stopPropagation(),x(s.id)},children:e.jsx(j,{className:"w-4 h-4"})})]}),s.status==="editing"&&e.jsxs("div",{className:"flex justify-between w-full space-x-2",children:[e.jsx(n,{to:`/parks/${s.id}/publish-setup`,className:"flex-1",children:e.jsxs(l,{size:"sm",className:"w-full bg-yellow-600 hover:bg-yellow-700",children:[e.jsx(K,{className:"w-4 h-4 mr-1"}),"編集を続ける"]})}),e.jsx(l,{size:"sm",variant:"secondary",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:a=>{a.preventDefault(),a.stopPropagation(),x(s.id)},children:e.jsx(j,{className:"w-4 h-4"})})]}),s.status==="ready_to_publish"&&e.jsxs("div",{className:"flex justify-between w-full space-x-2",children:[e.jsx(n,{to:`/parks/${s.id}/publish-setup`,className:"flex-1",children:e.jsxs(l,{size:"sm",className:"w-full bg-green-600 hover:bg-green-700",children:[e.jsx(A,{className:"w-4 h-4 mr-1"}),"公開する"]})}),e.jsx(l,{size:"sm",variant:"secondary",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:a=>{a.preventDefault(),a.stopPropagation(),x(s.id)},children:e.jsx(j,{className:"w-4 h-4"})})]}),s.status==="approved"&&e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx(n,{to:`/parks/${s.id}`,children:e.jsxs(l,{size:"sm",variant:"secondary",children:[e.jsx(A,{className:"w-4 h-4 mr-1"}),"公開ページを見る"]})}),e.jsx(n,{to:`/parks/${s.id}/manage`,children:e.jsx(l,{size:"sm",children:"管理する"})})]}),s.status==="first_stage_passed"&&e.jsxs("div",{className:"flex justify-between w-full space-x-2",children:[e.jsx(n,{to:`/parks/${s.id}/second-stage`,className:"flex-1",children:e.jsxs(l,{size:"sm",className:"w-full bg-blue-600 hover:bg-blue-700",children:[e.jsx(Pe,{className:"w-4 h-4 mr-1"}),"画像アップロード"]})}),e.jsx(l,{size:"sm",variant:"secondary",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:a=>{a.preventDefault(),a.stopPropagation(),x(s.id)},children:e.jsx(j,{className:"w-4 h-4"})})]}),s.status==="second_stage_waiting"&&e.jsx("div",{className:"flex justify-end w-full",children:e.jsx(l,{size:"sm",variant:"secondary",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:a=>{a.preventDefault(),a.stopPropagation(),x(s.id)},children:e.jsx(j,{className:"w-4 h-4"})})}),s.status==="pending"&&e.jsxs("div",{className:"flex justify-between w-full space-x-2",children:[e.jsx("div",{className:"flex-1 text-center py-2 text-gray-600 text-sm",children:"第一審査待ち"}),e.jsx(l,{size:"sm",variant:"secondary",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:a=>{a.preventDefault(),a.stopPropagation(),x(s.id)},children:e.jsx(j,{className:"w-4 h-4"})})]}),s.status==="second_stage_review"&&e.jsxs("div",{className:"flex justify-between w-full space-x-2",children:[e.jsx("div",{className:"flex-1 text-center py-2 text-gray-600 text-sm",children:"第二審査中"}),e.jsx(l,{size:"sm",variant:"secondary",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:a=>{a.preventDefault(),a.stopPropagation(),x(s.id)},children:e.jsx(j,{className:"w-4 h-4"})})]}),s.status==="rejected"&&e.jsxs("div",{className:"flex justify-between w-full space-x-2",children:[e.jsx("div",{className:"flex-1 text-center py-2 text-red-600 text-sm",children:"申請却下"}),e.jsx(l,{size:"sm",variant:"secondary",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:a=>{a.preventDefault(),a.stopPropagation(),x(s.id)},children:e.jsx(j,{className:"w-4 h-4"})})]})]})]},s.id)})}),e.jsxs(m,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:[e.jsx(ee,{className:"w-6 h-6 text-blue-600 mr-2"}),"管理中のその他施設 (",z.length,"施設)"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"ペットショップ、動物病院、トリミングサロンなどの施設管理"})]}),z.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ee,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"まだその他施設が登録されていません"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"ペット関連施設を登録して、より多くのお客様に知ってもらいましょう"}),e.jsx(n,{to:"/facility-registration",children:e.jsxs(l,{children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"ペット関連施設を登録する"]})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:z.map(s=>e.jsxs(m,{className:"hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"flex justify-between items-start mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex items-center space-x-1 ${s.status==="approved"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[s.status==="approved"&&e.jsx(N,{className:"w-4 h-4"}),s.status==="pending"&&e.jsx(v,{className:"w-4 h-4"}),s.status==="rejected"&&e.jsx(u,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.status==="approved"&&"公開中",s.status==="pending"&&"審査中",s.status==="rejected"&&"却下",s.status==="suspended"&&"停止中"]})]}),s.status==="approved"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"公開設定:"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.status==="approved",onChange:t=>be(s.id,t.target.checked),className:"sr-only"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-checked:bg-green-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all"})]})]})]})]})}),s.description&&e.jsx("p",{className:"text-gray-600 mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-sm",children:s.address})]}),s.phone&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-sm",children:s.phone})]}),s.website&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(ze,{className:"w-4 h-4 mr-2"}),e.jsx("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800",children:"公式サイト"})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(l,{size:"sm",variant:"secondary",onClick:()=>fe(s),className:"flex items-center",children:[e.jsx(K,{className:"w-4 h-4 mr-1"}),"修正"]}),s.status==="approved"&&e.jsxs(l,{size:"sm",variant:"secondary",onClick:()=>window.open(`/facility/${s.id}`,"_blank"),className:"flex items-center",children:[e.jsx(A,{className:"w-4 h-4 mr-1"}),"公開ページ"]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:s.category_name||"その他施設"})]})]},s.id))})]}),e.jsx(m,{className:"bg-gray-50",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(C,{className:"w-6 h-6 text-gray-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"運営サポート"}),e.jsxs("div",{className:"text-sm text-gray-700 space-y-1",children:[e.jsx("p",{children:"• 審査に関するご質問は運営事務局までお問い合わせください"}),e.jsx("p",{children:"• QRコードシステムの設置・設定サポートを提供しています"}),e.jsx("p",{children:"• 運営開始後も継続的なサポートを行います"}),e.jsx("p",{children:"• 📧 サポート窓口: info@dogparkjp.com"})]})]})]})}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(u,{className:"w-10 h-10 text-red-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"ドッグラン申請を削除"}),e.jsx("p",{className:"text-sm text-gray-500",children:g.find(s=>s.id===w)?.name})]})]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(u,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-red-800",children:[e.jsx("p",{className:"font-semibold mb-2",children:"⚠️ 重要な警告"}),e.jsxs("ul",{className:"space-y-1 list-disc list-inside",children:[e.jsx("li",{children:e.jsx("strong",{children:"この操作は取り消せません"})}),e.jsx("li",{children:"すべての申請データが完全に削除されます"}),e.jsx("li",{children:"再度利用したい場合は最初から申請手続きが必要です"}),e.jsx("li",{children:"審査進捗やアップロードした画像もすべて失われます"}),e.jsx("li",{children:"削除後は同じ施設名での即座の再申請はできません"})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"削除される内容："}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[e.jsx("li",{children:"• ドッグランの基本情報"}),e.jsx("li",{children:"• アップロード済みの施設画像"}),e.jsx("li",{children:"• 審査進捗状況"}),e.jsx("li",{children:"• 銀行口座情報"}),e.jsx("li",{children:"• 管理者からのフィードバック"})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:X,className:"mt-1 rounded border-gray-300 text-red-600 focus:ring-red-500",onChange:s=>{P(s.target.checked)}}),e.jsxs("span",{className:"text-sm text-gray-700",children:["上記の内容を理解し、",e.jsx("strong",{children:"申請を完全に削除することに同意します"})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(l,{variant:"secondary",onClick:()=>{x(null),P(!1)},disabled:Q,children:"キャンセル"}),e.jsxs(l,{id:"confirm-delete-button",className:"bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",isLoading:Q,disabled:!X,onClick:()=>{w&&we(w)},children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"完全に削除する"]})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"💡 ヒント："})," 一時的に申請を中断したい場合は、削除せずに運営事務局にご相談ください。"]})})]})}),je&&F&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"施設情報の修正"}),e.jsx("button",{onClick:()=>y(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(se,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:Ne,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"施設名 *"}),e.jsx(R,{type:"text",value:h.name,onChange:s=>f(t=>({...t,name:s.target.value})),required:!0,className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"施設の説明・コメント"}),e.jsx("textarea",{value:h.description,onChange:s=>f(t=>({...t,description:s.target.value})),rows:4,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"施設の特徴やサービス内容を詳しく記載してください"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"電話番号"}),e.jsx(R,{type:"tel",value:h.phone,onChange:s=>f(t=>({...t,phone:s.target.value})),className:"w-full",placeholder:"03-1234-5678"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ウェブサイトURL"}),e.jsx(R,{type:"url",value:h.website,onChange:s=>f(t=>({...t,website:s.target.value})),className:"w-full",placeholder:"https://example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"施設画像の追加・変更"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:s=>{const t=Array.from(s.target.files||[]);Z(t);const i=[];t.forEach(a=>{const q=new FileReader;q.onload=L=>{i.push(L.target?.result),i.length===t.length&&H(i)},q.readAsDataURL(a)})},className:"hidden",id:"facility-images"}),e.jsxs("label",{htmlFor:"facility-images",className:"cursor-pointer bg-gray-50 hover:bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:[e.jsx(Fe,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"画像を選択またはドラッグ&ドロップ"})]})]}),I.length>0&&e.jsx("div",{className:"mt-4 grid grid-cols-3 gap-4",children:I.map((s,t)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s,alt:`Preview ${t}`,className:"w-full h-24 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{const i=[...I];i.splice(t,1),H(i);const a=[...ue];a.splice(t,1),Z(a)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:e.jsx(se,{className:"w-3 h-3"})})]},t))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200",children:[e.jsx(l,{type:"button",variant:"secondary",onClick:()=>y(!1),children:"キャンセル"}),e.jsx(l,{type:"submit",isLoading:ge,disabled:!h.name.trim(),children:"保存"})]})]})]})})]})}function Ie({className:d}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:d,children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})}export{Ae as OwnerDashboard};
