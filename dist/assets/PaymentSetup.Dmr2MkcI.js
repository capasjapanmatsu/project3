var e=Object.defineProperty,s=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,c=(s,r,a)=>r in s?e(s,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[r]=a,i=(e,s)=>{for(var r in s||(s={}))l.call(s,r)&&c(e,r,s[r]);if(a)for(var r of a(s))t.call(s,r)&&c(e,r,s[r]);return e},n=(e,a)=>s(e,r(a));import{u as d,j as x,C as m,B as o,s as h}from"./index.CQlxbczY.js";import{r as p}from"./vendor.CKEClKZl.js";import{I as j}from"./Input.DMWrIIWM.js";import{u}from"./router.B_7Atevv.js";import{g,z as b,G as N,A as f,a as v,q as y}from"./ui.C72fRZ1L.js";import"./supabase.X3H3st79.js";function w(){const{user:e}=d(),s=u(),[r,a]=p.useState(!1),[l,t]=p.useState(""),[c,w]=p.useState(!1),[S,k]=p.useState({cardNumber:"",cardHolder:"",expiryMonth:"",expiryYear:"",cvv:"",isDefault:!0});return c?x.jsx("div",{className:"max-w-md mx-auto",children:x.jsxs(m,{className:"text-center p-8",children:[x.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:x.jsx(g,{className:"w-8 h-8 text-green-600"})}),x.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã‚’ç™»éŒ²ã—ã¾ã—ãŸ"}),x.jsx("p",{className:"text-gray-600 mb-4",children:"å…¥å ´QRãƒšãƒ¼ã‚¸ã«æˆ»ã‚Šã¾ã™..."}),x.jsx(o,{onClick:()=>s("/entrance-qr"),children:"å…¥å ´QRãƒšãƒ¼ã‚¸ã¸"})]})}):x.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[x.jsx("div",{className:"flex items-center space-x-4 mb-6",children:x.jsxs("button",{onClick:()=>s("/entrance-qr"),className:"flex items-center text-gray-600 hover:text-gray-800 transition-colors",children:[x.jsx(b,{className:"w-4 h-4 mr-2"}),"å…¥å ´QRã«æˆ»ã‚‹"]})}),x.jsxs("div",{className:"text-center mb-8",children:[x.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center justify-center",children:[x.jsx(N,{className:"w-8 h-8 text-blue-600 mr-3"}),"ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ç™»éŒ²"]}),x.jsx("p",{className:"text-gray-600",children:"ãƒ‰ãƒƒã‚°ãƒ©ãƒ³å…¥å ´QRã®ç™ºè¡Œã«ã¯ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã®ç™»éŒ²ãŒå¿…è¦ã§ã™"})]}),x.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[x.jsx("div",{className:"lg:col-span-2",children:x.jsx(m,{className:"p-6",children:x.jsxs("form",{onSubmit:r=>{return l=this,c=null,i=function*(){if(r.preventDefault(),t(""),(()=>{if(16!==S.cardNumber.replace(/\s/g,"").length)return t("ã‚«ãƒ¼ãƒ‰ç•ªå·ã¯16æ¡ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"),!1;if(!S.cardHolder.trim())return t("ã‚«ãƒ¼ãƒ‰åç¾©äººã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"),!1;if(!S.expiryMonth||!S.expiryYear)return t("æœ‰åŠ¹æœŸé™ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚"),!1;if(S.cvv.length<3)return t("CVVã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"),!1;const e=new Date,s=e.getFullYear()%100,r=e.getMonth()+1,a=parseInt(S.expiryYear),l=parseInt(S.expiryMonth);return!(a<s||a===s&&l<r)||(t("æœ‰åŠ¹æœŸé™ãŒéå»ã®æ—¥ä»˜ã§ã™ã€‚"),!1)})()){a(!0);try{const r=S.cardNumber.replace(/\s/g,""),a="**** **** **** "+r.slice(-4),l=(e=>{const s=e.replace(/\s/g,"");return s.startsWith("4")?"visa":s.startsWith("5")||s.startsWith("2")?"mastercard":s.startsWith("3")?"amex":s.startsWith("35")?"jcb":"visa"})(r),{error:t}=yield h.from("payment_cards").insert([{user_id:null==e?void 0:e.id,card_number_masked:a,card_holder_name:S.cardHolder,expiry_month:parseInt(S.expiryMonth),expiry_year:parseInt(S.expiryYear),card_brand:l,is_default:S.isDefault}]);if(t)throw t;w(!0),setTimeout(()=>{s("/entrance-qr")},3e3)}catch(l){t(l.message||"æ±ºæ¸ˆæ–¹æ³•ã®è¨­å®šã«å¤±æ•—ã—ã¾ã—ãŸ")}finally{a(!1)}}},new Promise((e,s)=>{var a=e=>{try{n(i.next(e))}catch(r){s(r)}},t=e=>{try{n(i.throw(e))}catch(r){s(r)}},n=s=>s.done?e(s.value):Promise.resolve(s.value).then(a,t);n((i=i.apply(l,c)).next())});var l,c,i},children:[l&&x.jsxs("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg",children:[x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsx(f,{className:"w-5 h-5 text-red-600"}),x.jsx("span",{className:"text-red-800 font-medium",children:"ã‚¨ãƒ©ãƒ¼"})]}),x.jsx("p",{className:"text-red-700 mt-1",children:l})]}),x.jsxs("div",{className:"space-y-4",children:[x.jsx(j,{label:"ã‚«ãƒ¼ãƒ‰ç•ªå· *",value:S.cardNumber,onChange:e=>{const s=e.target.value.replace(/\D/g,"").replace(/(.{4})/g,"$1 ").trim().slice(0,19);k(n(i({},S),{cardNumber:s}))},placeholder:"1234 5678 9012 3456",maxLength:19,required:!0}),x.jsx(j,{label:"ã‚«ãƒ¼ãƒ‰åç¾©äºº *",value:S.cardHolder,onChange:e=>k(n(i({},S),{cardHolder:e.target.value.toUpperCase()})),placeholder:"TARO YAMADA",required:!0}),x.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"æœ‰åŠ¹æœŸé™ï¼ˆæœˆï¼‰ *"}),x.jsxs("select",{value:S.expiryMonth,onChange:e=>k(n(i({},S),{expiryMonth:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[x.jsx("option",{value:"",children:"æœˆ"}),Array.from({length:12},(e,s)=>x.jsx("option",{value:String(s+1).padStart(2,"0"),children:String(s+1).padStart(2,"0")},s+1))]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"æœ‰åŠ¹æœŸé™ï¼ˆå¹´ï¼‰ *"}),x.jsxs("select",{value:S.expiryYear,onChange:e=>k(n(i({},S),{expiryYear:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[x.jsx("option",{value:"",children:"å¹´"}),Array.from({length:10},(e,s)=>{const r=(new Date).getFullYear()+s;return x.jsx("option",{value:String(r).slice(-2),children:r},r)})]})]}),x.jsx(j,{label:"CVV *",value:S.cvv,onChange:e=>k(n(i({},S),{cvv:e.target.value.replace(/\D/g,"")})),placeholder:"123",maxLength:4,required:!0})]}),x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsx("input",{type:"checkbox",id:"isDefault",checked:S.isDefault,onChange:e=>k(n(i({},S),{isDefault:e.target.checked})),className:"rounded text-blue-600"}),x.jsx("label",{htmlFor:"isDefault",className:"text-sm text-gray-700",children:"ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æ”¯æ‰•ã„æ–¹æ³•ã¨ã—ã¦è¨­å®š"})]}),x.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg",children:x.jsxs("div",{className:"flex items-start space-x-2",children:[x.jsx(f,{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0"}),x.jsxs("div",{className:"text-sm text-yellow-800",children:[x.jsx("p",{className:"font-medium mb-1",children:"é‡è¦ãªæ³¨æ„äº‹é …"}),x.jsxs("ul",{className:"space-y-1 text-xs",children:[x.jsx("li",{children:"â€¢ ã‚«ãƒ¼ãƒ‰æƒ…å ±ã¯æš—å·åŒ–ã—ã¦å®‰å…¨ã«ä¿å­˜ã•ã‚Œã¾ã™"}),x.jsx("li",{children:"â€¢ å®Ÿéš›ã®ã‚«ãƒ¼ãƒ‰ç•ªå·ã¯ä¿å­˜ã•ã‚Œã¾ã›ã‚“"}),x.jsx("li",{children:"â€¢ å…¥å ´QRç™ºè¡Œæ™‚ã«è‡ªå‹•ã§èª²é‡‘ã•ã‚Œã¾ã™"}),x.jsx("li",{children:"â€¢ ä¸æ­£åˆ©ç”¨é˜²æ­¢ã®ãŸã‚ã€æœ¬äººç¢ºèªãŒå¿…è¦ãªå ´åˆãŒã‚ã‚Šã¾ã™"})]})]})]})}),x.jsxs(o,{type:"submit",isLoading:r,className:"w-full bg-blue-600 hover:bg-blue-700 text-lg py-3",children:[x.jsx(N,{className:"w-5 h-5 mr-2"}),"ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã‚’ç™»éŒ²"]})]})]})})}),x.jsxs("div",{className:"space-y-6",children:[x.jsxs(m,{className:"p-4 bg-green-50 border-green-200",children:[x.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[x.jsx(v,{className:"w-5 h-5 text-green-600"}),x.jsx("h3",{className:"font-semibold text-green-900",children:"ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£"})]}),x.jsxs("div",{className:"text-sm text-green-800 space-y-2",children:[x.jsxs("div",{className:"flex items-start space-x-2",children:[x.jsx(g,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),x.jsx("span",{children:"SSLæš—å·åŒ–é€šä¿¡"})]}),x.jsxs("div",{className:"flex items-start space-x-2",children:[x.jsx(g,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),x.jsx("span",{children:"PCI DSSæº–æ‹ "})]}),x.jsxs("div",{className:"flex items-start space-x-2",children:[x.jsx(g,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),x.jsx("span",{children:"ã‚«ãƒ¼ãƒ‰ç•ªå·ã¯ä¿å­˜ã•ã‚Œã¾ã›ã‚“"})]}),x.jsxs("div",{className:"flex items-start space-x-2",children:[x.jsx(g,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),x.jsx("span",{children:"ä¸æ­£åˆ©ç”¨ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ "})]})]})]}),x.jsxs(m,{className:"p-4",children:[x.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"å¯¾å¿œã‚«ãƒ¼ãƒ‰ãƒ–ãƒ©ãƒ³ãƒ‰"}),x.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[x.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded",children:[x.jsx(N,{className:"w-5 h-5 text-blue-600"}),x.jsx("span",{className:"text-sm font-medium",children:"VISA"})]}),x.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded",children:[x.jsx(N,{className:"w-5 h-5 text-red-600"}),x.jsx("span",{className:"text-sm font-medium",children:"Mastercard"})]}),x.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded",children:[x.jsx(N,{className:"w-5 h-5 text-green-600"}),x.jsx("span",{className:"text-sm font-medium",children:"JCB"})]}),x.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded",children:[x.jsx(N,{className:"w-5 h-5 text-blue-800"}),x.jsx("span",{className:"text-sm font-medium",children:"AMEX"})]})]})]}),x.jsxs(m,{className:"p-4 bg-blue-50 border-blue-200",children:[x.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[x.jsx(y,{className:"w-5 h-5 text-blue-600"}),x.jsx("h3",{className:"font-semibold text-blue-900",children:"èª²é‡‘ã«ã¤ã„ã¦"})]}),x.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[x.jsx("p",{children:"â€¢ å…¥å ´QRç™ºè¡Œæ™‚ã«è‡ªå‹•èª²é‡‘"}),x.jsx("p",{children:"â€¢ å˜ç™ºåˆ©ç”¨: Â¥800/æ—¥"}),x.jsx("p",{children:"â€¢ ã‚µãƒ–ã‚¹ã‚¯ä¼šå“¡ã¯è¿½åŠ æ–™é‡‘ãªã—"}),x.jsx("p",{children:"â€¢ åˆ©ç”¨æ˜ç´°ã¯ãƒ¡ãƒ¼ãƒ«ã§é€ä¿¡"}),x.jsx("p",{children:"â€¢ è¿”é‡‘ã¯åˆ©ç”¨å‰ã®ã¿å¯èƒ½"})]})]}),x.jsxs(m,{className:"p-4",children:[x.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"ã‚µãƒãƒ¼ãƒˆ"}),x.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[x.jsx("p",{children:"ã‚«ãƒ¼ãƒ‰ç™»éŒ²ã§ãŠå›°ã‚Šã®å ´åˆã¯ã€ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆã¾ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚"}),x.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded",children:[x.jsx("p",{className:"font-medium",children:"ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆ"}),x.jsx("p",{children:"ğŸ“ 0120-XXX-XXX"}),x.jsx("p",{children:"ğŸ“§ info@dogparkjp.com"}),x.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"å¹³æ—¥ 9:00-18:00"})]})]})]})]})]})]})}export{w as PaymentSetup};
