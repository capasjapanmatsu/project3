import{u as s,j as e,B as a,C as l}from"./index-BFgW40ku.js";import{u as c,i as t,r}from"./vendor-BHVjIt_u.js";import{J as m,t as n,K as i,A as x,a as d}from"./ui-Qz4g1iz4.js";import"./supabase-CKbzEL5D.js";function o(){const o=c(),[u]=t(),{user:j}=s(),[h,N]=r.useState(!0),[b,p]=r.useState("processing"),[f,g]=r.useState(5);r.useEffect((()=>{const s=u.get("status"),e=u.get("session_id");p("success"===s&&e?"success":"cancel"===s?"failed":"processing"),N(!1)}),[u]),r.useEffect((()=>{if("success"===b&&f>0){const s=setTimeout((()=>{g(f-1)}),1e3);return()=>clearTimeout(s)}"success"===b&&0===f&&o("/access-control")}),[b,f,o]);return h?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsxs(a,{variant:"primary",size:"sm",onClick:()=>o(-1),className:"mr-3",children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsx("h1",{className:"text-2xl font-bold",children:"決済確認"})]}),"success"===b&&e.jsxs(l,{className:"text-center p-8",children:[e.jsx(n,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-green-800 mb-4",children:"決済が完了しました！"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"ありがとうございます。決済が正常に処理されました。"}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[e.jsx(i,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-semibold text-blue-900",children:"次のステップ"})]}),e.jsx("p",{className:"text-sm text-blue-800",children:"入場にはPINコードが必要です。下のボタンからPINコードを生成してください。"})]}),e.jsxs(a,{onClick:()=>{o("/access-control")},className:"w-full bg-blue-600 hover:bg-blue-700 mb-4",children:[e.jsx(i,{className:"w-5 h-5 mr-2"}),"PINコードを生成する"]}),e.jsx("p",{className:"text-sm text-gray-500",children:f>0&&`${f}秒後に自動的にPINコード生成画面に移動します...`})]}),"failed"===b&&e.jsxs(l,{className:"text-center p-8",children:[e.jsx(x,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-red-800 mb-4",children:"決済がキャンセルされました"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"決済がキャンセルまたは失敗しました。再度お試しください。"}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[e.jsx(d,{className:"w-5 h-5 text-yellow-600"}),e.jsx("span",{className:"font-semibold text-yellow-900",children:"ドッグランを利用するには"})]}),e.jsx("p",{className:"text-sm text-yellow-800",children:"入場にはPINコードが必要です。決済完了後にPINコードを生成できます。"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(a,{onClick:()=>o("/parks"),className:"w-full",children:"ドッグラン一覧に戻る"}),e.jsx(a,{variant:"secondary",onClick:()=>o("/subscription"),className:"w-full",children:"サブスクリプションを検討する"})]})]}),"processing"===b&&e.jsxs(l,{className:"text-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"決済を処理中..."}),e.jsx("p",{className:"text-gray-600",children:"しばらくお待ちください。決済の処理が完了するまでお時間をいただく場合があります。"})]})]})}export{o as PaymentConfirmation};
