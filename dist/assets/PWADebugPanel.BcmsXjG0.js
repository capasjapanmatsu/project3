var e=(e,s,l)=>new Promise(((n,a)=>{var t=e=>{try{i(l.next(e))}catch(s){a(s)}},r=e=>{try{i(l.throw(e))}catch(s){a(s)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(t,r);i((l=l.apply(e,s)).next())}));import{j as s,l}from"./index.D9xag4tn.js";import{r as n}from"./router.BWT_vQps.js";import{j as a,x as t,f as r,n as i,W as c,w as d,R as o}from"./ui.BPlS2KKq.js";import"./vendor.D1SiiUJb.js";import"./supabase.CZ8ekJUM.js";const x=({isOpen:x,onClose:m})=>{const[h,j]=n.useState(null),[u,g]=n.useState([]),[f,p]=n.useState(navigator.onLine),[v,y]=n.useState({canInstall:!1,isInstalled:window.matchMedia("(display-mode: standalone)").matches,platform:navigator.platform,userAgent:navigator.userAgent.substring(0,50)+"..."});n.useEffect((()=>{if(!x)return;navigator.serviceWorker.getRegistration().then((e=>{j(e||null)})),"caches"in window&&caches.keys().then((e=>{g(e)}));const e=()=>p(!0),s=()=>p(!1);return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}}),[x]);return x?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[s.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[s.jsx(a,{className:"w-5 h-5 mr-2"}),"PWA デバッグパネル"]}),s.jsx("button",{onClick:m,className:"text-gray-500 hover:text-gray-700",children:s.jsx(t,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-4 space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"font-medium mb-3 flex items-center",children:[s.jsx(r,{className:"w-4 h-4 mr-2"}),"システム情報"]}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"PWA モード:"}),s.jsx("span",{className:v.isInstalled?"text-green-600":"text-gray-600",children:v.isInstalled?"インストール済み":"未インストール"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"ネットワーク状態:"}),s.jsxs("span",{className:"flex items-center "+(f?"text-green-600":"text-red-600"),children:[f?s.jsx(i,{className:"w-4 h-4 mr-1"}):s.jsx(c,{className:"w-4 h-4 mr-1"}),f?"オンライン":"オフライン"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"プラットフォーム:"}),s.jsx("span",{className:"text-gray-600",children:v.platform})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"User Agent:"}),s.jsx("span",{className:"text-gray-600 text-xs",children:v.userAgent})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium mb-3",children:"Service Worker"}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"状態:"}),s.jsx("span",{className:h?"text-green-600":"text-red-600",children:h?"登録済み":"未登録"})]}),h&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"スコープ:"}),s.jsx("span",{className:"text-gray-600",children:h.scope})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"アクティブ:"}),s.jsx("span",{className:h.active?"text-green-600":"text-red-600",children:h.active?"はい":"いいえ"})]})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium mb-3",children:"キャッシュ情報"}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-sm",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("span",{className:"font-medium",children:"キャッシュ数: "}),s.jsxs("span",{className:"text-gray-600",children:[u.length,"個"]})]}),u.length>0&&s.jsx("div",{className:"space-y-1",children:u.map(((e,l)=>s.jsx("div",{className:"text-xs text-gray-500 bg-white p-1 rounded",children:e},l)))})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium mb-3",children:"操作"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("button",{onClick:()=>e(null,null,(function*(){if("caches"in window){const e=yield caches.keys();yield Promise.all(e.map((e=>caches.delete(e)))),g([]),l("info","🗑️ 全キャッシュをクリアしました"),alert("全キャッシュをクリアしました")}})),className:"flex items-center justify-center px-3 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",children:[s.jsx(d,{className:"w-4 h-4 mr-2"}),"キャッシュクリア"]}),s.jsxs("button",{onClick:()=>e(null,null,(function*(){h&&(yield h.unregister(),j(null),l("info","🗑️ Service Worker を登録解除しました"),alert("Service Worker を登録解除しました"))})),className:"flex items-center justify-center px-3 py-2 bg-orange-100 text-orange-700 rounded-lg hover:bg-orange-200 transition-colors",disabled:!h,children:[s.jsx(o,{className:"w-4 h-4 mr-2"}),"SW登録解除"]}),s.jsxs("button",{onClick:()=>{window.location.reload()},className:"flex items-center justify-center px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:[s.jsx(o,{className:"w-4 h-4 mr-2"}),"ページ再読み込み"]}),s.jsxs("button",{onClick:()=>{f&&alert("実際のオフラインテストはブラウザのDevToolsを使用してください")},className:"flex items-center justify-center px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[s.jsx(c,{className:"w-4 h-4 mr-2"}),"オフラインテスト"]})]})]}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[s.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"注意事項"}),s.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[s.jsx("li",{children:"• このパネルは開発環境でのみ表示されます"}),s.jsx("li",{children:"• オフラインテストはブラウザのDevToolsで行ってください"}),s.jsx("li",{children:"• キャッシュクリア後はページが再読み込みされる場合があります"}),s.jsx("li",{children:"• Service Worker の変更は再登録が必要です"})]})]})]})]})}):null};export{x as PWADebugPanel,x as default};
