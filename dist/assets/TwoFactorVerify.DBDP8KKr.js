import{j as a}from"./ui-vendor.5lywbznV.js";import{r as e,u as t,b as s,R as r}from"./react-vendor.C7ykWfwV.js";import{B as l,s as c}from"./admin-pages.BuCPNRRu.js";import"./supabase-vendor.CX-WoPCS.js";function n(){const[n,o]=e.useState(""),[d,i]=e.useState(null),[m,u]=e.useState(!1),[f,h]=e.useState(null),[x,p]=e.useState(!1),g=t(),b=s(),j=new URLSearchParams(b.search).get("factorId");r.useEffect(()=>{(async()=>{if(j){u(!0),i(null);try{const{data:a,error:e}=await c.auth.mfa.challenge({factorId:j});if(e)throw e;h(a.id),p(!0)}catch(a){i(a.message||"チャレンジ作成に失敗しました")}finally{u(!1)}}})()},[j]);return a.jsxs("div",{className:"max-w-md mx-auto p-8",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"2ファクタ認証コード入力"}),a.jsx("p",{className:"mb-2",children:"認証アプリで生成された6桁のコードを入力してください。"}),a.jsx("input",{type:"text",value:n,onChange:a=>o(a.target.value),maxLength:6,className:"border px-2 py-1 mb-4 w-full text-center text-lg tracking-widest",placeholder:"123456",autoFocus:!0,disabled:!x}),d&&a.jsx("p",{className:"text-red-600 mb-4",children:d}),a.jsx(l,{onClick:async()=>{if(f&&j){u(!0),i(null);try{const{error:a}=await c.auth.mfa.verify({factorId:j,challengeId:f,code:n});if(a)throw a;g("/dashboard")}catch(a){i(a.message||"認証に失敗しました")}finally{u(!1)}}},disabled:m||6!==n.length||!x,children:"認証する"})]})}export{n as default};
