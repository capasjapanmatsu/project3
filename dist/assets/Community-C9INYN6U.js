import{j as e,l as ee,as as se,b as E,at as te,U as q,A as T,g as ae,a3 as H,B as Y,au as G,av as ue,P as L,X as V,K as ge,aw as je,ax as fe,i as re,a7 as be,Q as Ne,ay as pe}from"./ui-vendor-FlUr4cJt.js";import{u as ye,r as i,L as le}from"./react-vendor-_GyjDmDn.js";import{u as ne,s as d,C as o,B as m,l as p,j as we,c as u}from"./index-BSYT0262.js";import"./supabase-vendor-Df9iqQzW.js";function ie(){const{user:l}=ne(),x=ye(),[h,_]=i.useState([]),[y,z]=i.useState(null),[R,f]=i.useState(!0),[$,g]=i.useState(""),[A,F]=i.useState(""),[k,D]=i.useState(!1);i.useEffect(()=>{S()},[]),i.useEffect(()=>{y&&C()},[y,l]);const S=()=>{if(f(!0),g(""),!navigator.geolocation){g("ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ä½ç½®æƒ…å ±ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“"),f(!1);return}navigator.geolocation.getCurrentPosition(a=>{z({latitude:a.coords.latitude,longitude:a.coords.longitude}),g("")},a=>{switch(console.error("ä½ç½®æƒ…å ±å–å¾—ã‚¨ãƒ©ãƒ¼:",a),a.code){case a.PERMISSION_DENIED:g("ä½ç½®æƒ…å ±ã®åˆ©ç”¨ãŒè¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“");break;case a.POSITION_UNAVAILABLE:g("ä½ç½®æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ");break;case a.TIMEOUT:g("ä½ç½®æƒ…å ±ã®å–å¾—ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ");break;default:g("ä½ç½®æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");break}f(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e5})},C=i.useCallback(async()=>{if(!(!y||!l))try{f(!0),F("");const{data:a,error:b}=await d.from("dogs").select(`
          id,
          name,
          breed,
          gender,
          birth_date,
          image_url,
          owner_id,
          created_at,
          profiles!dogs_owner_id_fkey(name)
        `).neq("owner_id",l.id).limit(50);if(b)throw b;if(!a||a.length===0){_([]);return}const n=a.map(j=>{const v=35.6812+(Math.random()-.5)*.3,J=139.7671+(Math.random()-.5)*.3,W=U(y.latitude,y.longitude,v,J);return{...j,owner_name:j.profiles?.name||"Unknown",distance:W,last_seen_at:new Date(Date.now()-Math.random()*7*24*60*60*1e3).toISOString()}}).sort((j,c)=>j.distance-c.distance).slice(0,20);_(n)}catch(a){console.error("Error fetching nearby dogs:",a),F("è¿‘ãã®ãƒ¯ãƒ³ã¡ã‚ƒã‚“æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ")}finally{f(!1)}},[y,l]),U=(a,b,N,n)=>{const c=(N-a)*Math.PI/180,w=(n-b)*Math.PI/180,P=Math.sin(c/2)*Math.sin(c/2)+Math.cos(a*Math.PI/180)*Math.cos(N*Math.PI/180)*Math.sin(w/2)*Math.sin(w/2);return 6371*(2*Math.atan2(Math.sqrt(P),Math.sqrt(1-P)))},Q=a=>{x(`/dog/${a.id}`)},O=a=>{const b=new Date(a),N=new Date,n=(N.getFullYear()-b.getFullYear())*12+N.getMonth()-b.getMonth();if(n<12)return`${n}ãƒ¶æœˆ`;{const j=Math.floor(n/12),c=n%12;return c>0?`${j}æ­³${c}ãƒ¶æœˆ`:`${j}æ­³`}},B=a=>a==="ã‚ªã‚¹"?"â™‚":"â™€",K=a=>a==="ã‚ªã‚¹"?"ãã‚“":"ã¡ã‚ƒã‚“";return $?e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ee,{className:"w-12 h-12 text-orange-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"ä½ç½®æƒ…å ±ãŒå¿…è¦ã§ã™"}),e.jsx("p",{className:"text-gray-600 mb-4",children:$}),e.jsxs(m,{onClick:S,className:"mb-2",children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"ä½ç½®æƒ…å ±ã‚’å–å¾—"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"è¿‘ãã®ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ä½ç½®æƒ…å ±ã®è¨±å¯ãŒå¿…è¦ã§ã™"})]})}):e.jsxs(o,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"w-6 h-6 text-blue-600 mr-2"}),e.jsx("h2",{className:"text-xl font-bold",children:"è¿‘ãã®ãƒ¯ãƒ³ã¡ã‚ƒã‚“ãŸã¡"})]}),e.jsxs(m,{size:"sm",variant:"secondary",onClick:S,disabled:R,children:[e.jsx(se,{className:"w-4 h-4 mr-1"}),"æ›´æ–°"]})]}),A&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 rounded-lg flex items-start",children:[e.jsx(ee,{className:"w-5 h-5 text-red-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsx("p",{className:"text-red-800 text-sm",children:A})]}),R?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):h.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(E,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"è¿‘ãã«ãƒ¯ãƒ³ã¡ã‚ƒã‚“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"ä½ç½®æƒ…å ±ã‚’æ›´æ–°ã™ã‚‹ã‹ã€æ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„"})]}):e.jsxs("div",{className:"space-y-4",children:[(k?h:h.slice(0,5)).map(a=>e.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>Q(a),children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full overflow-hidden flex-shrink-0",children:a.image_url?e.jsx("img",{src:a.image_url,alt:a.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:"ğŸ•"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsxs("h3",{className:"font-semibold text-lg",children:[a.name,K(a.gender)]}),e.jsx("span",{className:"text-sm text-gray-500",children:B(a.gender)})]}),e.jsx("div",{className:"text-sm text-gray-600 space-y-1",children:e.jsxs("p",{children:[a.breed," â€¢ ",O(a.birth_date)]})})]})]},a.id)),h.length>5&&!k&&e.jsx("div",{className:"text-center pt-4",children:e.jsxs(m,{variant:"secondary",size:"sm",onClick:()=>D(!0),className:"px-6 py-2",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"ã‚‚ã£ã¨è¦‹ã‚‹ï¼ˆæ®‹ã‚Š",h.length-5,"åŒ¹ï¼‰"]})}),k&&h.length>=20&&e.jsx("div",{className:"text-center pt-4",children:e.jsx("p",{className:"text-sm text-gray-500",children:"è¿‘ãã«æ›´ã«å¤šãã®ãƒ¯ãƒ³ã¡ã‚ƒã‚“ãŒã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™"})}),k&&h.length>5&&e.jsx("div",{className:"text-center pt-2",children:e.jsxs(m,{variant:"secondary",size:"sm",onClick:()=>D(!1),className:"px-6 py-2",children:[e.jsx(te,{className:"w-4 h-4 mr-2 rotate-180"}),"æŠ˜ã‚ŠãŸãŸã‚€"]})})]}),e.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(E,{className:"w-5 h-5 text-blue-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"ä½ç½®æƒ…å ±ã«ã¤ã„ã¦"}),e.jsx("p",{children:"ãŠä½¿ã„ã®ä½ç½®æƒ…å ±ã‚’åŸºã«ã€è¿‘ã„é †ã§ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚ ä½ç½®æƒ…å ±ã¯ç«¯æœ«å†…ã§ã®ã¿å‡¦ç†ã•ã‚Œã€ã‚µãƒ¼ãƒãƒ¼ã«ã¯ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚"})]})]})})]})}function Se(){const{user:l}=ne(),[x,h]=i.useState("friends"),[_,y]=i.useState([]),[z,R]=i.useState([]),[f,$]=i.useState([]),[g,A]=i.useState([]),[F,k]=i.useState(!0),[D,S]=i.useState(null),[C,U]=i.useState(""),[Q,O]=i.useState(!1),[B,K]=i.useState([]),[a,b]=i.useState([]),[N,n]=i.useState(""),[j,c]=i.useState(""),[w,P]=i.useState([]);i.useEffect(()=>{if(l){v();const s=d.channel("friend_requests_changes").on("postgres_changes",{event:"*",schema:"public",table:"friend_requests",filter:`requested_id=eq.${l.id}`},()=>{fetchFriendRequests()}).subscribe(),t=d.channel("notifications_changes").on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`user_id=eq.${l.id}`},()=>{fetchNotifications()}).subscribe(),r=d.channel("messages_changes").on("postgres_changes",{event:"*",schema:"public",table:"messages",filter:`receiver_id=eq.${l.id}`},()=>{fetchMessages()}).subscribe();return()=>{s.unsubscribe(),t.unsubscribe(),r.unsubscribe()}}},[l]);const v=async()=>{try{k(!0),p("info","ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ‡ãƒ¼ã‚¿å–å¾—é–‹å§‹");const s=await we({friendRequests:()=>u(()=>d.from("friend_requests").select(`
              *,
              requester:profiles!friend_requests_requester_id_fkey(*)
            `).eq("requested_id",l?.id).eq("status","pending").order("created_at",{ascending:!1})),friends:()=>u(()=>d.rpc("get_friends_with_dogs",{p_user_id:l?.id})),notifications:()=>u(()=>d.from("notifications").select("*").eq("user_id",l?.id).order("created_at",{ascending:!1}).limit(20)),messages:()=>u(()=>d.from("messages").select(`
              *,
              sender:profiles!messages_sender_id_fkey(*),
              receiver:profiles!messages_receiver_id_fkey(*)
            `).or(`sender_id.eq.${l?.id},receiver_id.eq.${l?.id}`).order("created_at",{ascending:!1}).limit(50)),dogEncounters:()=>u(()=>d.from("dog_encounters").select(`
              *,
              encountered_dog:dogs!dog_encounters_encountered_dog_id_fkey(
                *,
                owner:profiles!dogs_owner_id_fkey(*)
              )
            `).eq("user_id",l?.id).order("encounter_date",{ascending:!1}).limit(10)),userDogs:()=>u(()=>d.from("dogs").select("*").eq("owner_id",l?.id)),blacklistedDogs:()=>u(()=>d.from("dog_blacklist").select(`
              *,
              blacklisted_dog:dogs!dog_blacklist_dog_id_fkey(
                *,
                owner:profiles!dogs_owner_id_fkey(*)
              )
            `).eq("user_id",l?.id).order("created_at",{ascending:!1}))});y(s.friendRequests||[]),R(s.friends||[]),$(s.notifications||[]),A(s.messages||[]),K(s.dogEncounters||[]),b(s.userDogs||[]),P(s.blacklistedDogs||[]),p("info","ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ‡ãƒ¼ã‚¿å–å¾—å®Œäº†")}catch(s){p("error","ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼",{error:s})}finally{k(!1)}},J=async(s,t)=>{try{const r=await u(()=>d.from("friend_requests").update({status:t?"accepted":"rejected",responded_at:new Date().toISOString()}).eq("id",s));if(r.error)throw r.error;await v(),c(t?"å‹é”ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ‰¿èªã—ã¾ã—ãŸ":"å‹é”ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ‹’å¦ã—ã¾ã—ãŸ"),setTimeout(()=>c(""),3e3)}catch(r){p("error","Error handling friend request",{error:r,requestId:s,accept:t}),n("ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ"),setTimeout(()=>n(""),3e3)}},W=async s=>{if(s.preventDefault(),!(!D||!C.trim())){O(!0);try{const t=await u(()=>d.from("messages").insert({sender_id:l?.id,receiver_id:D.friend_id,content:C.trim(),read:!1}));if(t.error)throw t.error;await v(),U("")}catch(t){p("error","Error sending message",{error:t,friendId:D?.friend_id}),n("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ"),setTimeout(()=>n(""),3e3)}finally{O(!1)}}},X=async s=>{try{const t=await u(()=>d.from("notifications").update({read:!0}).eq("id",s));if(t.error)throw t.error;$(r=>r.map(I=>I.id===s?{...I,read:!0}:I))}catch(t){p("error","Error marking notification as read",{error:t,notificationId:s})}},ce=s=>{switch(s){case"friend_request":return e.jsx(H,{className:"w-5 h-5 text-blue-600"});case"friend_accepted":return e.jsx(pe,{className:"w-5 h-5 text-green-600"});case"friend_at_park":return e.jsx(q,{className:"w-5 h-5 text-purple-600"});case"reservation_reminder":return e.jsx(re,{className:"w-5 h-5 text-orange-600"});case"blacklisted_dog_nearby":return e.jsx(T,{className:"w-5 h-5 text-red-600"});default:return e.jsx(Y,{className:"w-5 h-5 text-gray-600"})}},de=s=>{switch(s){case"friend_request":return"bg-blue-50";case"friend_accepted":return"bg-green-50";case"friend_at_park":return"bg-purple-50";case"reservation_reminder":return"bg-orange-50";case"blacklisted_dog_nearby":return"bg-red-50";default:return"bg-gray-50"}},oe=async(s,t)=>{try{const r=await u(()=>d.from("friend_requests").insert({requester_id:l?.id,requested_id:s,message:"ãƒ‰ãƒƒã‚°ãƒ©ãƒ³ã§ãŠä¼šã„ã—ãŸéš›ã¯ã€ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ï¼"}));if(r.error)throw r.error;c("å‹é”ç”³è«‹ã‚’é€ä¿¡ã—ã¾ã—ãŸ"),setTimeout(()=>c(""),3e3)}catch(r){p("error","Error sending friend request",{error:r,targetUserId:s,dogName:t}),n("å‹é”ç”³è«‹ã®é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ"),setTimeout(()=>n(""),3e3)}},me=async(s,t)=>{try{const r=await u(()=>d.from("dog_blacklist").insert({user_id:l?.id,dog_id:s,reason:t,notify_when_nearby:!0}));if(r.error)throw r.error;await v(),c("ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸ"),setTimeout(()=>c(""),3e3)}catch(r){p("error","Error adding to blacklist",{error:r,dogId:s,reason:t}),n("ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã¸ã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ"),setTimeout(()=>n(""),3e3)}},xe=async s=>{try{const t=await u(()=>d.from("dog_blacklist").delete().eq("id",s));if(t.error)throw t.error;await v(),c("ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã‹ã‚‰å‰Šé™¤ã—ã¾ã—ãŸ"),setTimeout(()=>c(""),3e3)}catch(t){p("error","Error removing from blacklist",{error:t,blacklistId:s}),n("ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã‹ã‚‰ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ"),setTimeout(()=>n(""),3e3)}},M=s=>s==="ã‚ªã‚¹"?"ãã‚“":"ã¡ã‚ƒã‚“",he=(s,t)=>{if(t&&t.length>0){const r=t[0];return`${r.name}${M(r.gender)}ã®é£¼ã„ä¸»ã•ã‚“`}return"ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®é£¼ã„ä¸»ã•ã‚“"};return F?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("h1",{className:"text-2xl font-bold mb-8 flex items-center",children:[e.jsx(q,{className:"w-8 h-8 text-blue-600 mr-3"}),"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£"]}),N&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start",children:[e.jsx(T,{className:"w-5 h-5 text-red-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsx("p",{className:"text-red-800",children:N})]}),j&&e.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg flex items-start",children:[e.jsx(ae,{className:"w-5 h-5 text-green-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsx("p",{className:"text-green-800",children:j})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"sticky top-0 z-20 bg-white border-b mb-6 overflow-x-auto pb-2",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsxs("button",{className:`px-4 py-2 font-medium relative whitespace-nowrap ${x==="friends"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>h("friends"),children:[e.jsx(q,{className:"w-5 h-5 inline mr-1"}),"å‹é”"]}),e.jsxs("button",{className:`px-4 py-2 font-medium relative whitespace-nowrap ${x==="requests"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>h("requests"),children:[e.jsx(H,{className:"w-5 h-5 inline mr-1"}),"ãƒªã‚¯ã‚¨ã‚¹ãƒˆ",_.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:_.length})]}),e.jsxs("button",{className:`px-4 py-2 font-medium relative whitespace-nowrap ${x==="notifications"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>h("notifications"),children:[e.jsx(Y,{className:"w-5 h-5 inline mr-1"}),"é€šçŸ¥",f.filter(s=>!s.read).length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:f.filter(s=>!s.read).length})]}),e.jsxs("button",{className:`px-4 py-2 font-medium relative whitespace-nowrap ${x==="messages"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>h("messages"),children:[e.jsx(G,{className:"w-5 h-5 inline mr-1"}),"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",g.filter(s=>!s.read&&s.receiver_id===l?.id).length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:g.filter(s=>!s.read&&s.receiver_id===l?.id).length})]}),e.jsxs("button",{className:`px-4 py-2 font-medium relative whitespace-nowrap ${x==="nearby"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>h("nearby"),children:[e.jsx(E,{className:"w-5 h-5 inline mr-1"}),"è¿‘ãã®ãƒ¯ãƒ³ã¡ã‚ƒã‚“"]}),e.jsxs("button",{className:`px-4 py-2 font-medium relative whitespace-nowrap ${x==="blacklist"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>h("blacklist"),children:[e.jsx(T,{className:"w-5 h-5 inline mr-1"}),"ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆ",w.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:w.length})]})]})}),x==="friends"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"å‹é”ä¸€è¦§"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(m,{variant:"secondary",size:"sm",onClick:()=>fetchFriends(),children:[e.jsx(ue,{className:"w-4 h-4 mr-1"}),"ä¸¦ã³æ›¿ãˆ"]})})]}),z.length===0?e.jsxs(o,{className:"text-center py-8",children:[e.jsx(q,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"ã¾ã å‹é”ãŒã„ã¾ã›ã‚“"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"åŒã˜ãƒ‰ãƒƒã‚°ãƒ©ãƒ³ã§å‡ºä¼šã£ãŸãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®é£¼ã„ä¸»ã•ã‚“ã¨å‹é”ã«ãªã‚Œã¾ã™"})]}):e.jsx("div",{className:"space-y-4",children:z.map(s=>e.jsx(o,{className:"p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(q,{className:"w-6 h-6 text-gray-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:he(s.friend,s.friend_dogs)}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.dog_count,"é ­ã®ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã¨ä¸€ç·’"]}),s.friend_dogs&&s.friend_dogs.length>0&&e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(L,{className:"w-4 h-4 text-blue-600 mr-1"}),e.jsx("p",{className:"text-xs text-gray-500",children:s.friend_dogs.map(t=>`${t.name}${t.gender?M(t.gender):"ã¡ã‚ƒã‚“"}`).join("ã€")})]})]})]}),e.jsxs(m,{size:"sm",onClick:()=>S(s),children:[e.jsx(G,{className:"w-4 h-4 mr-1"}),"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"]})]})},s.id))})]}),x==="requests"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"å‹é”ãƒªã‚¯ã‚¨ã‚¹ãƒˆ"}),_.length===0?e.jsxs(o,{className:"text-center py-8",children:[e.jsx(H,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“"}),e.jsx("p",{className:"text-gray-500",children:"åŒã˜ãƒ‰ãƒƒã‚°ãƒ©ãƒ³ã§å‡ºä¼šã£ãŸäººã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™"})]}):e.jsx("div",{className:"space-y-4",children:_.map(s=>e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(q,{className:"w-6 h-6 text-gray-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®é£¼ã„ä¸»ã•ã‚“ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ"}),e.jsx("p",{className:"text-sm text-gray-600",children:new Date(s.created_at).toLocaleDateString("ja-JP")}),s.message&&e.jsx("p",{className:"text-sm text-gray-700 mt-2 p-2 bg-gray-50 rounded",children:s.message})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(m,{size:"sm",onClick:()=>J(s.id,!0),children:[e.jsx(ae,{className:"w-4 h-4 mr-1"}),"æ‰¿èª"]}),e.jsxs(m,{size:"sm",variant:"secondary",className:"text-red-600 hover:text-red-700",onClick:()=>J(s.id,!1),children:[e.jsx(V,{className:"w-4 h-4 mr-1"}),"æ‹’å¦"]})]})]})},s.id))})]}),x==="nearby"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"block lg:hidden",children:e.jsx(ie,{})}),e.jsx("div",{className:"hidden lg:block",children:e.jsxs(o,{className:"p-6 text-center",children:[e.jsx(E,{className:"w-12 h-12 text-blue-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"è¿‘ãã®ãƒ¯ãƒ³ã¡ã‚ƒã‚“ãŸã¡"}),e.jsx("p",{className:"text-gray-600",children:"ã“ã®æ©Ÿèƒ½ã¯ã‚µã‚¤ãƒ‰ãƒãƒ¼ã§ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™"})]})})]}),x==="blacklist"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆ"}),w.length===0?e.jsxs(o,{className:"text-center py-8",children:[e.jsx(T,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã¯ç©ºã§ã™"}),e.jsx("p",{className:"text-gray-500",children:"ç›¸æ€§ãŒæ‚ªã„ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã‚’ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã«ç™»éŒ²ã™ã‚‹ã¨ã€ãã®ãƒ¯ãƒ³ã¡ã‚ƒã‚“ãŒãƒ‰ãƒƒã‚°ãƒ©ãƒ³ã«å…¥ã£ãŸæ™‚ã«é€šçŸ¥ã•ã‚Œã¾ã™"})]}):e.jsx("div",{className:"space-y-4",children:w.map(s=>e.jsx(o,{className:"p-4 bg-red-50 border-red-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden",children:s.blacklisted_dog?.image_url?e.jsx("img",{src:s.blacklisted_dog.image_url,alt:s.blacklisted_dog.name,className:"w-full h-full object-cover"}):e.jsx(L,{className:"w-6 h-6 text-gray-500"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-red-900",children:[s.blacklisted_dog?.name,s.blacklisted_dog?.gender&&M(s.blacklisted_dog.gender)]}),e.jsx("p",{className:"text-sm text-red-700",children:"é£¼ã„ä¸»: ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®é£¼ã„ä¸»ã•ã‚“"}),e.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["ç†ç”±: ",s.reason]}),e.jsxs("p",{className:"text-xs text-red-500 mt-1",children:["ç™»éŒ²æ—¥: ",new Date(s.created_at).toLocaleDateString("ja-JP")]})]})]}),e.jsxs(m,{size:"sm",variant:"secondary",className:"text-red-600 hover:text-red-700",onClick:()=>xe(s.id),children:[e.jsx(V,{className:"w-4 h-4 mr-1"}),"å‰Šé™¤"]})]})},s.id))})]}),x==="notifications"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"é€šçŸ¥"}),f.length===0?e.jsxs(o,{className:"text-center py-8",children:[e.jsx(Y,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"é€šçŸ¥ã¯ã‚ã‚Šã¾ã›ã‚“"}),e.jsx("p",{className:"text-gray-500",children:"å‹é”ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚„äºˆç´„ã®é€šçŸ¥ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™"})]}):e.jsx("div",{className:"space-y-4",children:f.map(s=>e.jsx(o,{className:`p-4 ${s.read?"":"border-l-4 border-blue-500"} ${de(s.type)}`,onClick:()=>!s.read&&X(s.id),children:e.jsxs("div",{className:"flex items-start space-x-3",children:[ce(s.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:s.title}),e.jsx("p",{className:"text-sm text-gray-700",children:s.message}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Date(s.created_at).toLocaleDateString("ja-JP")," ",new Date(s.created_at).toLocaleTimeString("ja-JP")]})]}),!s.read&&e.jsx("div",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:"æ–°ç€"})]})},s.id))})]}),x==="messages"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"}),g.length===0?e.jsxs(o,{className:"text-center py-8",children:[e.jsx(G,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã‚ã‚Šã¾ã›ã‚“"}),e.jsx("p",{className:"text-gray-500",children:"å‹é”ã¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™"})]}):e.jsx("div",{className:"space-y-4",children:g.map(s=>{const t=s.receiver_id===l?.id,r=t?s.sender:null;return e.jsx(o,{className:`p-4 ${!s.read&&t?"border-l-4 border-blue-500":""}`,onClick:()=>S({id:s.id,friend_id:t?s.sender_id:s.receiver_id,friend:r||{id:"",name:"",user_type:"user",created_at:new Date().toISOString()},dog_count:0,created_at:new Date().toISOString()}),children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(q,{className:"w-5 h-5 text-gray-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("h3",{className:"font-semibold",children:[t?"ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®é£¼ã„ä¸»ã•ã‚“":"è‡ªåˆ†"," ","ã‹ã‚‰"]}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.created_at).toLocaleDateString("ja-JP")})]}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:s.content})]}),!s.read&&t&&e.jsx("div",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:"æœªèª­"})]})},s.id)})})]}),D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-lg w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®é£¼ã„ä¸»ã•ã‚“ã¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"}),e.jsx("button",{onClick:()=>S(null),className:"text-gray-500 hover:text-gray-700",children:e.jsx(V,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"h-64 overflow-y-auto mb-4 p-3 bg-gray-50 rounded-lg",children:e.jsx("div",{className:"text-center text-gray-500 text-sm py-4",children:"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å±¥æ­´ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“"})}),e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("h4",{className:"font-medium text-blue-900 mb-2 flex items-center",children:[e.jsx(ge,{className:"w-4 h-4 mr-1"}),"æ–½è¨­è²¸ã—åˆ‡ã‚Šäºˆç´„ã®å…±æœ‰"]}),e.jsx("p",{className:"text-sm text-blue-800 mb-2",children:"æ–½è¨­è²¸ã—åˆ‡ã‚Šäºˆç´„ãŒã‚ã‚‹å ´åˆã€å‹é”ã«PINã‚³ãƒ¼ãƒ‰ã‚’å…±æœ‰ã§ãã¾ã™"}),e.jsxs(m,{size:"sm",variant:"secondary",className:"w-full",onClick:()=>{alert("ã“ã®æ©Ÿèƒ½ã¯æº–å‚™ä¸­ã§ã™ã€‚æ–½è¨­è²¸ã—åˆ‡ã‚Šäºˆç´„ãŒã‚ã‚‹å ´åˆã«åˆ©ç”¨ã§ãã¾ã™ã€‚")},children:[e.jsx(je,{className:"w-3 h-3 mr-1"}),"äºˆç´„ã‚’å…±æœ‰"]})]}),e.jsx("form",{onSubmit:W,children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:C,onChange:s=>U(s.target.value),placeholder:"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),e.jsxs(m,{type:"submit",isLoading:Q,disabled:!C.trim(),children:[e.jsx(fe,{className:"w-4 h-4 mr-1"}),"é€ä¿¡"]})]})})]})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(ie,{}),e.jsxs(o,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(L,{className:"w-5 h-5 text-blue-600 mr-2"}),"æœ€è¿‘ã®å‡ºä¼šã„"]}),B.length===0?e.jsx("p",{className:"text-gray-600 text-sm",children:"ã¾ã å‡ºä¼šã„ã®è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“"}):e.jsxs("div",{className:"space-y-4",children:[B.slice(0,5).map(s=>{const t=s.dog1.owner_id===l?.id?s.dog1:s.dog2,r=s.dog1.owner_id===l?.id?s.dog2:s.dog1,I=r.owner_id;return e.jsxs("div",{className:"flex items-start space-x-3 pb-3 border-b border-gray-100 last:border-b-0 last:pb-0",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden",children:r.image_url?e.jsx("img",{src:r.image_url,alt:r.name,className:"w-full h-full object-cover"}):e.jsx(L,{className:"w-5 h-5 text-gray-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-medium text-sm",children:[t.name,M(t.gender),"ã¨",r.name,M(r.gender)]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsxs(m,{size:"sm",variant:"secondary",className:"text-xs px-2 py-1",onClick:()=>oe(I,r.name),children:[e.jsx(H,{className:"w-3 h-3 mr-1"}),"å‹é”ç”³è«‹"]}),e.jsxs(m,{size:"sm",variant:"secondary",className:"text-xs px-2 py-1 text-red-600 hover:text-red-700",onClick:()=>{const Z=prompt("ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã«ç™»éŒ²ã™ã‚‹ç†ç”±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:");Z&&me(r.id,Z)},children:[e.jsx(T,{className:"w-3 h-3 mr-1"}),"ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆ"]})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-1 mt-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:new Date(s.encounter_date).toLocaleDateString("ja-JP")})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:s.park.name})]})]})]})]},s.id)}),e.jsxs(m,{variant:"secondary",size:"sm",className:"w-full",children:["ã™ã¹ã¦ã®å‡ºä¼šã„ã‚’è¦‹ã‚‹",e.jsx(be,{className:"w-4 h-4 ml-1"})]})]})]}),e.jsxs(o,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(Ne,{className:"w-5 h-5 text-pink-600 mr-2"}),"ã‚ãªãŸã®ãƒ¯ãƒ³ã¡ã‚ƒã‚“"]}),a.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:"ã¾ã ãƒ¯ãƒ³ã¡ã‚ƒã‚“ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“"}),e.jsx(le,{to:"/register-dog",children:e.jsx(m,{size:"sm",children:"ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã‚’ç™»éŒ²"})})]}):e.jsxs("div",{className:"space-y-3",children:[a.map(s=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx(L,{className:"w-5 h-5 text-gray-500"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-sm",children:[s.name,M(s.gender)]}),e.jsx("p",{className:"text-xs text-gray-500",children:s.breed})]})]},s.id)),e.jsx(le,{to:"/register-dog",children:e.jsxs(m,{variant:"secondary",size:"sm",className:"w-full",children:[e.jsx(L,{className:"w-4 h-4 mr-1"}),"ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã‚’è¿½åŠ "]})})]})]}),e.jsxs(o,{className:"p-6 bg-blue-50 border-blue-200",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3 text-blue-900",children:"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚¬ã‚¤ãƒ‰"}),e.jsxs("div",{className:"space-y-3 text-sm text-blue-800",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"å‹é”ç”³è«‹ã«ã¤ã„ã¦:"}),e.jsx("br",{}),"åŒã˜ãƒ‰ãƒƒã‚°ãƒ©ãƒ³ã§å‡ºä¼šã£ãŸãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®é£¼ã„ä¸»ã•ã‚“ã¨ã®ã¿å‹é”ã«ãªã‚Œã¾ã™ã€‚"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ©Ÿèƒ½:"}),e.jsx("br",{}),"å‹é”ã«ãªã£ãŸæ–¹ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚„ã‚Šå–ã‚ŠãŒã§ãã¾ã™ã€‚æ¬¡å›ã®äºˆç´„ã‚’èª¿æ•´ã—ãŸã‚Šã€ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®æƒ…å ±ã‚’å…±æœ‰ã—ãŸã‚Šã—ã¾ã—ã‚‡ã†ã€‚"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"é€šçŸ¥æ©Ÿèƒ½:"}),e.jsx("br",{}),"å‹é”ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚„äºˆç´„ã®é€šçŸ¥ãŒå±Šãã¾ã™ã€‚å‹é”ã®ãƒ¯ãƒ³ã¡ã‚ƒã‚“ãŒè¿‘ãã®ãƒ‰ãƒƒã‚°ãƒ©ãƒ³ã«ã„ã‚‹å ´åˆã‚‚é€šçŸ¥ã•ã‚Œã¾ã™ã€‚"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆæ©Ÿèƒ½:"}),e.jsx("br",{}),"ç›¸æ€§ãŒæ‚ªã„ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã‚’ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã«ç™»éŒ²ã™ã‚‹ã¨ã€ãã®ãƒ¯ãƒ³ã¡ã‚ƒã‚“ãŒãƒ‰ãƒƒã‚°ãƒ©ãƒ³ã«å…¥ã£ãŸæ™‚ã«é€šçŸ¥ã•ã‚Œã¾ã™ã€‚"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"æ–½è¨­å…±æœ‰æ©Ÿèƒ½:"}),e.jsx("br",{}),"æ–½è¨­è²¸ã—åˆ‡ã‚Šäºˆç´„ã‚’ã—ãŸå ´åˆã€å‹é”ã‚’èª˜ã£ã¦PINã‚³ãƒ¼ãƒ‰ã‚’å…±æœ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚"]})]})]})]})]})]})}export{Se as Community};
