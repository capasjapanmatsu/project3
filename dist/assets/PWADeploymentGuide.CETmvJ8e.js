var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(t,s,i)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i,l=(e,t,s)=>new Promise((i,r)=>{var o=e=>{try{l(s.next(e))}catch(t){r(t)}},n=e=>{try{l(s.throw(e))}catch(t){r(t)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(o,n);l((s=s.apply(e,t)).next())});import{j as a,C as c,B as d}from"./index.Drgpoyph.js";import{r as u}from"./vendor.CKEClKZl.js";import{R as m,a0 as p,aW as h,r as g,aU as x,aC as y,e as f,f as b,A as j,g as v}from"./ui.C72fRZ1L.js";import"./router.B_7Atevv.js";import"./supabase.X3H3st79.js";const w=()=>{const[e,w]=u.useState([]),[N,k]=u.useState([]),[C,S]=u.useState("pre-deployment"),[P,R]=u.useState(!1),W=[{id:"manifest-validation",category:"pre-deployment",title:"マニフェストファイルの検証",description:"manifest.jsonが正しく設定され、すべての必須フィールドが含まれているか確認",status:"pending",priority:"high",autoCheck:!0,checkFunction:()=>l(void 0,null,function*(){try{const e=yield fetch("/manifest.json");if(!e.ok)return!1;const t=yield e.json();return!!(t.name&&t.short_name&&t.start_url&&t.icons)}catch(e){return!1}}),actionRequired:"manifest.jsonの必須フィールドを確認してください",resources:[{title:"Web App Manifest MDN",url:"https://developer.mozilla.org/en-US/docs/Web/Manifest"}]},{id:"service-worker-validation",category:"pre-deployment",title:"Service Workerの検証",description:"Service Workerが正しく実装され、キャッシュ戦略が適切に設定されているか確認",status:"pending",priority:"high",autoCheck:!0,checkFunction:()=>l(void 0,null,function*(){if(!("serviceWorker"in navigator))return!1;try{return!!(yield navigator.serviceWorker.getRegistration())}catch(e){return!1}}),actionRequired:"Service Workerの実装を確認してください",resources:[{title:"Service Worker API MDN",url:"https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API"}]},{id:"build-optimization",category:"pre-deployment",title:"ビルド最適化",description:"本番ビルドが成功し、アセットが適切に最適化されているか確認",status:"pending",priority:"high",autoCheck:!1,actionRequired:"npm run buildまたはnpm run build:pwaを実行して確認",resources:[{title:"Vite Production Build",url:"https://vitejs.dev/guide/build.html"}]},{id:"responsive-design",category:"pre-deployment",title:"レスポンシブデザイン",description:"複数のデバイスサイズで適切に表示されるか確認",status:"pending",priority:"medium",autoCheck:!0,checkFunction:()=>l(void 0,null,function*(){return!!document.querySelector('meta[name="viewport"]')}),actionRequired:"レスポンシブデザインの確認とテスト",resources:[{title:"Responsive Design MDN",url:"https://developer.mozilla.org/en-US/docs/Learn/CSS/CSS_layout/Responsive_Design"}]},{id:"accessibility-check",category:"pre-deployment",title:"アクセシビリティ確認",description:"WCAG 2.1ガイドラインに準拠しているか確認",status:"pending",priority:"medium",autoCheck:!0,checkFunction:()=>l(void 0,null,function*(){const e=document.querySelectorAll("img");return Array.from(e).filter(e=>e.alt).length===e.length}),actionRequired:"アクセシビリティ監査の実行",resources:[{title:"WCAG 2.1 Guidelines",url:"https://www.w3.org/WAI/WCAG21/quickref/"},{title:"axe DevTools",url:"https://www.deque.com/axe/devtools/"}]},{id:"https-setup",category:"deployment",title:"HTTPS設定",description:"本番環境でHTTPS接続が正しく設定されているか確認",status:"pending",priority:"high",autoCheck:!0,checkFunction:()=>l(void 0,null,function*(){return"https:"===location.protocol||"localhost"===location.hostname}),actionRequired:"本番環境でHTTPS証明書を設定",resources:[{title:"Let's Encrypt",url:"https://letsencrypt.org/"},{title:"Netlify HTTPS",url:"https://docs.netlify.com/domains-https/https-ssl/"}]},{id:"domain-setup",category:"deployment",title:"ドメイン設定",description:"カスタムドメインが正しく設定され、DNSが適切に構成されているか確認",status:"pending",priority:"medium",autoCheck:!1,actionRequired:"DNSレコードの確認とドメイン設定",resources:[{title:"Netlify Domains",url:"https://docs.netlify.com/domains-https/custom-domains/"}]},{id:"cdn-setup",category:"deployment",title:"CDN設定",description:"Content Delivery Networkが適切に設定され、静的アセットが高速配信されているか確認",status:"pending",priority:"medium",autoCheck:!1,actionRequired:"CDN設定の確認と最適化",resources:[{title:"Cloudflare",url:"https://www.cloudflare.com/"},{title:"Netlify CDN",url:"https://docs.netlify.com/domains-https/cdn/"}]},{id:"environment-variables",category:"deployment",title:"環境変数設定",description:"本番環境で必要な環境変数がすべて正しく設定されているか確認",status:"pending",priority:"high",autoCheck:!1,actionRequired:"本番環境の環境変数を確認",resources:[{title:"Netlify Environment Variables",url:"https://docs.netlify.com/configure-builds/environment-variables/"}]},{id:"pwa-installability",category:"post-deployment",title:"PWAインストール可能性",description:"ブラウザでPWAとして認識され、インストールプロンプトが表示されるか確認",status:"pending",priority:"high",autoCheck:!0,checkFunction:()=>l(void 0,null,function*(){return new Promise(e=>{const t=setTimeout(()=>e(!1),3e3);window.addEventListener("beforeinstallprompt",()=>{clearTimeout(t),e(!0)})})}),actionRequired:"PWAインストール機能のテスト",resources:[{title:"PWA Install Criteria",url:"https://web.dev/install-criteria/"}]},{id:"offline-functionality",category:"post-deployment",title:"オフライン機能",description:"ネットワーク接続がない状態でも基本機能が動作するか確認",status:"pending",priority:"high",autoCheck:!0,checkFunction:()=>l(void 0,null,function*(){if(!("caches"in window))return!1;return(yield caches.keys()).length>0}),actionRequired:"オフライン機能のテスト",resources:[{title:"Offline Cookbook",url:"https://web.dev/offline-cookbook/"}]},{id:"performance-test",category:"post-deployment",title:"パフォーマンステスト",description:"Lighthouse監査でPWAスコア90以上を達成しているか確認",status:"pending",priority:"medium",autoCheck:!1,actionRequired:"Lighthouse監査の実行",resources:[{title:"Lighthouse",url:"https://developers.google.com/web/tools/lighthouse"},{title:"PageSpeed Insights",url:"https://pagespeed.web.dev/"}]},{id:"cross-browser-test",category:"post-deployment",title:"クロスブラウザテスト",description:"主要ブラウザ（Chrome、Firefox、Safari、Edge）で正常に動作するか確認",status:"pending",priority:"medium",autoCheck:!1,actionRequired:"複数ブラウザでの動作確認",resources:[{title:"BrowserStack",url:"https://www.browserstack.com/"},{title:"Can I Use",url:"https://caniuse.com/"}]},{id:"analytics-setup",category:"monitoring",title:"アナリティクス設定",description:"ユーザー行動とパフォーマンスを追跡するアナリティクスが設定されているか確認",status:"pending",priority:"medium",autoCheck:!1,actionRequired:"Google Analytics等の設定",resources:[{title:"Google Analytics",url:"https://analytics.google.com/"},{title:"Netlify Analytics",url:"https://docs.netlify.com/monitor-sites/analytics/"}]},{id:"error-monitoring",category:"monitoring",title:"エラー監視",description:"JavaScriptエラーやクラッシュを監視するシステムが設定されているか確認",status:"pending",priority:"medium",autoCheck:!1,actionRequired:"エラー監視サービスの設定",resources:[{title:"Sentry",url:"https://sentry.io/"},{title:"LogRocket",url:"https://logrocket.com/"}]},{id:"uptime-monitoring",category:"monitoring",title:"アップタイム監視",description:"サイトの可用性を監視し、ダウンタイムを検知するシステムが設定されているか確認",status:"pending",priority:"low",autoCheck:!1,actionRequired:"アップタイム監視の設定",resources:[{title:"UptimeRobot",url:"https://uptimerobot.com/"},{title:"Pingdom",url:"https://www.pingdom.com/"}]},{id:"performance-monitoring",category:"monitoring",title:"パフォーマンス監視",description:"継続的にパフォーマンスを監視し、劣化を検知するシステムが設定されているか確認",status:"pending",priority:"medium",autoCheck:!1,actionRequired:"パフォーマンス監視の設定",resources:[{title:"Web Vitals",url:"https://web.dev/vitals/"},{title:"Chrome UX Report",url:"https://developers.google.com/web/tools/chrome-user-experience-report"}]}],q=[{name:"Development",url:"http://localhost:5173",status:"inactive"},{name:"Preview/Staging",url:"",status:"inactive"},{name:"Production",url:"",status:"inactive"}],A=()=>l(void 0,null,function*(){R(!0);const e=[...W];for(const s of e)if(s.autoCheck&&s.checkFunction)try{const e=yield s.checkFunction();s.status=e?"completed":"failed"}catch(t){s.status="failed"}w(e),R(!1)}),D=e=>{w(l=>l.map(l=>{return l.id===e?(a=((e,t)=>{for(var s in t||(t={}))r.call(t,s)&&n(e,s,t[s]);if(i)for(var s of i(t))o.call(t,s)&&n(e,s,t[s]);return e})({},l),c={status:"completed"===l.status?"pending":"completed"},t(a,s(c))):l;var a,c}))},O=e=>{switch(e){case"completed":return a.jsx(v,{className:"h-5 w-5 text-green-500"});case"failed":return a.jsx(b,{className:"h-5 w-5 text-red-500"});case"pending":return a.jsx(j,{className:"h-5 w-5 text-yellow-500"});case"not-applicable":return a.jsx(b,{className:"h-5 w-5 text-gray-400"})}},T=e=>{switch(e){case"high":return"border-red-200 bg-red-50";case"medium":return"border-yellow-200 bg-yellow-50";case"low":return"border-green-200 bg-green-50"}},F={"pre-deployment":{name:"デプロイ前チェック",icon:a.jsx(f,{className:"h-4 w-4"})},deployment:{name:"デプロイ",icon:a.jsx(y,{className:"h-4 w-4"})},"post-deployment":{name:"デプロイ後確認",icon:a.jsx(x,{className:"h-4 w-4"})},monitoring:{name:"監視・運用",icon:a.jsx(g,{className:"h-4 w-4"})}};u.useEffect(()=>{w(W),k(q),A()},[]);const I=(()=>{if(0===e.length)return 0;const t=e.filter(e=>"completed"===e.status).length;return Math.round(t/e.length*100)})();return a.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"PWA デプロイメントガイド"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Progressive Web Appの本番環境デプロイから運用まで、包括的なチェックリストとガイド"}),a.jsxs(c,{className:"p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"デプロイメント進捗状況"}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4",children:a.jsx("div",{className:"bg-blue-500 h-4 rounded-full transition-all duration-300",style:{width:`${I}%`}})}),a.jsxs("p",{className:"text-lg font-medium",children:[I,"% 完了 (",e.filter(e=>"completed"===e.status).length,"/",e.length,")"]})]}),a.jsx("div",{className:"flex justify-center gap-4 mb-6",children:a.jsxs(d,{onClick:A,disabled:P,className:"flex items-center gap-2",children:[a.jsx(m,{className:"h-4 w-4 "+(P?"animate-spin":"")}),P?"自動チェック実行中...":"自動チェック実行"]})})]}),a.jsxs(c,{className:"p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"デプロイメント環境"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:N.map(e=>a.jsxs("div",{className:"border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium",children:e.name}),a.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+("active"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:"active"===e.status?"アクティブ":"pending"===e.status?"保留中":"非アクティブ"})]}),e.url&&a.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm flex items-center gap-1",children:[e.url,a.jsx(p,{className:"h-3 w-3"})]}),e.issues&&e.issues.length>0&&a.jsx("div",{className:"mt-2",children:a.jsxs("p",{className:"text-red-600 text-xs",children:["問題: ",e.issues.join(", ")]})})]},e.name))})]}),a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1 overflow-x-auto",children:Object.entries(F).map(([e,t])=>a.jsxs("button",{onClick:()=>S(e),className:"flex items-center gap-2 px-4 py-2 rounded-md transition-colors whitespace-nowrap "+(C===e?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:[t.icon,a.jsx("span",{className:"hidden sm:inline",children:t.name})]},e))})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[F[C].icon,F[C].name]}),e.filter(e=>e.category===C).map(e=>a.jsx(c,{className:`p-6 border-2 ${T(e.priority)}`,children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("button",{onClick:()=>D(e.id),className:"mt-1",disabled:e.autoCheck,children:O(e.status)}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:e.title}),a.jsxs("div",{className:"flex items-center gap-2",children:[e.autoCheck&&a.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"自動チェック"}),a.jsx("span",{className:"text-xs px-2 py-1 rounded "+("high"===e.priority?"bg-red-100 text-red-800":"medium"===e.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:"high"===e.priority?"高":"medium"===e.priority?"中":"低"})]})]}),a.jsx("p",{className:"text-gray-600 text-sm mb-3",children:e.description}),e.actionRequired&&a.jsx("div",{className:"bg-white bg-opacity-70 border border-gray-200 rounded-md p-3 mb-3",children:a.jsxs("p",{className:"text-sm text-gray-700",children:[a.jsx("strong",{children:"必要なアクション:"})," ",e.actionRequired]})}),e.resources&&e.resources.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:e.resources.map((e,t)=>a.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-800 underline flex items-center gap-1",children:[e.title,a.jsx(p,{className:"h-3 w-3"})]},t))})]})]})},e.id))]}),a.jsxs(c,{className:"p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(h,{className:"h-5 w-5"}),"次のステップ"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium mb-2",children:"デプロイメント完了後"}),a.jsxs("ul",{className:"space-y-1 text-gray-600",children:[a.jsx("li",{children:"• 定期的なLighthouse監査の実行"}),a.jsx("li",{children:"• パフォーマンス指標の監視"}),a.jsx("li",{children:"• ユーザーフィードバックの収集"}),a.jsx("li",{children:"• セキュリティ更新の適用"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium mb-2",children:"継続的改善"}),a.jsxs("ul",{className:"space-y-1 text-gray-600",children:[a.jsx("li",{children:"• 新機能の段階的ロールアウト"}),a.jsx("li",{children:"• A/Bテストの実施"}),a.jsx("li",{children:"• キャッシュ戦略の最適化"}),a.jsx("li",{children:"• PWA機能の拡張"})]})]})]})]})]})};export{w as default};
