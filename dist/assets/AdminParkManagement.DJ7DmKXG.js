var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(s,a,r)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[a]=r,i=(e,s)=>{for(var a in s||(s={}))t.call(s,a)&&n(e,a,s[a]);if(r)for(var a of r(s))l.call(s,a)&&n(e,a,s[a]);return e},c=(e,r)=>s(e,a(r)),d=(e,s,a)=>new Promise(((r,t)=>{var l=e=>{try{i(a.next(e))}catch(s){t(s)}},n=e=>{try{i(a.throw(e))}catch(s){t(s)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,n);i((a=a.apply(e,s)).next())}));import{u as m,j as o,C as x,B as p}from"./index.oOj2R_C7.js";import{u as g,r as h,L as u}from"./router.icJHpBzt.js";import{a as j,A as v}from"./AdminParkApproval.DkK6YtXj.js";import{I as b}from"./Input.DeZ8m3vP.js";import{S as N}from"./Select.Ccsc19kJ.js";import{A as f,w as y,n as w,F as _,aC as k,aF as C,aG as S,e as P,U as L,a8 as O,q as A,$ as T,N as D,f as E,t as F,X as I}from"./ui.UnEvinBv.js";import"./vendor.D1SiiUJb.js";import"./supabase.CZ8ekJUM.js";function z(){const{isAdmin:e}=m(),s=g(),[a,r]=h.useState("parks"),[t,l]=h.useState([]),[n,z]=h.useState([]),[Z,$]=h.useState(!0),[q,B]=h.useState(""),[G,J]=h.useState(""),[U,H]=h.useState(""),[K,M]=h.useState("all"),[Q,R]=h.useState("created_at"),[V,W]=h.useState("desc"),X=j("parks"),Y=e=>{J(e),B(""),setTimeout((()=>J("")),5e3)},ee=e=>{B(e),J(""),setTimeout((()=>B("")),8e3)};h.useEffect((()=>{e?"parks"===a&&se():s("/")}),[e,s,a]),h.useEffect((()=>{t.length>0&&ae()}),[t,U,K,Q,V]);const se=()=>d(null,null,(function*(){$(!0),B("");try{l([{id:"1",name:"渋谷ドッグパーク",description:"都心のオアシス",address:"東京都渋谷区",price:800,status:"approved",owner_id:"owner1",owner_name:"田中太郎",created_at:"2024-01-15T10:00:00Z",max_capacity:15,large_dog_area:!0,small_dog_area:!0,private_booths:!0,facilities:{parking:!0,shower:!0,restroom:!0,agility:!1,rest_area:!0,water_station:!0},monthly_revenue:45e3,average_rating:4.5,review_count:23},{id:"2",name:"新宿セントラルドッグラン",description:"広々とした空間",address:"東京都新宿区",price:1200,status:"pending",owner_id:"owner2",owner_name:"佐藤花子",created_at:"2024-01-20T14:30:00Z",max_capacity:20,large_dog_area:!0,small_dog_area:!1,private_booths:!1,facilities:{parking:!0,shower:!1,restroom:!0,agility:!0,rest_area:!1,water_station:!0},monthly_revenue:32e3,average_rating:4.2,review_count:18}])}catch(e){ee("ドッグラン一覧の取得に失敗しました。")}finally{$(!1)}})),ae=()=>{let e=[...t];U&&(e=e.filter((e=>e.name.toLowerCase().includes(U.toLowerCase())||e.address.toLowerCase().includes(U.toLowerCase())||e.owner_name.toLowerCase().includes(U.toLowerCase())))),"all"!==K&&(e=e.filter((e=>e.status===K))),e.sort(((e,s)=>{let a=e[Q],r=s[Q];return"created_at"===Q&&(a=new Date(a).getTime(),r=new Date(r).getTime()),"asc"===V?a>r?1:-1:a<r?1:-1})),z(e)};return Z&&"parks"===a?o.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:o.jsx("div",{className:"max-w-7xl mx-auto",children:o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})})}):o.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsx("div",{className:"mb-8",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"ドッグラン管理"}),o.jsx("p",{className:"text-gray-600",children:"ドッグラン施設の詳細情報と本人確認書類の管理"})]}),o.jsx("div",{className:"text-right",children:o.jsxs("p",{className:"text-sm text-gray-500",children:["総施設数: ",t.length,"施設"]})})]})}),q&&o.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(f,{className:"w-5 h-5 text-red-600 mr-2"}),o.jsx("span",{className:"text-red-800",children:q})]})}),G&&o.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx(y,{className:"w-5 h-5 text-green-600 mr-2"}),o.jsx("span",{className:"text-green-800",children:G})]})}),o.jsx("div",{className:"mb-8",children:o.jsx("div",{className:"border-b border-gray-200",children:o.jsxs("nav",{className:"-mb-px flex space-x-8",children:[o.jsxs("button",{onClick:()=>r("parks"),className:"whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm "+("parks"===a?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[o.jsx(w,{className:"w-5 h-5 inline mr-2"}),"ドッグラン一覧"]}),o.jsxs("button",{onClick:()=>r("applications"),className:"whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm "+("applications"===a?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[o.jsx(_,{className:"w-5 h-5 inline mr-2"}),"ドッグラン申請",X.pendingParks.length>0&&o.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:X.pendingParks.length})]})]})})}),"parks"===a&&o.jsxs("div",{className:"space-y-6",children:[o.jsx(x,{className:"p-6",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx(b,{label:"",placeholder:"施設名、住所、オーナー名で検索...",value:U,onChange:e=>H(e.target.value),className:"pl-10"})]}),o.jsx(N,{label:"",options:[{value:"all",label:"全ステータス"},{value:"pending",label:"審査中"},{value:"approved",label:"承認済み"},{value:"rejected",label:"却下"}],value:K,onChange:e=>M(e.target.value)}),o.jsx(N,{label:"",options:[{value:"created_at",label:"作成日時"},{value:"name",label:"施設名"},{value:"monthly_revenue",label:"月間収益"},{value:"average_rating",label:"平均評価"}],value:Q,onChange:e=>R(e.target.value)}),o.jsxs(p,{variant:"secondary",onClick:()=>W("asc"===V?"desc":"asc"),className:"flex items-center justify-center",children:["asc"===V?o.jsx(C,{className:"w-4 h-4 mr-2"}):o.jsx(S,{className:"w-4 h-4 mr-2"}),"asc"===V?"昇順":"降順"]})]})}),o.jsx("div",{className:"grid grid-cols-1 gap-6",children:n.map((e=>o.jsx(x,{className:"p-6",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),o.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+("approved"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:"approved"===e.status?"承認済み":"pending"===e.status?"審査中":"却下"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(P,{className:"w-4 h-4 mr-1"}),e.address]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(L,{className:"w-4 h-4 mr-1"}),"定員: ",e.max_capacity,"頭"]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(O,{className:"w-4 h-4 mr-1"}),"¥",e.price.toLocaleString()]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(A,{className:"w-4 h-4 mr-1"}),new Date(e.created_at).toLocaleDateString("ja-JP")]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(T,{className:"w-4 h-4 mr-1"}),"月間収益: ¥",e.monthly_revenue.toLocaleString()]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(D,{className:"w-4 h-4 mr-1 text-yellow-400"}),"評価: ",e.average_rating," (",e.review_count,"件)"]}),o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(E,{className:"w-4 h-4 mr-1"}),"オーナー: ",e.owner_name]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs(u,{to:`/admin/parks/${e.id}`,className:"flex items-center px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded-md hover:bg-blue-200",children:[o.jsx(F,{className:"w-4 h-4 mr-1"}),"詳細"]}),"pending"===e.status&&o.jsxs(o.Fragment,{children:[o.jsxs(p,{size:"sm",onClick:()=>{return s=e.id,d(null,null,(function*(){try{l((e=>e.map((e=>e.id===s?c(i({},e),{status:"approved"}):e)))),Y("ドッグランを承認しました")}catch(e){ee("ドッグランの承認に失敗しました")}}));var s},className:"bg-green-600 hover:bg-green-700",children:[o.jsx(y,{className:"w-4 h-4 mr-1"}),"承認"]}),o.jsxs(p,{size:"sm",variant:"secondary",onClick:()=>{return s=e.id,d(null,null,(function*(){try{l((e=>e.map((e=>e.id===s?c(i({},e),{status:"rejected"}):e)))),Y("ドッグランを却下しました")}catch(e){ee("ドッグランの却下に失敗しました")}}));var s},className:"text-red-600 hover:text-red-700",children:[o.jsx(I,{className:"w-4 h-4 mr-1"}),"却下"]})]})]})]})},e.id)))})]}),"applications"===a&&o.jsx(v,{pendingParks:X.pendingParks,isLoading:X.isLoading,onApprovalComplete:Y,onError:ee})]})})}export{z as AdminParkManagement};
