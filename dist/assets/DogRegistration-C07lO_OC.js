import{u as e,b as t,j as r,B as n}from"./index-rzoKNnex.js";import{r as i}from"./vendor-Cwmn0chA.js";import{I as a}from"./Input-DdOgOQvG.js";import{S as o}from"./Select-Dnpc2fHv.js";import{C as s}from"./Card-CRM3w0N8.js";import{d as l}from"./dogBreeds-6lxY8Uni.js";import{P as c,r as f,X as u,D as d,l as h}from"./ui-CMSAjam7.js";import"./supabase-Dzr8oIt2.js";function g(e,t){return new Promise((function(r,n){let i;return m(e).then((function(e){try{return i=e,r(new Blob([t.slice(0,2),i,t.slice(2)],{type:"image/jpeg"}))}catch(a){return n(a)}}),n)}))}const m=e=>new Promise(((t,r)=>{const n=new FileReader;n.addEventListener("load",(({target:{result:e}})=>{const n=new DataView(e);let i=0;if(65496!==n.getUint16(i))return r("not a valid JPEG");for(i+=2;;){const a=n.getUint16(i);if(65498===a)break;const o=n.getUint16(i+2);if(65505===a&&1165519206===n.getUint32(i+4)){const a=i+10;let s;switch(n.getUint16(a)){case 18761:s=!0;break;case 19789:s=!1;break;default:return r("TIFF header contains invalid endian")}if(42!==n.getUint16(a+2,s))return r("TIFF header contains invalid version");const l=n.getUint32(a+4,s),c=a+l+2+12*n.getUint16(a+l,s);for(let e=a+l+2;e<c;e+=12)if(274==n.getUint16(e,s)){if(3!==n.getUint16(e+2,s))return r("Orientation data type is invalid");if(1!==n.getUint32(e+4,s))return r("Orientation data count is invalid");n.setUint16(e+8,1,s);break}return t(e.slice(i,i+2+o))}i+=2+o}return t(new Blob)})),n.readAsArrayBuffer(e)}));var b,p,v,w={},y={get exports(){return w},set exports(e){w=e}};v={},y.exports=v,v.parse=function(e,t){for(var r=v.bin.readUshort,n=v.bin.readUint,i=0,a={},o=new Uint8Array(e),s=o.length-4;101010256!=n(o,s);)s--;i=s,i+=4;var l=r(o,i+=4);r(o,i+=2);var c=n(o,i+=2),f=n(o,i+=4);i+=4,i=f;for(var u=0;u<l;u++){n(o,i),i+=4,i+=4,i+=4,n(o,i+=4),c=n(o,i+=4);var d=n(o,i+=4),h=r(o,i+=4),g=r(o,i+2),m=r(o,i+4);i+=6;var b=n(o,i+=8);i+=4,i+=h+g+m,v._readLocal(o,b,a,c,d,t)}return a},v._readLocal=function(e,t,r,n,i,a){var o=v.bin.readUshort,s=v.bin.readUint;s(e,t),o(e,t+=4),o(e,t+=2);var l=o(e,t+=2);s(e,t+=2),s(e,t+=4),t+=4;var c=o(e,t+=8),f=o(e,t+=2);t+=2;var u=v.bin.readUTF8(e,t,c);if(t+=c,t+=f,a)r[u]={size:i,csize:n};else{var d=new Uint8Array(e.buffer,t);if(0==l)r[u]=new Uint8Array(d.buffer.slice(t,t+n));else{if(8!=l)throw"unknown compression method: "+l;var h=new Uint8Array(i);v.inflateRaw(d,h),r[u]=h}}},v.inflateRaw=function(e,t){return v.F.inflate(e,t)},v.inflate=function(e,t){return e[0],e[1],v.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),t)},v.deflate=function(e,t){null==t&&(t={level:6});var r=0,n=new Uint8Array(50+Math.floor(1.1*e.length));n[r]=120,n[r+1]=156,r+=2,r=v.F.deflateRaw(e,n,r,t.level);var i=v.adler(e,0,e.length);return n[r+0]=i>>>24&255,n[r+1]=i>>>16&255,n[r+2]=i>>>8&255,n[r+3]=i>>>0&255,new Uint8Array(n.buffer,0,r+4)},v.deflateRaw=function(e,t){null==t&&(t={level:6});var r=new Uint8Array(50+Math.floor(1.1*e.length)),n=v.F.deflateRaw(e,r,n,t.level);return new Uint8Array(r.buffer,0,n)},v.encode=function(e,t){null==t&&(t=!1);var r=0,n=v.bin.writeUint,i=v.bin.writeUshort,a={};for(var o in e){var s=!v._noNeed(o)&&!t,l=e[o],c=v.crc.crc(l,0,l.length);a[o]={cpr:s,usize:l.length,crc:c,file:s?v.deflateRaw(l):l}}for(var o in a)r+=a[o].file.length+30+46+2*v.bin.sizeUTF8(o);r+=22;var f=new Uint8Array(r),u=0,d=[];for(var o in a){var h=a[o];d.push(u),u=v._writeHeader(f,u,o,h,0)}var g=0,m=u;for(var o in a)h=a[o],d.push(u),u=v._writeHeader(f,u,o,h,1,d[g++]);var b=u-m;return n(f,u,101010256),u+=4,i(f,u+=4,g),i(f,u+=2,g),n(f,u+=2,b),n(f,u+=4,m),u+=4,u+=2,f.buffer},v._noNeed=function(e){var t=e.split(".").pop().toLowerCase();return-1!="png,jpg,jpeg,zip".indexOf(t)},v._writeHeader=function(e,t,r,n,i,a){var o=v.bin.writeUint,s=v.bin.writeUshort,l=n.file;return o(e,t,0==i?67324752:33639248),t+=4,1==i&&(t+=2),s(e,t,20),s(e,t+=2,0),s(e,t+=2,n.cpr?8:0),o(e,t+=2,0),o(e,t+=4,n.crc),o(e,t+=4,l.length),o(e,t+=4,n.usize),s(e,t+=4,v.bin.sizeUTF8(r)),s(e,t+=2,0),t+=2,1==i&&(t+=2,t+=2,o(e,t+=6,a),t+=4),t+=v.bin.writeUTF8(e,t,r),0==i&&(e.set(l,t),t+=l.length),t},v.crc={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var r=t,n=0;n<8;n++)1&r?r=3988292384^r>>>1:r>>>=1;e[t]=r}return e}(),update:function(e,t,r,n){for(var i=0;i<n;i++)e=v.crc.table[255&(e^t[r+i])]^e>>>8;return e},crc:function(e,t,r){return 4294967295^v.crc.update(4294967295,e,t,r)}},v.adler=function(e,t,r){for(var n=1,i=0,a=t,o=t+r;a<o;){for(var s=Math.min(a+5552,o);a<s;)i+=n+=e[a++];n%=65521,i%=65521}return i<<16|n},v.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,r){e[t]=255&r,e[t+1]=r>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,r){e[t]=255&r,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},readASCII:function(e,t,r){for(var n="",i=0;i<r;i++)n+=String.fromCharCode(e[t+i]);return n},writeASCII:function(e,t,r){for(var n=0;n<r.length;n++)e[t+n]=r.charCodeAt(n)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,r){for(var n,i="",a=0;a<r;a++)i+="%"+v.bin.pad(e[t+a].toString(16));try{n=decodeURIComponent(i)}catch(o){return v.bin.readASCII(e,t,r)}return n},writeUTF8:function(e,t,r){for(var n=r.length,i=0,a=0;a<n;a++){var o=r.charCodeAt(a);if(4294967168&o)if(4294965248&o)if(4294901760&o){if(4292870144&o)throw"e";e[t+i]=240|o>>18,e[t+i+1]=128|o>>12&63,e[t+i+2]=128|o>>6&63,e[t+i+3]=128|63&o,i+=4}else e[t+i]=224|o>>12,e[t+i+1]=128|o>>6&63,e[t+i+2]=128|63&o,i+=3;else e[t+i]=192|o>>6,e[t+i+1]=128|63&o,i+=2;else e[t+i]=o,i++}return i},sizeUTF8:function(e){for(var t=e.length,r=0,n=0;n<t;n++){var i=e.charCodeAt(n);if(4294967168&i)if(4294965248&i)if(4294901760&i){if(4292870144&i)throw"e";r+=4}else r+=3;else r+=2;else r++}return r}},v.F={},v.F.deflateRaw=function(e,t,r,n){var i=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][n],a=v.F.U,o=v.F._goodIndex;v.F._hash;var s=v.F._putsE,l=0,c=r<<3,f=0,u=e.length;if(0==n){for(;l<u;)s(t,c,l+(U=Math.min(65535,u-l))==u?1:0),c=v.F._copyExact(e,l,U,t,c+8),l+=U;return c>>>3}var d=a.lits,h=a.strt,g=a.prev,m=0,b=0,p=0,w=0,y=0,A=0;for(u>2&&(h[A=v.F._hash(e,0)]=0),l=0;l<u;l++){if(y=A,l+1<u-2){A=v.F._hash(e,l+1);var x=l+1&32767;g[x]=h[A],h[A]=x}if(f<=l){(m>14e3||b>26697)&&u-l>100&&(f<l&&(d[m]=l-f,m+=2,f=l),c=v.F._writeBlock(l==u-1||f==u?1:0,d,m,w,e,p,l-p,t,c),m=b=w=0,p=l);var F=0;l<u-2&&(F=v.F._bestMatch(e,l,g,y,Math.min(i[2],u-l),i[3]));var U=F>>>16,_=65535&F;if(0!=F){_=65535&F;var j=o(U=F>>>16,a.of0);a.lhst[257+j]++;var E=o(_,a.df0);a.dhst[E]++,w+=a.exb[j]+a.dxb[E],d[m]=U<<23|l-f,d[m+1]=_<<16|j<<8|E,m+=2,f=l+U}else a.lhst[e[l]]++;b++}}for(p==l&&0!=e.length||(f<l&&(d[m]=l-f,m+=2,f=l),c=v.F._writeBlock(1,d,m,w,e,p,l-p,t,c),m=0,b=0,m=b=w=0,p=l);7&c;)c++;return c>>>3},v.F._bestMatch=function(e,t,r,n,i,a){var o=32767&t,s=r[o],l=o-s+32768&32767;if(s==o||n!=v.F._hash(e,t-l))return 0;for(var c=0,f=0,u=Math.min(32767,t);l<=u&&0!=--a&&s!=o;){if(0==c||e[t+c]==e[t+c-l]){var d=v.F._howLong(e,t,l);if(d>c){if(f=l,(c=d)>=i)break;l+2<d&&(d=l+2);for(var h=0,g=0;g<d-2;g++){var m=t-l+g+32768&32767,b=m-r[m]+32768&32767;b>h&&(h=b,s=m)}}}l+=(o=s)-(s=r[o])+32768&32767}return c<<16|f},v.F._howLong=function(e,t,r){if(e[t]!=e[t-r]||e[t+1]!=e[t+1-r]||e[t+2]!=e[t+2-r])return 0;var n=t,i=Math.min(e.length,t+258);for(t+=3;t<i&&e[t]==e[t-r];)t++;return t-n},v.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},v.saved=0,v.F._writeBlock=function(e,t,r,n,i,a,o,s,l){var c,f,u,d,h,g,m,b,p,w=v.F.U,y=v.F._putsF,A=v.F._putsE;w.lhst[256]++,f=(c=v.F.getTrees())[0],u=c[1],d=c[2],h=c[3],g=c[4],m=c[5],b=c[6],p=c[7];var x=32+(l+3&7?8-(l+3&7):0)+(o<<3),F=n+v.F.contSize(w.fltree,w.lhst)+v.F.contSize(w.fdtree,w.dhst),U=n+v.F.contSize(w.ltree,w.lhst)+v.F.contSize(w.dtree,w.dhst);U+=14+3*m+v.F.contSize(w.itree,w.ihst)+(2*w.ihst[16]+3*w.ihst[17]+7*w.ihst[18]);for(var _=0;_<286;_++)w.lhst[_]=0;for(_=0;_<30;_++)w.dhst[_]=0;for(_=0;_<19;_++)w.ihst[_]=0;var j=x<F&&x<U?0:F<U?1:2;if(y(s,l,e),y(s,l+1,j),l+=3,0==j){for(;7&l;)l++;l=v.F._copyExact(i,a,o,s,l)}else{var E,I;if(1==j&&(E=w.fltree,I=w.fdtree),2==j){v.F.makeCodes(w.ltree,f),v.F.revCodes(w.ltree,f),v.F.makeCodes(w.dtree,u),v.F.revCodes(w.dtree,u),v.F.makeCodes(w.itree,d),v.F.revCodes(w.itree,d),E=w.ltree,I=w.dtree,A(s,l,h-257),A(s,l+=5,g-1),A(s,l+=5,m-4),l+=4;for(var C=0;C<m;C++)A(s,l+3*C,w.itree[1+(w.ordr[C]<<1)]);l+=3*m,l=v.F._codeTiny(b,w.itree,s,l),l=v.F._codeTiny(p,w.itree,s,l)}for(var M=a,S=0;S<r;S+=2){for(var N=t[S],D=N>>>23,B=M+(8388607&N);M<B;)l=v.F._writeLit(i[M++],E,s,l);if(0!=D){var R=t[S+1],T=R>>16,k=R>>8&255,P=255&R;A(s,l=v.F._writeLit(257+k,E,s,l),D-w.of0[k]),l+=w.exb[k],y(s,l=v.F._writeLit(P,I,s,l),T-w.df0[P]),l+=w.dxb[P],M+=D}}l=v.F._writeLit(256,E,s,l)}return l},v.F._copyExact=function(e,t,r,n,i){var a=i>>>3;return n[a]=r,n[a+1]=r>>>8,n[a+2]=255-n[a],n[a+3]=255-n[a+1],a+=4,n.set(new Uint8Array(e.buffer,t,r),a),i+(r+4<<3)},v.F.getTrees=function(){for(var e=v.F.U,t=v.F._hufTree(e.lhst,e.ltree,15),r=v.F._hufTree(e.dhst,e.dtree,15),n=[],i=v.F._lenCodes(e.ltree,n),a=[],o=v.F._lenCodes(e.dtree,a),s=0;s<n.length;s+=2)e.ihst[n[s]]++;for(s=0;s<a.length;s+=2)e.ihst[a[s]]++;for(var l=v.F._hufTree(e.ihst,e.itree,7),c=19;c>4&&0==e.itree[1+(e.ordr[c-1]<<1)];)c--;return[t,r,l,i,o,c,n,a]},v.F.getSecond=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(e[r+1]);return t},v.F.nonZero=function(e){for(var t="",r=0;r<e.length;r+=2)0!=e[r+1]&&(t+=(r>>1)+",");return t},v.F.contSize=function(e,t){for(var r=0,n=0;n<t.length;n++)r+=t[n]*e[1+(n<<1)];return r},v.F._codeTiny=function(e,t,r,n){for(var i=0;i<e.length;i+=2){var a=e[i],o=e[i+1];n=v.F._writeLit(a,t,r,n);var s=16==a?2:17==a?3:7;a>15&&(v.F._putsE(r,n,o,s),n+=s)}return n},v.F._lenCodes=function(e,t){for(var r=e.length;2!=r&&0==e[r-1];)r-=2;for(var n=0;n<r;n+=2){var i=e[n+1],a=n+3<r?e[n+3]:-1,o=n+5<r?e[n+5]:-1,s=0==n?-1:e[n-1];if(0==i&&a==i&&o==i){for(var l=n+5;l+2<r&&e[l+2]==i;)l+=2;(c=Math.min(l+1-n>>>1,138))<11?t.push(17,c-3):t.push(18,c-11),n+=2*c-2}else if(i==s&&a==i&&o==i){for(l=n+5;l+2<r&&e[l+2]==i;)l+=2;var c=Math.min(l+1-n>>>1,6);t.push(16,c-3),n+=2*c-2}else t.push(i,0)}return r>>>1},v.F._hufTree=function(e,t,r){var n=[],i=e.length,a=t.length,o=0;for(o=0;o<a;o+=2)t[o]=0,t[o+1]=0;for(o=0;o<i;o++)0!=e[o]&&n.push({lit:o,f:e[o]});var s=n.length,l=n.slice(0);if(0==s)return 0;if(1==s){var c=n[0].lit;return l=0==c?1:0,t[1+(c<<1)]=1,t[1+(l<<1)]=1,1}n.sort((function(e,t){return e.f-t.f}));var f=n[0],u=n[1],d=0,h=1,g=2;for(n[0]={lit:-1,f:f.f+u.f,l:f,r:u,d:0};h!=s-1;)f=d!=h&&(g==s||n[d].f<n[g].f)?n[d++]:n[g++],u=d!=h&&(g==s||n[d].f<n[g].f)?n[d++]:n[g++],n[h++]={lit:-1,f:f.f+u.f,l:f,r:u};var m=v.F.setDepth(n[h-1],0);for(m>r&&(v.F.restrictDepth(l,r,m),m=r),o=0;o<s;o++)t[1+(l[o].lit<<1)]=l[o].d;return m},v.F.setDepth=function(e,t){return-1!=e.lit?(e.d=t,t):Math.max(v.F.setDepth(e.l,t+1),v.F.setDepth(e.r,t+1))},v.F.restrictDepth=function(e,t,r){var n=0,i=1<<r-t,a=0;for(e.sort((function(e,t){return t.d==e.d?e.f-t.f:t.d-e.d})),n=0;n<e.length&&e[n].d>t;n++){var o=e[n].d;e[n].d=t,a+=i-(1<<r-o)}for(a>>>=r-t;a>0;)(o=e[n].d)<t?(e[n].d++,a-=1<<t-o-1):n++;for(;n>=0;n--)e[n].d==t&&a<0&&(e[n].d--,a++)},v.F._goodIndex=function(e,t){var r=0;return t[16|r]<=e&&(r|=16),t[8|r]<=e&&(r|=8),t[4|r]<=e&&(r|=4),t[2|r]<=e&&(r|=2),t[1|r]<=e&&(r|=1),r},v.F._writeLit=function(e,t,r,n){return v.F._putsF(r,n,t[e<<1]),n+t[1+(e<<1)]},v.F.inflate=function(e,t){var r=Uint8Array;if(3==e[0]&&0==e[1])return t||new r(0);var n=v.F,i=n._bitsF,a=n._bitsE,o=n._decodeTiny,s=n.makeCodes,l=n.codes2map,c=n._get17,f=n.U,u=null==t;u&&(t=new r(e.length>>>2<<3));for(var d,h,g=0,m=0,b=0,p=0,w=0,y=0,A=0,x=0,F=0;0==g;)if(g=i(e,F,1),m=i(e,F+1,2),F+=3,0!=m){if(u&&(t=v.F._check(t,x+(1<<17))),1==m&&(d=f.flmap,h=f.fdmap,y=511,A=31),2==m){b=a(e,F,5)+257,p=a(e,F+5,5)+1,w=a(e,F+10,4)+4,F+=14;for(var U=0;U<38;U+=2)f.itree[U]=0,f.itree[U+1]=0;var _=1;for(U=0;U<w;U++){var j=a(e,F+3*U,3);f.itree[1+(f.ordr[U]<<1)]=j,j>_&&(_=j)}F+=3*w,s(f.itree,_),l(f.itree,_,f.imap),d=f.lmap,h=f.dmap,F=o(f.imap,(1<<_)-1,b+p,e,F,f.ttree);var E=n._copyOut(f.ttree,0,b,f.ltree);y=(1<<E)-1;var I=n._copyOut(f.ttree,b,p,f.dtree);A=(1<<I)-1,s(f.ltree,E),l(f.ltree,E,d),s(f.dtree,I),l(f.dtree,I,h)}for(;;){var C=d[c(e,F)&y];F+=15&C;var M=C>>>4;if(M>>>8==0)t[x++]=M;else{if(256==M)break;var S=x+M-254;if(M>264){var N=f.ldef[M-257];S=x+(N>>>3)+a(e,F,7&N),F+=7&N}var D=h[c(e,F)&A];F+=15&D;var B=D>>>4,R=f.ddef[B],T=(R>>>4)+i(e,F,15&R);for(F+=15&R,u&&(t=v.F._check(t,x+(1<<17)));x<S;)t[x]=t[x++-T],t[x]=t[x++-T],t[x]=t[x++-T],t[x]=t[x++-T];x=S}}}else{7&F&&(F+=8-(7&F));var k=4+(F>>>3),P=e[k-4]|e[k-3]<<8;u&&(t=v.F._check(t,x+P)),t.set(new r(e.buffer,e.byteOffset+k,P),x),F=k+P<<3,x+=P}return t.length==x?t:t.slice(0,x)},v.F._check=function(e,t){var r=e.length;if(t<=r)return e;var n=new Uint8Array(Math.max(r<<1,t));return n.set(e,0),n},v.F._decodeTiny=function(e,t,r,n,i,a){for(var o=v.F._bitsE,s=v.F._get17,l=0;l<r;){var c=e[s(n,i)&t];i+=15&c;var f=c>>>4;if(f<=15)a[l]=f,l++;else{var u=0,d=0;16==f?(d=3+o(n,i,2),i+=2,u=a[l-1]):17==f?(d=3+o(n,i,3),i+=3):18==f&&(d=11+o(n,i,7),i+=7);for(var h=l+d;l<h;)a[l]=u,l++}}return i},v.F._copyOut=function(e,t,r,n){for(var i=0,a=0,o=n.length>>>1;a<r;){var s=e[a+t];n[a<<1]=0,n[1+(a<<1)]=s,s>i&&(i=s),a++}for(;a<o;)n[a<<1]=0,n[1+(a<<1)]=0,a++;return i},v.F.makeCodes=function(e,t){for(var r,n,i,a,o=v.F.U,s=e.length,l=o.bl_count,c=0;c<=t;c++)l[c]=0;for(c=1;c<s;c+=2)l[e[c]]++;var f=o.next_code;for(r=0,l[0]=0,n=1;n<=t;n++)r=r+l[n-1]<<1,f[n]=r;for(i=0;i<s;i+=2)0!=(a=e[i+1])&&(e[i]=f[a],f[a]++)},v.F.codes2map=function(e,t,r){for(var n=e.length,i=v.F.U.rev15,a=0;a<n;a+=2)if(0!=e[a+1])for(var o=a>>1,s=e[a+1],l=o<<4|s,c=t-s,f=e[a]<<c,u=f+(1<<c);f!=u;)r[i[f]>>>15-t]=l,f++},v.F.revCodes=function(e,t){for(var r=v.F.U.rev15,n=15-t,i=0;i<e.length;i+=2){var a=e[i]<<t-e[i+1];e[i]=r[a]>>>n}},v.F._putsE=function(e,t,r){r<<=7&t;var n=t>>>3;e[n]|=r,e[n+1]|=r>>>8},v.F._putsF=function(e,t,r){r<<=7&t;var n=t>>>3;e[n]|=r,e[n+1]|=r>>>8,e[n+2]|=r>>>16},v.F._bitsE=function(e,t,r){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<r)-1},v.F._bitsF=function(e,t,r){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<r)-1},v.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},v.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},v.F.U=(b=Uint16Array,p=Uint32Array,{next_code:new b(16),bl_count:new b(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new b(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new p(32),flmap:new b(512),fltree:[],fdmap:new b(32),fdtree:[],lmap:new b(32768),ltree:[],ttree:[],dmap:new b(32768),dtree:[],imap:new b(512),itree:[],rev15:new b(32768),lhst:new p(286),dhst:new p(30),ihst:new p(19),lits:new p(15e3),strt:new b(65536),prev:new b(32768)}),function(){for(var e=v.F.U,t=0;t<32768;t++){var r=t;r=(4278255360&(r=(4042322160&(r=(3435973836&(r=(2863311530&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8,e.rev15[t]=(r>>>16|r<<16)>>>17}function n(e,t,r){for(;0!=t--;)e.push(0,r)}for(t=0;t<32;t++)e.ldef[t]=e.of0[t]<<3|e.exb[t],e.ddef[t]=e.df0[t]<<4|e.dxb[t];n(e.fltree,144,8),n(e.fltree,112,9),n(e.fltree,24,7),n(e.fltree,8,8),v.F.makeCodes(e.fltree,9),v.F.codes2map(e.fltree,9,e.flmap),v.F.revCodes(e.fltree,9),n(e.fdtree,32,5),v.F.makeCodes(e.fdtree,5),v.F.codes2map(e.fdtree,5,e.fdmap),v.F.revCodes(e.fdtree,5),n(e.itree,19,0),n(e.ltree,286,0),n(e.dtree,30,0),n(e.ttree,320,0)}();var A,x=(A={__proto__:null,default:w},[w].forEach((function(e){e&&"string"!=typeof e&&!Array.isArray(e)&&Object.keys(e).forEach((function(t){if("default"!==t&&!(t in A)){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(A,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}}))})),Object.freeze(A));const F=function(){var e={nextZero(e,t){for(;0!=e[t];)t++;return t},readUshort:(e,t)=>e[t]<<8|e[t+1],writeUshort(e,t,r){e[t]=r>>8&255,e[t+1]=255&r},readUint:(e,t)=>16777216*e[t]+(e[t+1]<<16|e[t+2]<<8|e[t+3]),writeUint(e,t,r){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},readASCII(e,t,r){let n="";for(let i=0;i<r;i++)n+=String.fromCharCode(e[t+i]);return n},writeASCII(e,t,r){for(let n=0;n<r.length;n++)e[t+n]=r.charCodeAt(n)},readBytes(e,t,r){const n=[];for(let i=0;i<r;i++)n.push(e[t+i]);return n},pad:e=>e.length<2?`0${e}`:e,readUTF8(t,r,n){let i,a="";for(let s=0;s<n;s++)a+=`%${e.pad(t[r+s].toString(16))}`;try{i=decodeURIComponent(a)}catch(o){return e.readASCII(t,r,n)}return i}};function t(t,r,n,i){const o=r*n,s=a(i),l=Math.ceil(r*s/8),c=new Uint8Array(4*o),f=new Uint32Array(c.buffer),{ctype:u}=i,{depth:d}=i,h=e.readUshort;if(6==u){const e=o<<2;if(8==d)for(var g=0;g<e;g+=4)c[g]=t[g],c[g+1]=t[g+1],c[g+2]=t[g+2],c[g+3]=t[g+3];if(16==d)for(g=0;g<e;g++)c[g]=t[g<<1]}else if(2==u){const e=i.tabs.tRNS;if(null==e){if(8==d)for(g=0;g<o;g++){var m=3*g;f[g]=255<<24|t[m+2]<<16|t[m+1]<<8|t[m]}if(16==d)for(g=0;g<o;g++)m=6*g,f[g]=255<<24|t[m+4]<<16|t[m+2]<<8|t[m]}else{var b=e[0];const r=e[1],n=e[2];if(8==d)for(g=0;g<o;g++){var p=g<<2;m=3*g,f[g]=255<<24|t[m+2]<<16|t[m+1]<<8|t[m],t[m]==b&&t[m+1]==r&&t[m+2]==n&&(c[p+3]=0)}if(16==d)for(g=0;g<o;g++)p=g<<2,m=6*g,f[g]=255<<24|t[m+4]<<16|t[m+2]<<8|t[m],h(t,m)==b&&h(t,m+2)==r&&h(t,m+4)==n&&(c[p+3]=0)}}else if(3==u){const e=i.tabs.PLTE,a=i.tabs.tRNS,s=a?a.length:0;if(1==d)for(var v=0;v<n;v++){var w=v*l,y=v*r;for(g=0;g<r;g++){p=y+g<<2;var A=3*(x=t[w+(g>>3)]>>7-(7&g)&1);c[p]=e[A],c[p+1]=e[A+1],c[p+2]=e[A+2],c[p+3]=x<s?a[x]:255}}if(2==d)for(v=0;v<n;v++)for(w=v*l,y=v*r,g=0;g<r;g++)p=y+g<<2,A=3*(x=t[w+(g>>2)]>>6-((3&g)<<1)&3),c[p]=e[A],c[p+1]=e[A+1],c[p+2]=e[A+2],c[p+3]=x<s?a[x]:255;if(4==d)for(v=0;v<n;v++)for(w=v*l,y=v*r,g=0;g<r;g++)p=y+g<<2,A=3*(x=t[w+(g>>1)]>>4-((1&g)<<2)&15),c[p]=e[A],c[p+1]=e[A+1],c[p+2]=e[A+2],c[p+3]=x<s?a[x]:255;if(8==d)for(g=0;g<o;g++){var x;p=g<<2,A=3*(x=t[g]),c[p]=e[A],c[p+1]=e[A+1],c[p+2]=e[A+2],c[p+3]=x<s?a[x]:255}}else if(4==u){if(8==d)for(g=0;g<o;g++){p=g<<2;var F=t[U=g<<1];c[p]=F,c[p+1]=F,c[p+2]=F,c[p+3]=t[U+1]}if(16==d)for(g=0;g<o;g++){var U;p=g<<2,F=t[U=g<<2],c[p]=F,c[p+1]=F,c[p+2]=F,c[p+3]=t[U+2]}}else if(0==u)for(b=i.tabs.tRNS?i.tabs.tRNS:-1,v=0;v<n;v++){const e=v*l,n=v*r;if(1==d)for(var _=0;_<r;_++){var j=(F=255*(t[e+(_>>>3)]>>>7-(7&_)&1))==255*b?0:255;f[n+_]=j<<24|F<<16|F<<8|F}else if(2==d)for(_=0;_<r;_++)j=(F=85*(t[e+(_>>>2)]>>>6-((3&_)<<1)&3))==85*b?0:255,f[n+_]=j<<24|F<<16|F<<8|F;else if(4==d)for(_=0;_<r;_++)j=(F=17*(t[e+(_>>>1)]>>>4-((1&_)<<2)&15))==17*b?0:255,f[n+_]=j<<24|F<<16|F<<8|F;else if(8==d)for(_=0;_<r;_++)j=(F=t[e+_])==b?0:255,f[n+_]=j<<24|F<<16|F<<8|F;else if(16==d)for(_=0;_<r;_++)F=t[e+(_<<1)],j=h(t,e+(_<<1))==b?0:255,f[n+_]=j<<24|F<<16|F<<8|F}return c}function r(e,t,r,s){const l=a(e),c=Math.ceil(r*l/8),f=new Uint8Array((c+1+e.interlace)*s);return t=e.tabs.CgBI?i(t,f):n(t,f),0==e.interlace?t=o(t,e,0,r,s):1==e.interlace&&(t=function(e,t){const r=t.width,n=t.height,i=a(t),s=i>>3,l=Math.ceil(r*i/8),c=new Uint8Array(n*l);let f=0;const u=[0,0,4,0,2,0,1],d=[0,4,0,2,0,1,0],h=[8,8,8,4,4,2,2],g=[8,8,4,4,2,2,1];let m=0;for(;m<7;){const a=h[m],p=g[m];let v=0,w=0,y=u[m];for(;y<n;)y+=a,w++;let A=d[m];for(;A<r;)A+=p,v++;const x=Math.ceil(v*i/8);o(e,t,f,v,w);let F=0,U=u[m];for(;U<n;){let t=d[m],n=f+F*x<<3;for(;t<r;){var b;if(1==i&&(b=(b=e[n>>3])>>7-(7&n)&1,c[U*l+(t>>3)]|=b<<7-(7&t)),2==i&&(b=(b=e[n>>3])>>6-(7&n)&3,c[U*l+(t>>2)]|=b<<6-((3&t)<<1)),4==i&&(b=(b=e[n>>3])>>4-(7&n)&15,c[U*l+(t>>1)]|=b<<4-((1&t)<<2)),i>=8){const r=U*l+t*s;for(let t=0;t<s;t++)c[r+t]=e[(n>>3)+t]}n+=i,t+=p}F++,U+=a}v*w!=0&&(f+=w*(1+x)),m+=1}return c}(t,e)),t}function n(e,t){return i(new Uint8Array(e.buffer,2,e.length-6),t)}var i=function(){const e={H:{}};return e.H.N=function(t,r){const n=Uint8Array;let i,a,o=0,s=0,l=0,c=0,f=0,u=0,d=0,h=0,g=0;if(3==t[0]&&0==t[1])return r||new n(0);const m=e.H,b=m.b,p=m.e,v=m.R,w=m.n,y=m.A,A=m.Z,x=m.m,F=null==r;for(F&&(r=new n(t.length>>>2<<5));0==o;)if(o=b(t,g,1),s=b(t,g+1,2),g+=3,0!=s){if(F&&(r=e.H.W(r,h+(1<<17))),1==s&&(i=x.J,a=x.h,u=511,d=31),2==s){l=p(t,g,5)+257,c=p(t,g+5,5)+1,f=p(t,g+10,4)+4,g+=14;let e=1;for(var U=0;U<38;U+=2)x.Q[U]=0,x.Q[U+1]=0;for(U=0;U<f;U++){const r=p(t,g+3*U,3);x.Q[1+(x.X[U]<<1)]=r,r>e&&(e=r)}g+=3*f,w(x.Q,e),y(x.Q,e,x.u),i=x.w,a=x.d,g=v(x.u,(1<<e)-1,l+c,t,g,x.v);const r=m.V(x.v,0,l,x.C);u=(1<<r)-1;const n=m.V(x.v,l,c,x.D);d=(1<<n)-1,w(x.C,r),y(x.C,r,i),w(x.D,n),y(x.D,n,a)}for(;;){const e=i[A(t,g)&u];g+=15&e;const n=e>>>4;if(n>>>8==0)r[h++]=n;else{if(256==n)break;{let e=h+n-254;if(n>264){const r=x.q[n-257];e=h+(r>>>3)+p(t,g,7&r),g+=7&r}const i=a[A(t,g)&d];g+=15&i;const o=i>>>4,s=x.c[o],l=(s>>>4)+b(t,g,15&s);for(g+=15&s;h<e;)r[h]=r[h++-l],r[h]=r[h++-l],r[h]=r[h++-l],r[h]=r[h++-l];h=e}}}}else{7&g&&(g+=8-(7&g));const i=4+(g>>>3),a=t[i-4]|t[i-3]<<8;F&&(r=e.H.W(r,h+a)),r.set(new n(t.buffer,t.byteOffset+i,a),h),g=i+a<<3,h+=a}return r.length==h?r:r.slice(0,h)},e.H.W=function(e,t){const r=e.length;if(t<=r)return e;const n=new Uint8Array(r<<1);return n.set(e,0),n},e.H.R=function(t,r,n,i,a,o){const s=e.H.e,l=e.H.Z;let c=0;for(;c<n;){const e=t[l(i,a)&r];a+=15&e;const n=e>>>4;if(n<=15)o[c]=n,c++;else{let e=0,t=0;16==n?(t=3+s(i,a,2),a+=2,e=o[c-1]):17==n?(t=3+s(i,a,3),a+=3):18==n&&(t=11+s(i,a,7),a+=7);const r=c+t;for(;c<r;)o[c]=e,c++}}return a},e.H.V=function(e,t,r,n){let i=0,a=0;const o=n.length>>>1;for(;a<r;){const r=e[a+t];n[a<<1]=0,n[1+(a<<1)]=r,r>i&&(i=r),a++}for(;a<o;)n[a<<1]=0,n[1+(a<<1)]=0,a++;return i},e.H.n=function(t,r){const n=e.H.m,i=t.length;let a,o,s,l;const c=n.j;for(var f=0;f<=r;f++)c[f]=0;for(f=1;f<i;f+=2)c[t[f]]++;const u=n.K;for(a=0,c[0]=0,o=1;o<=r;o++)a=a+c[o-1]<<1,u[o]=a;for(s=0;s<i;s+=2)l=t[s+1],0!=l&&(t[s]=u[l],u[l]++)},e.H.A=function(t,r,n){const i=t.length,a=e.H.m.r;for(let e=0;e<i;e+=2)if(0!=t[e+1]){const i=e>>1,o=t[e+1],s=i<<4|o,l=r-o;let c=t[e]<<l;const f=c+(1<<l);for(;c!=f;)n[a[c]>>>15-r]=s,c++}},e.H.l=function(t,r){const n=e.H.m.r,i=15-r;for(let e=0;e<t.length;e+=2){const a=t[e]<<r-t[e+1];t[e]=n[a]>>>i}},e.H.M=function(e,t,r){r<<=7&t;const n=t>>>3;e[n]|=r,e[n+1]|=r>>>8},e.H.I=function(e,t,r){r<<=7&t;const n=t>>>3;e[n]|=r,e[n+1]|=r>>>8,e[n+2]|=r>>>16},e.H.e=function(e,t,r){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<r)-1},e.H.b=function(e,t,r){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<r)-1},e.H.Z=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},e.H.i=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},e.H.m=function(){const e=Uint16Array,t=Uint32Array;return{K:new e(16),j:new e(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new e(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new t(32),J:new e(512),_:[],h:new e(32),$:[],w:new e(32768),C:[],v:[],d:new e(32768),D:[],u:new e(512),Q:[],r:new e(32768),s:new t(286),Y:new t(30),a:new t(19),t:new t(15e3),k:new e(65536),g:new e(32768)}}(),function(){const t=e.H.m;for(var r=0;r<32768;r++){let e=r;e=(2863311530&e)>>>1|(1431655765&e)<<1,e=(3435973836&e)>>>2|(858993459&e)<<2,e=(4042322160&e)>>>4|(252645135&e)<<4,e=(4278255360&e)>>>8|(16711935&e)<<8,t.r[r]=(e>>>16|e<<16)>>>17}function n(e,t,r){for(;0!=t--;)e.push(0,r)}for(r=0;r<32;r++)t.q[r]=t.S[r]<<3|t.T[r],t.c[r]=t.p[r]<<4|t.z[r];n(t._,144,8),n(t._,112,9),n(t._,24,7),n(t._,8,8),e.H.n(t._,9),e.H.A(t._,9,t.J),e.H.l(t._,9),n(t.$,32,5),e.H.n(t.$,5),e.H.A(t.$,5,t.h),e.H.l(t.$,5),n(t.Q,19,0),n(t.C,286,0),n(t.D,30,0),n(t.v,320,0)}(),e.H.N}();function a(e){return[1,null,3,1,2,null,4][e.ctype]*e.depth}function o(e,t,r,n,i){let o=a(t);const l=Math.ceil(n*o/8);let c,f;o=Math.ceil(o/8);let u=e[r],d=0;if(u>1&&(e[r]=[0,0,1][u-2]),3==u)for(d=o;d<l;d++)e[d+1]=e[d+1]+(e[d+1-o]>>>1)&255;for(let a=0;a<i;a++)if(c=r+a*l,f=c+a+1,u=e[f-1],d=0,0==u)for(;d<l;d++)e[c+d]=e[f+d];else if(1==u){for(;d<o;d++)e[c+d]=e[f+d];for(;d<l;d++)e[c+d]=e[f+d]+e[c+d-o]}else if(2==u)for(;d<l;d++)e[c+d]=e[f+d]+e[c+d-l];else if(3==u){for(;d<o;d++)e[c+d]=e[f+d]+(e[c+d-l]>>>1);for(;d<l;d++)e[c+d]=e[f+d]+(e[c+d-l]+e[c+d-o]>>>1)}else{for(;d<o;d++)e[c+d]=e[f+d]+s(0,e[c+d-l],0);for(;d<l;d++)e[c+d]=e[f+d]+s(e[c+d-o],e[c+d-l],e[c+d-o-l])}return e}function s(e,t,r){const n=e+t-r,i=n-e,a=n-t,o=n-r;return i*i<=a*a&&i*i<=o*o?e:a*a<=o*o?t:r}function l(t,r,n){n.width=e.readUint(t,r),r+=4,n.height=e.readUint(t,r),r+=4,n.depth=t[r],r++,n.ctype=t[r],r++,n.compress=t[r],r++,n.filter=t[r],r++,n.interlace=t[r],r++}function c(e,t,r,n,i,a,o,s,l){const c=Math.min(t,i),f=Math.min(r,a);let u=0,d=0;for(let A=0;A<f;A++)for(let r=0;r<c;r++)if(o>=0&&s>=0?(u=A*t+r<<2,d=(s+A)*i+o+r<<2):(u=(-s+A)*t-o+r<<2,d=A*i+r<<2),0==l)n[d]=e[u],n[d+1]=e[u+1],n[d+2]=e[u+2],n[d+3]=e[u+3];else if(1==l){var h=e[u+3]*(1/255),g=e[u]*h,m=e[u+1]*h,b=e[u+2]*h,p=n[d+3]*(1/255),v=n[d]*p,w=n[d+1]*p,y=n[d+2]*p;const t=1-h,r=h+p*t,i=0==r?0:1/r;n[d+3]=255*r,n[d+0]=(g+v*t)*i,n[d+1]=(m+w*t)*i,n[d+2]=(b+y*t)*i}else if(2==l)h=e[u+3],g=e[u],m=e[u+1],b=e[u+2],p=n[d+3],v=n[d],w=n[d+1],y=n[d+2],h==p&&g==v&&m==w&&b==y?(n[d]=0,n[d+1]=0,n[d+2]=0,n[d+3]=0):(n[d]=g,n[d+1]=m,n[d+2]=b,n[d+3]=h);else if(3==l){if(h=e[u+3],g=e[u],m=e[u+1],b=e[u+2],p=n[d+3],v=n[d],w=n[d+1],y=n[d+2],h==p&&g==v&&m==w&&b==y)continue;if(h<220&&p>20)return!1}return!0}return{decode:function(t){const a=new Uint8Array(t);let o=8;const s=e,c=s.readUshort,f=s.readUint,u={tabs:{},frames:[]},d=new Uint8Array(a.length);let h,g=0,m=0;const b=[137,80,78,71,13,10,26,10];for(var p=0;p<8;p++)if(a[p]!=b[p])throw"The input is not a PNG file!";for(;o<a.length;){const e=s.readUint(a,o);o+=4;const t=s.readASCII(a,o,4);if(o+=4,"IHDR"==t)l(a,o,u);else if("iCCP"==t){for(var v=o;0!=a[v];)v++;s.readASCII(a,o,v-o),a[v+1];const r=a.slice(v+2,o+e);let l=null;try{l=n(r)}catch(_){l=i(r)}u.tabs[t]=l}else if("CgBI"==t)u.tabs[t]=a.slice(o,o+4);else if("IDAT"==t){for(p=0;p<e;p++)d[g+p]=a[o+p];g+=e}else if("acTL"==t)u.tabs[t]={num_frames:f(a,o),num_plays:f(a,o+4)},h=new Uint8Array(a.length);else if("fcTL"==t){0!=m&&((U=u.frames[u.frames.length-1]).data=r(u,h.slice(0,m),U.rect.width,U.rect.height),m=0);const e={x:f(a,o+12),y:f(a,o+16),width:f(a,o+4),height:f(a,o+8)};let t=c(a,o+22);t=c(a,o+20)/(0==t?100:t);const n={rect:e,delay:Math.round(1e3*t),dispose:a[o+24],blend:a[o+25]};u.frames.push(n)}else if("fdAT"==t){for(p=0;p<e-4;p++)h[m+p]=a[o+p+4];m+=e-4}else if("pHYs"==t)u.tabs[t]=[s.readUint(a,o),s.readUint(a,o+4),a[o+8]];else if("cHRM"==t)for(u.tabs[t]=[],p=0;p<8;p++)u.tabs[t].push(s.readUint(a,o+4*p));else if("tEXt"==t||"zTXt"==t){null==u.tabs[t]&&(u.tabs[t]={});var w=s.nextZero(a,o),y=s.readASCII(a,o,w-o),A=o+e-w-1;if("tEXt"==t)F=s.readASCII(a,w+1,A);else{var x=n(a.slice(w+2,w+2+A));F=s.readUTF8(x,0,x.length)}u.tabs[t][y]=F}else if("iTXt"==t){null==u.tabs[t]&&(u.tabs[t]={}),w=0,v=o,w=s.nextZero(a,v),y=s.readASCII(a,v,w-v);const r=a[v=w+1];var F;a[v+1],v+=2,w=s.nextZero(a,v),s.readASCII(a,v,w-v),v=w+1,w=s.nextZero(a,v),s.readUTF8(a,v,w-v),A=e-((v=w+1)-o),0==r?F=s.readUTF8(a,v,A):(x=n(a.slice(v,v+A)),F=s.readUTF8(x,0,x.length)),u.tabs[t][y]=F}else if("PLTE"==t)u.tabs[t]=s.readBytes(a,o,e);else if("hIST"==t){const e=u.tabs.PLTE.length/3;for(u.tabs[t]=[],p=0;p<e;p++)u.tabs[t].push(c(a,o+2*p))}else if("tRNS"==t)3==u.ctype?u.tabs[t]=s.readBytes(a,o,e):0==u.ctype?u.tabs[t]=c(a,o):2==u.ctype&&(u.tabs[t]=[c(a,o),c(a,o+2),c(a,o+4)]);else if("gAMA"==t)u.tabs[t]=s.readUint(a,o)/1e5;else if("sRGB"==t)u.tabs[t]=a[o];else if("bKGD"==t)0==u.ctype||4==u.ctype?u.tabs[t]=[c(a,o)]:2==u.ctype||6==u.ctype?u.tabs[t]=[c(a,o),c(a,o+2),c(a,o+4)]:3==u.ctype&&(u.tabs[t]=a[o]);else if("IEND"==t)break;o+=e,s.readUint(a,o),o+=4}var U;return 0!=m&&((U=u.frames[u.frames.length-1]).data=r(u,h.slice(0,m),U.rect.width,U.rect.height)),u.data=r(u,d,u.width,u.height),delete u.compress,delete u.interlace,delete u.filter,u},toRGBA8:function(e){const r=e.width,n=e.height;if(null==e.tabs.acTL)return[t(e.data,r,n,e).buffer];const i=[];null==e.frames[0].data&&(e.frames[0].data=e.data);const a=r*n*4,o=new Uint8Array(a),s=new Uint8Array(a),l=new Uint8Array(a);for(let u=0;u<e.frames.length;u++){const d=e.frames[u],h=d.rect.x,g=d.rect.y,m=d.rect.width,b=d.rect.height,p=t(d.data,m,b,e);if(0!=u)for(var f=0;f<a;f++)l[f]=o[f];if(0==d.blend?c(p,m,b,o,r,n,h,g,0):1==d.blend&&c(p,m,b,o,r,n,h,g,1),i.push(o.buffer.slice(0)),0==d.dispose);else if(1==d.dispose)c(s,m,b,o,r,n,h,g,0);else if(2==d.dispose)for(f=0;f<a;f++)o[f]=l[f]}return i},_paeth:s,_copyTile:c,_bin:e}}();!function(){const{_copyTile:e}=F,{_bin:t}=F,r=F._paeth;var n={table:function(){const e=new Uint32Array(256);for(let t=0;t<256;t++){let r=t;for(let e=0;e<8;e++)1&r?r=3988292384^r>>>1:r>>>=1;e[t]=r}return e}(),update(e,t,r,i){for(let a=0;a<i;a++)e=n.table[255&(e^t[r+a])]^e>>>8;return e},crc:(e,t,r)=>4294967295^n.update(4294967295,e,t,r)};function i(e,t,r,n){t[r]+=e[0]*n>>4,t[r+1]+=e[1]*n>>4,t[r+2]+=e[2]*n>>4,t[r+3]+=e[3]*n>>4}function a(e){return Math.max(0,Math.min(255,e))}function o(e,t){const r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return r*r+n*n+i*i+a*a}function s(e,t,r,n,s,l,c){null==c&&(c=1);const f=n.length,u=[];for(var d=0;d<f;d++){const e=n[d];u.push([e>>>0&255,e>>>8&255,e>>>16&255,e>>>24&255])}for(d=0;d<f;d++){let e=4294967295;for(var h=0,g=0;g<f;g++){var m=o(u[d],u[g]);g!=d&&m<e&&(e=m,h=g)}}const b=new Uint32Array(s.buffer),p=new Int16Array(t*r*4),v=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(d=0;d<v.length;d++)v[d]=255*((v[d]+.5)/16-.5);for(let y=0;y<r;y++)for(let s=0;s<t;s++){var w;d=4*(y*t+s),2!=c?w=[a(e[d]+p[d]),a(e[d+1]+p[d+1]),a(e[d+2]+p[d+2]),a(e[d+3]+p[d+3])]:(m=v[4*(3&y)+(3&s)],w=[a(e[d]+m),a(e[d+1]+m),a(e[d+2]+m),a(e[d+3]+m)]),h=0;let A=16777215;for(g=0;g<f;g++){const e=o(w,u[g]);e<A&&(A=e,h=g)}const x=u[h],F=[w[0]-x[0],w[1]-x[1],w[2]-x[2],w[3]-x[3]];1==c&&(s!=t-1&&i(F,p,d+4,7),y!=r-1&&(0!=s&&i(F,p,d+4*t-4,3),i(F,p,d+4*t,5),s!=t-1&&i(F,p,d+4*t+4,1))),l[d>>2]=h,b[d>>2]=n[h]}}function l(e,r,i,a,o){null==o&&(o={});const{crc:s}=n,l=t.writeUint,c=t.writeUshort,f=t.writeASCII;let u=8;const d=e.frames.length>1;let h,g=!1,m=33+(d?20:0);if(null!=o.sRGB&&(m+=13),null!=o.pHYs&&(m+=21),null!=o.iCCP&&(h=pako.deflate(o.iCCP),m+=21+h.length+4),3==e.ctype){for(var b=e.plte.length,p=0;p<b;p++)e.plte[p]>>>24!=255&&(g=!0);m+=8+3*b+4+(g?8+1*b+4:0)}for(var v=0;v<e.frames.length;v++)d&&(m+=38),m+=(x=e.frames[v]).cimg.length+12,0!=v&&(m+=4);m+=12;const w=new Uint8Array(m),y=[137,80,78,71,13,10,26,10];for(p=0;p<8;p++)w[p]=y[p];if(l(w,u,13),u+=4,f(w,u,"IHDR"),u+=4,l(w,u,r),u+=4,l(w,u,i),u+=4,w[u]=e.depth,u++,w[u]=e.ctype,u++,w[u]=0,u++,w[u]=0,u++,w[u]=0,u++,l(w,u,s(w,u-17,17)),u+=4,null!=o.sRGB&&(l(w,u,1),u+=4,f(w,u,"sRGB"),u+=4,w[u]=o.sRGB,u++,l(w,u,s(w,u-5,5)),u+=4),null!=o.iCCP){const e=13+h.length;l(w,u,e),u+=4,f(w,u,"iCCP"),u+=4,f(w,u,"ICC profile"),u+=11,u+=2,w.set(h,u),u+=h.length,l(w,u,s(w,u-(e+4),e+4)),u+=4}if(null!=o.pHYs&&(l(w,u,9),u+=4,f(w,u,"pHYs"),u+=4,l(w,u,o.pHYs[0]),u+=4,l(w,u,o.pHYs[1]),u+=4,w[u]=o.pHYs[2],u++,l(w,u,s(w,u-13,13)),u+=4),d&&(l(w,u,8),u+=4,f(w,u,"acTL"),u+=4,l(w,u,e.frames.length),u+=4,l(w,u,null!=o.loop?o.loop:0),u+=4,l(w,u,s(w,u-12,12)),u+=4),3==e.ctype){for(l(w,u,3*(b=e.plte.length)),u+=4,f(w,u,"PLTE"),u+=4,p=0;p<b;p++){const t=3*p,r=e.plte[p],n=255&r,i=r>>>8&255,a=r>>>16&255;w[u+t+0]=n,w[u+t+1]=i,w[u+t+2]=a}if(u+=3*b,l(w,u,s(w,u-3*b-4,3*b+4)),u+=4,g){for(l(w,u,b),u+=4,f(w,u,"tRNS"),u+=4,p=0;p<b;p++)w[u+p]=e.plte[p]>>>24&255;u+=b,l(w,u,s(w,u-b-4,b+4)),u+=4}}let A=0;for(v=0;v<e.frames.length;v++){var x=e.frames[v];d&&(l(w,u,26),u+=4,f(w,u,"fcTL"),u+=4,l(w,u,A++),u+=4,l(w,u,x.rect.width),u+=4,l(w,u,x.rect.height),u+=4,l(w,u,x.rect.x),u+=4,l(w,u,x.rect.y),u+=4,c(w,u,a[v]),u+=2,c(w,u,1e3),u+=2,w[u]=x.dispose,u++,w[u]=x.blend,u++,l(w,u,s(w,u-30,30)),u+=4);const t=x.cimg;l(w,u,(b=t.length)+(0==v?0:4)),u+=4;const r=u;f(w,u,0==v?"IDAT":"fdAT"),u+=4,0!=v&&(l(w,u,A++),u+=4),w.set(t,u),u+=b,l(w,u,s(w,r,u-r)),u+=4}return l(w,u,0),u+=4,f(w,u,"IEND"),u+=4,l(w,u,s(w,u-4,4)),u+=4,w.buffer}function c(e,t,r){for(let n=0;n<e.frames.length;n++){const i=e.frames[n];i.rect.width;const a=i.rect.height,o=new Uint8Array(a*i.bpl+a);i.cimg=h(i.img,a,i.bpp,i.bpl,o,t,r)}}function f(t,r,n,i,a){const o=a[0],l=a[1],c=a[2],f=a[3],h=a[4],g=a[5];let b=6,p=8,v=255;for(var w=0;w<t.length;w++){const e=new Uint8Array(t[w]);for(var y=e.length,A=0;A<y;A+=4)v&=e[A+3]}const x=255!=v,F=function(t,r,n,i,a,o){const s=[];for(var l=0;l<t.length;l++){const u=new Uint8Array(t[l]),h=new Uint32Array(u.buffer);var c;let m=0,b=0,p=r,v=n,w=i?1:0;if(0!=l){const y=o||i||1==l||0!=s[l-2].dispose?1:2;let A=0,x=1e9;for(let e=0;e<y;e++){var f=new Uint8Array(t[l-1-e]);const i=new Uint32Array(t[l-1-e]);let o=r,s=n,c=-1,u=-1;for(let e=0;e<n;e++)for(let t=0;t<r;t++)h[g=e*r+t]!=i[g]&&(t<o&&(o=t),t>c&&(c=t),e<s&&(s=e),e>u&&(u=e));-1==c&&(o=s=c=u=0),a&&(!(1&~o)&&o--,!(1&~s)&&s--);const d=(c-o+1)*(u-s+1);d<x&&(x=d,A=e,m=o,b=s,p=c-o+1,v=u-s+1)}f=new Uint8Array(t[l-1-A]),1==A&&(s[l-1].dispose=2),c=new Uint8Array(p*v*4),e(f,r,n,c,p,v,-m,-b,0),w=e(u,r,n,c,p,v,-m,-b,3)?1:0,1==w?d(u,r,n,c,{x:m,y:b,width:p,height:v}):e(u,r,n,c,p,v,-m,-b,0)}else c=u.slice(0);s.push({rect:{x:m,y:b,width:p,height:v},img:c,blend:w,dispose:0})}if(i)for(l=0;l<s.length;l++){if(1==(m=s[l]).blend)continue;const e=m.rect,i=s[l-1].rect,o=Math.min(e.x,i.x),c=Math.min(e.y,i.y),f={x:o,y:c,width:Math.max(e.x+e.width,i.x+i.width)-o,height:Math.max(e.y+e.height,i.y+i.height)-c};s[l-1].dispose=1,l-1!=0&&u(t,r,n,s,l-1,f,a),u(t,r,n,s,l,f,a)}let h=0;if(1!=t.length)for(var g=0;g<s.length;g++){var m;h+=(m=s[g]).rect.width*m.rect.height}return s}(t,r,n,o,l,c),U={},_=[],j=[];if(0!=i){const e=[];for(A=0;A<F.length;A++)e.push(F[A].img.buffer);const t=m(function(e){let t=0;for(var r=0;r<e.length;r++)t+=e[r].byteLength;const n=new Uint8Array(t);let i=0;for(r=0;r<e.length;r++){const t=new Uint8Array(e[r]),a=t.length;for(let e=0;e<a;e+=4){let r=t[e],a=t[e+1],o=t[e+2];const s=t[e+3];0==s&&(r=a=o=0),n[i+e]=r,n[i+e+1]=a,n[i+e+2]=o,n[i+e+3]=s}i+=a}return n.buffer}(e),i);for(A=0;A<t.plte.length;A++)_.push(t.plte[A].est.rgba);let r=0;for(A=0;A<F.length;A++){const e=(I=F[A]).img.length;var E=new Uint8Array(t.inds.buffer,r>>2,e>>2);j.push(E);const n=new Uint8Array(t.abuf,r,e);g&&s(I.img,I.rect.width,I.rect.height,_,n,E),I.img.set(n),r+=e}}else for(w=0;w<F.length;w++){var I=F[w];const e=new Uint32Array(I.img.buffer);var C=I.rect.width;for(y=e.length,E=new Uint8Array(y),j.push(E),A=0;A<y;A++){const t=e[A];if(0!=A&&t==e[A-1])E[A]=E[A-1];else if(A>C&&t==e[A-C])E[A]=E[A-C];else{let e=U[t];if(null==e&&(U[t]=e=_.length,_.push(t),_.length>=300))break;E[A]=e}}}const M=_.length;for(M<=256&&0==h&&(p=M<=2?1:M<=4?2:M<=16?4:8,p=Math.max(p,f)),w=0;w<F.length;w++){(I=F[w]).rect.x,I.rect.y,C=I.rect.width;const e=I.rect.height;let t=I.img;new Uint32Array(t.buffer);let r=4*C,n=4;if(M<=256&&0==h){r=Math.ceil(p*C/8);var S=new Uint8Array(r*e);const i=j[w];for(let t=0;t<e;t++){A=t*r;const e=t*C;if(8==p)for(var N=0;N<C;N++)S[A+N]=i[e+N];else if(4==p)for(N=0;N<C;N++)S[A+(N>>1)]|=i[e+N]<<4-4*(1&N);else if(2==p)for(N=0;N<C;N++)S[A+(N>>2)]|=i[e+N]<<6-2*(3&N);else if(1==p)for(N=0;N<C;N++)S[A+(N>>3)]|=i[e+N]<<7-1*(7&N)}t=S,b=3,n=1}else if(0==x&&1==F.length){S=new Uint8Array(C*e*3);const i=C*e;for(A=0;A<i;A++){const e=3*A,r=4*A;S[e]=t[r],S[e+1]=t[r+1],S[e+2]=t[r+2]}t=S,b=2,n=3,r=3*C}I.img=t,I.bpl=r,I.bpp=n}return{ctype:b,depth:p,plte:_,frames:F}}function u(t,r,n,i,a,o,s){const l=Uint8Array,c=Uint32Array,f=new l(t[a-1]),u=new c(t[a-1]),h=a+1<t.length?new l(t[a+1]):null,g=new l(t[a]),m=new c(g.buffer);let b=r,p=n,v=-1,w=-1;for(let e=0;e<o.height;e++)for(let t=0;t<o.width;t++){const n=o.x+t,s=o.y+e,l=s*r+n,c=m[l];0==c||0==i[a-1].dispose&&u[l]==c&&(null==h||0!=h[4*l+3])||(n<b&&(b=n),n>v&&(v=n),s<p&&(p=s),s>w&&(w=s))}-1==v&&(b=p=v=w=0),s&&(!(1&~b)&&b--,!(1&~p)&&p--),o={x:b,y:p,width:v-b+1,height:w-p+1};const y=i[a];y.rect=o,y.blend=1,y.img=new Uint8Array(o.width*o.height*4),0==i[a-1].dispose?(e(f,r,n,y.img,o.width,o.height,-o.x,-o.y,0),d(g,r,n,y.img,o)):e(g,r,n,y.img,o.width,o.height,-o.x,-o.y,0)}function d(t,r,n,i,a){e(t,r,n,i,a.width,a.height,-a.x,-a.y,2)}function h(e,t,r,n,i,a,o){const s=[];let l,c=[0,1,2,3,4];-1!=a?c=[a]:(t*n>5e5||1==r)&&(c=[0]),o&&(l={level:0});const f=x;for(var u=0;u<c.length;u++){for(let a=0;a<t;a++)g(i,e,a,n,r,c[u]);s.push(f.deflate(i,l))}let d,h=1e9;for(u=0;u<s.length;u++)s[u].length<h&&(d=u,h=s[u].length);return s[d]}function g(e,t,n,i,a,o){const s=n*i;let l=s+n;if(e[l]=o,l++,0==o)if(i<500)for(var c=0;c<i;c++)e[l+c]=t[s+c];else e.set(new Uint8Array(t.buffer,s,i),l);else if(1==o){for(c=0;c<a;c++)e[l+c]=t[s+c];for(c=a;c<i;c++)e[l+c]=t[s+c]-t[s+c-a]+256&255}else if(0==n){for(c=0;c<a;c++)e[l+c]=t[s+c];if(2==o)for(c=a;c<i;c++)e[l+c]=t[s+c];if(3==o)for(c=a;c<i;c++)e[l+c]=t[s+c]-(t[s+c-a]>>1)+256&255;if(4==o)for(c=a;c<i;c++)e[l+c]=t[s+c]-r(t[s+c-a],0,0)+256&255}else{if(2==o)for(c=0;c<i;c++)e[l+c]=t[s+c]+256-t[s+c-i]&255;if(3==o){for(c=0;c<a;c++)e[l+c]=t[s+c]+256-(t[s+c-i]>>1)&255;for(c=a;c<i;c++)e[l+c]=t[s+c]+256-(t[s+c-i]+t[s+c-a]>>1)&255}if(4==o){for(c=0;c<a;c++)e[l+c]=t[s+c]+256-r(0,t[s+c-i],0)&255;for(c=a;c<i;c++)e[l+c]=t[s+c]+256-r(t[s+c-a],t[s+c-i],t[s+c-a-i])&255}}}function m(e,t){const r=new Uint8Array(e),n=r.slice(0),i=new Uint32Array(n.buffer),a=b(n,t),o=a[0],s=a[1],l=r.length,c=new Uint8Array(l>>2);let f;if(r.length<2e7)for(var u=0;u<l;u+=4)f=p(o,d=r[u]*(1/255),h=r[u+1]*(1/255),g=r[u+2]*(1/255),m=r[u+3]*(1/255)),c[u>>2]=f.ind,i[u>>2]=f.est.rgba;else for(u=0;u<l;u+=4){var d=r[u]*(1/255),h=r[u+1]*(1/255),g=r[u+2]*(1/255),m=r[u+3]*(1/255);for(f=o;f.left;)f=v(f.est,d,h,g,m)<=0?f.left:f.right;c[u>>2]=f.ind,i[u>>2]=f.est.rgba}return{abuf:n.buffer,inds:c,plte:s}}function b(e,t,r){null==r&&(r=1e-4);const n=new Uint32Array(e.buffer),i={i0:0,i1:e.length,bst:null,est:null,tdst:0,left:null,right:null};i.bst=A(e,i.i0,i.i1),i.est=U(i.bst);const a=[i];for(;a.length<t;){let t=0,i=0;for(var o=0;o<a.length;o++)a[o].est.L>t&&(t=a[o].est.L,i=o);if(t<r)break;const s=a[i],l=w(e,n,s.i0,s.i1,s.est.e,s.est.eMq255);if(s.i0>=l||s.i1<=l){s.est.L=0;continue}const c={i0:s.i0,i1:l,bst:null,est:null,tdst:0,left:null,right:null};c.bst=A(e,c.i0,c.i1),c.est=U(c.bst);const f={i0:l,i1:s.i1,bst:null,est:null,tdst:0,left:null,right:null};for(f.bst={R:[],m:[],N:s.bst.N-c.bst.N},o=0;o<16;o++)f.bst.R[o]=s.bst.R[o]-c.bst.R[o];for(o=0;o<4;o++)f.bst.m[o]=s.bst.m[o]-c.bst.m[o];f.est=U(f.bst),s.left=c,s.right=f,a[i]=c,a.push(f)}for(a.sort(((e,t)=>t.bst.N-e.bst.N)),o=0;o<a.length;o++)a[o].ind=o;return[i,a]}function p(e,t,r,n,i){if(null==e.left)return e.tdst=function(e,t,r,n,i){const a=t-e[0],o=r-e[1],s=n-e[2],l=i-e[3];return a*a+o*o+s*s+l*l}(e.est.q,t,r,n,i),e;const a=v(e.est,t,r,n,i);let o=e.left,s=e.right;a>0&&(o=e.right,s=e.left);const l=p(o,t,r,n,i);if(l.tdst<=a*a)return l;const c=p(s,t,r,n,i);return c.tdst<l.tdst?c:l}function v(e,t,r,n,i){const{e:a}=e;return a[0]*t+a[1]*r+a[2]*n+a[3]*i-e.eMq}function w(e,t,r,n,i,a){for(n-=4;r<n;){for(;y(e,r,i)<=a;)r+=4;for(;y(e,n,i)>a;)n-=4;if(r>=n)break;const o=t[r>>2];t[r>>2]=t[n>>2],t[n>>2]=o,r+=4,n-=4}for(;y(e,r,i)>a;)r-=4;return r+4}function y(e,t,r){return e[t]*r[0]+e[t+1]*r[1]+e[t+2]*r[2]+e[t+3]*r[3]}function A(e,t,r){const n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=[0,0,0,0],a=r-t>>2;for(let o=t;o<r;o+=4){const t=e[o]*(1/255),r=e[o+1]*(1/255),a=e[o+2]*(1/255),s=e[o+3]*(1/255);i[0]+=t,i[1]+=r,i[2]+=a,i[3]+=s,n[0]+=t*t,n[1]+=t*r,n[2]+=t*a,n[3]+=t*s,n[5]+=r*r,n[6]+=r*a,n[7]+=r*s,n[10]+=a*a,n[11]+=a*s,n[15]+=s*s}return n[4]=n[1],n[8]=n[2],n[9]=n[6],n[12]=n[3],n[13]=n[7],n[14]=n[11],{R:n,m:i,N:a}}function U(e){const{R:t}=e,{m:r}=e,{N:n}=e,i=r[0],a=r[1],o=r[2],s=r[3],l=0==n?0:1/n,c=[t[0]-i*i*l,t[1]-i*a*l,t[2]-i*o*l,t[3]-i*s*l,t[4]-a*i*l,t[5]-a*a*l,t[6]-a*o*l,t[7]-a*s*l,t[8]-o*i*l,t[9]-o*a*l,t[10]-o*o*l,t[11]-o*s*l,t[12]-s*i*l,t[13]-s*a*l,t[14]-s*o*l,t[15]-s*s*l],f=c,u=_;let d=[Math.random(),Math.random(),Math.random(),Math.random()],h=0,g=0;if(0!=n)for(let b=0;b<16&&(d=u.multVec(f,d),g=Math.sqrt(u.dot(d,d)),d=u.sml(1/g,d),!(0!=b&&Math.abs(g-h)<1e-9));b++)h=g;const m=[i*l,a*l,o*l,s*l];return{Cov:c,q:m,e:d,L:h,eMq255:u.dot(u.sml(255,m),d),eMq:u.dot(d,m),rgba:(Math.round(255*m[3])<<24|Math.round(255*m[2])<<16|Math.round(255*m[1])<<8|Math.round(255*m[0]))>>>0}}var _={multVec:(e,t)=>[e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],e[4]*t[0]+e[5]*t[1]+e[6]*t[2]+e[7]*t[3],e[8]*t[0]+e[9]*t[1]+e[10]*t[2]+e[11]*t[3],e[12]*t[0]+e[13]*t[1]+e[14]*t[2]+e[15]*t[3]],dot:(e,t)=>e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],sml:(e,t)=>[e*t[0],e*t[1],e*t[2],e*t[3]]};F.encode=function(e,t,r,n,i,a,o){null==n&&(n=0),null==o&&(o=!1);const s=f(e,t,r,n,[!1,!1,!1,0,o,!1]);return c(s,-1),l(s,t,r,i,a)},F.encodeLL=function(e,t,r,n,i,a,o,s){const f={ctype:0+(1==n?0:2)+(0==i?0:4),depth:a,frames:[]},u=(n+i)*a,d=u*t;for(let l=0;l<e.length;l++)f.frames.push({rect:{x:0,y:0,width:t,height:r},img:new Uint8Array(e[l]),blend:0,dispose:1,bpp:Math.ceil(u/8),bpl:Math.ceil(d/8)});return c(f,0,!0),l(f,t,r,o,s)},F.encode.compress=f,F.encode.dither=s,F.quantize=m,F.quantize.getKDtree=b,F.quantize.getNearest=p}();const U={toArrayBuffer(e,t){const r=e.width,n=e.height,i=r<<2,a=e.getContext("2d").getImageData(0,0,r,n),o=new Uint32Array(a.data.buffer),s=(32*r+31)/32<<2,l=s*n,c=122+l,f=new ArrayBuffer(c),u=new DataView(f),d=1<<20;let h,g,m,b,p=d,v=0,w=0,y=0;function A(e){u.setUint16(w,e,!0),w+=2}function x(e){u.setUint32(w,e,!0),w+=4}function F(e){w+=e}A(19778),x(c),F(4),x(122),x(108),x(r),x(-n>>>0),A(1),A(32),x(3),x(l),x(2835),x(2835),F(8),x(16711680),x(65280),x(255),x(4278190080),x(1466527264),function e(){for(;v<n&&p>0;){for(b=122+v*s,h=0;h<i;)p--,g=o[y++],m=g>>>24,u.setUint32(b+h,g<<8|m),h+=4;v++}y<o.length?(p=d,setTimeout(e,U._dly)):t(f)}()},toBlob(e,t){this.toArrayBuffer(e,(e=>{t(new Blob([e],{type:"image/bmp"}))}))},_dly:9};var _={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},j={[_.CHROME]:16384,[_.FIREFOX]:11180,[_.DESKTOP_SAFARI]:16384,[_.IE]:8192,[_.IOS]:4096,[_.ETC]:8192};const E="undefined"!=typeof window,I="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,C=E&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),M=(E||I)&&(C&&C.getOriginalSymbol(window,"File")||"undefined"!=typeof File&&File),S=(E||I)&&(C&&C.getOriginalSymbol(window,"FileReader")||"undefined"!=typeof FileReader&&FileReader);function N(e,t,r=Date.now()){return new Promise((n=>{const i=e.split(","),a=i[0].match(/:(.*?);/)[1],o=globalThis.atob(i[1]);let s=o.length;const l=new Uint8Array(s);for(;s--;)l[s]=o.charCodeAt(s);const c=new Blob([l],{type:a});c.name=t,c.lastModified=r,n(c)}))}function D(e){return new Promise(((t,r)=>{const n=new S;n.onload=()=>t(n.result),n.onerror=e=>r(e),n.readAsDataURL(e)}))}function B(e){return new Promise(((t,r)=>{const n=new Image;n.onload=()=>t(n),n.onerror=e=>r(e),n.src=e}))}function R(){if(void 0!==R.cachedResult)return R.cachedResult;let e=_.ETC;const{userAgent:t}=navigator;return/Chrom(e|ium)/i.test(t)?e=_.CHROME:/iP(ad|od|hone)/i.test(t)&&/WebKit/i.test(t)?e=_.IOS:/Safari/i.test(t)?e=_.DESKTOP_SAFARI:/Firefox/i.test(t)?e=_.FIREFOX:(/MSIE/i.test(t)||1==!!document.documentMode)&&(e=_.IE),R.cachedResult=e,R.cachedResult}function T(e,t){const r=R(),n=j[r];let i=e,a=t,o=i*a;const s=i>a?a/i:i/a;for(;o>n*n;){const e=(n+i)/2,t=(n+a)/2;e<t?(a=t,i=t*s):(a=e*s,i=e),o=i*a}return{width:i,height:a}}function k(e,t){let r,n;try{if(r=new OffscreenCanvas(e,t),n=r.getContext("2d"),null===n)throw new Error("getContext of OffscreenCanvas returns null")}catch(i){r=document.createElement("canvas"),n=r.getContext("2d")}return r.width=e,r.height=t,[r,n]}function P(e,t){const{width:r,height:n}=T(e.width,e.height),[i,a]=k(r,n);return t&&/jpe?g/.test(t)&&(a.fillStyle="white",a.fillRect(0,0,i.width,i.height)),a.drawImage(e,0,0,i.width,i.height),i}function Q(){return void 0!==Q.cachedResult||(Q.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"undefined"!=typeof document&&"ontouchend"in document),Q.cachedResult}function H(e,t={}){return new Promise((function(r,n){let i,a;var o=function(){try{return a=P(i,t.fileType||e.type),r([i,a])}catch(o){return n(o)}},s=function(t){try{var r=function(e){try{throw e}catch(t){return n(t)}};try{let t;return D(e).then((function(e){try{return t=e,B(t).then((function(e){try{return i=e,function(){try{return o()}catch(e){return n(e)}}()}catch(t){return r(t)}}),r)}catch(a){return r(a)}}),r)}catch(a){r(a)}}catch(a){return n(a)}};try{if(Q()||[_.DESKTOP_SAFARI,_.MOBILE_SAFARI].includes(R()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(e).then((function(e){try{return i=e,o()}catch(t){return s()}}),s)}catch(l){s()}}))}function L(e,t,r,n,i=1){return new Promise((function(a,o){let s;if("image/png"===t){let a,o,c;return a=e.getContext("2d"),({data:o}=a.getImageData(0,0,e.width,e.height)),c=F.encode([o.buffer],e.width,e.height,4096*i),s=new Blob([c],{type:t}),s.name=r,s.lastModified=n,l.call(this)}{let a=function(){return l.call(this)};if("image/bmp"===t)return new Promise((t=>U.toBlob(e,t))).then(function(e){try{return s=e,s.name=r,s.lastModified=n,a.call(this)}catch(t){return o(t)}}.bind(this),o);{let l=function(){return a.call(this)};if("function"==typeof OffscreenCanvas&&e instanceof OffscreenCanvas)return e.convertToBlob({type:t,quality:i}).then(function(e){try{return s=e,s.name=r,s.lastModified=n,l.call(this)}catch(t){return o(t)}}.bind(this),o);{let a;return a=e.toDataURL(t,i),N(a,r,n).then(function(e){try{return s=e,l.call(this)}catch(t){return o(t)}}.bind(this),o)}}}function l(){return a(s)}}))}function O(e){e.width=0,e.height=0}function V(){return new Promise((function(e,t){let r,n,i,a;return void 0!==V.cachedResult?e(V.cachedResult):N("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then((function(o){try{return r=o,H(r).then((function(o){try{return n=o[1],L(n,r.type,r.name,r.lastModified).then((function(r){try{return i=r,O(n),H(i).then((function(r){try{return a=r[0],V.cachedResult=1===a.width&&2===a.height,e(V.cachedResult)}catch(n){return t(n)}}),t)}catch(o){return t(o)}}),t)}catch(s){return t(s)}}),t)}catch(s){return t(s)}}),t)}))}function $(e){return new Promise(((t,r)=>{const n=new S;n.onload=e=>{const r=new DataView(e.target.result);if(65496!=r.getUint16(0,!1))return t(-2);const n=r.byteLength;let i=2;for(;i<n;){if(r.getUint16(i+2,!1)<=8)return t(-1);const e=r.getUint16(i,!1);if(i+=2,65505==e){if(1165519206!=r.getUint32(i+=2,!1))return t(-1);const e=18761==r.getUint16(i+=6,!1);i+=r.getUint32(i+4,e);const n=r.getUint16(i,e);i+=2;for(let a=0;a<n;a++)if(274==r.getUint16(i+12*a,e))return t(r.getUint16(i+12*a+8,e))}else{if(65280&~e)break;i+=r.getUint16(i,!1)}}return t(-1)},n.onerror=e=>r(e),n.readAsArrayBuffer(e)}))}function z(e,t){const{width:r}=e,{height:n}=e,{maxWidthOrHeight:i}=t;let a,o=e;return isFinite(i)&&(r>i||n>i)&&([o,a]=k(r,n),r>n?(o.width=i,o.height=n/r*i):(o.width=r/n*i,o.height=i),a.drawImage(e,0,0,o.width,o.height),O(e)),o}function q(e,t){const{width:r}=e,{height:n}=e,[i,a]=k(r,n);switch(t>4&&t<9?(i.width=n,i.height=r):(i.width=r,i.height=n),t){case 2:a.transform(-1,0,0,1,r,0);break;case 3:a.transform(-1,0,0,-1,r,n);break;case 4:a.transform(1,0,0,-1,0,n);break;case 5:a.transform(0,1,1,0,0,0);break;case 6:a.transform(0,1,-1,0,n,0);break;case 7:a.transform(0,-1,-1,0,n,r);break;case 8:a.transform(0,-1,1,0,0,r)}return a.drawImage(e,0,0,r,n),O(e),i}function Y(e,t,r=0){return new Promise((function(n,i){let a,o,s,l,c,f,u,d,h,g,m,b,p,v,w,y,A,x,F,U;function _(e=5){if(t.signal&&t.signal.aborted)throw t.signal.reason;a+=e,t.onProgress(Math.min(a,100))}function j(e){if(t.signal&&t.signal.aborted)throw t.signal.reason;a=Math.min(Math.max(e,a),100),t.onProgress(a)}return a=r,o=t.maxIteration||10,s=1024*t.maxSizeMB*1024,_(),H(e,t).then(function(r){try{return[,l]=r,_(),c=z(l,t),_(),new Promise((function(r,n){var i;if(!(i=t.exifOrientation))return $(e).then(function(e){try{return i=e,a.call(this)}catch(t){return n(t)}}.bind(this),n);function a(){return r(i)}return a.call(this)})).then(function(r){try{return f=r,_(),V().then(function(r){try{return u=r?c:q(c,f),_(),d=t.initialQuality||1,h=t.fileType||e.type,L(u,h,e.name,e.lastModified,d).then(function(r){try{{let f=function(){if(o--&&(w>s||w>p)){let t,r;return t=U?.95*F.width:F.width,r=U?.95*F.height:F.height,[A,x]=k(t,r),x.drawImage(F,0,0,t,r),d*="image/png"===h?.85:.95,L(A,h,e.name,e.lastModified,d).then((function(e){try{return y=e,O(F),F=A,w=y.size,j(Math.min(99,Math.floor((v-w)/(v-s)*100))),f}catch(t){return i(t)}}),i)}return[1]},E=function(){return O(F),O(A),O(c),O(u),O(l),j(100),n(y)};return g=r,_(),m=g.size>s,b=g.size>e.size,m||b?(p=e.size,v=g.size,w=v,F=u,U=!t.alwaysKeepResolution&&m,(a=function(e){for(;e;){if(e.then)return void e.then(a,i);try{if(e.pop){if(e.length)return e.pop()?E.call(this):e;e=f}else e=e.call(this)}catch(t){return i(t)}}}.bind(this))(f)):(j(100),n(g));var a}}catch(f){return i(f)}}.bind(this),i)}catch(a){return i(a)}}.bind(this),i)}catch(a){return i(a)}}.bind(this),i)}catch(a){return i(a)}}.bind(this),i)}))}let W;function G(e,t){return new Promise((function(r,n){let i,a,o,s,l,c;if(i={...t},o=0,({onProgress:s}=i),i.maxSizeMB=i.maxSizeMB||Number.POSITIVE_INFINITY,l="boolean"!=typeof i.useWebWorker||i.useWebWorker,delete i.useWebWorker,i.onProgress=e=>{o=e,"function"==typeof s&&s(o)},!(e instanceof Blob||e instanceof M))return n(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(e.type))return n(new Error("The file given is not an image"));if(c="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,!l||"function"!=typeof Worker||c)return Y(e,i).then(function(e){try{return a=e,d.call(this)}catch(t){return n(t)}}.bind(this),n);var f=function(){try{return d.call(this)}catch(e){return n(e)}}.bind(this),u=function(t){try{return Y(e,i).then((function(e){try{return a=e,f()}catch(t){return n(t)}}),n)}catch(r){return n(r)}};try{return i.libURL=i.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",function(e,t){return new Promise(((r,n)=>{W||(W=function(e){const t=[];return t.push(e),URL.createObjectURL(new Blob(t))}("\nlet scriptImported = false\nself.addEventListener('message', async (e) => {\n  const { file, id, imageCompressionLibUrl, options } = e.data\n  options.onProgress = (progress) => self.postMessage({ progress, id })\n  try {\n    if (!scriptImported) {\n      // console.log('[worker] importScripts', imageCompressionLibUrl)\n      self.importScripts(imageCompressionLibUrl)\n      scriptImported = true\n    }\n    // console.log('[worker] self', self)\n    const compressedFile = await imageCompression(file, options)\n    self.postMessage({ file: compressedFile, id })\n  } catch (e) {\n    // console.error('[worker] error', e)\n    self.postMessage({ error: e.message + '\\n' + e.stack, id })\n  }\n})\n"));const i=new Worker(W);i.addEventListener("message",(function(e){if(t.signal&&t.signal.aborted)i.terminate();else if(void 0===e.data.progress){if(e.data.error)return n(new Error(e.data.error)),void i.terminate();r(e.data.file),i.terminate()}else t.onProgress(e.data.progress)})),i.addEventListener("error",n),t.signal&&t.signal.addEventListener("abort",(()=>{n(t.signal.reason),i.terminate()})),i.postMessage({file:e,imageCompressionLibUrl:t.libURL,options:{...t,onProgress:void 0,signal:void 0}})}))}(e,i).then((function(e){try{return a=e,f()}catch(t){return u()}}),u)}catch(h){u()}function d(){try{a.name=e.name,a.lastModified=e.lastModified}catch(h){}try{i.preserveExif&&"image/jpeg"===e.type&&(!i.fileType||i.fileType&&i.fileType===e.type)&&(a=g(e,a))}catch(h){}return r(a)}}))}function K(){const{user:g}=e(),[m,b]=i.useState(!1),[p,v]=i.useState(""),[w,y]=i.useState(null),[A,x]=i.useState(null),[F,U]=i.useState([]),[_,j]=i.useState(!0),[E,I]=i.useState(null),[C,M]=i.useState(!1),[S,N]=i.useState({name:"",breed:"",birthYear:"",birthMonth:"",birthDay:"",gender:"",rabiesVaccineImage:null,comboVaccineImage:null,rabiesExpiryDate:"",comboExpiryDate:""});i.useEffect((()=>{g&&D()}),[g]);const D=async()=>{try{j(!0);const{data:e,error:r}=await t.from("dogs").select("\n          *,\n          vaccine_certifications(*)\n        ").eq("owner_id",null==g?void 0:g.id).order("created_at",{ascending:!1});if(r)throw r;U(e||[])}catch(e){}finally{j(!1)}},B=(new Date).getFullYear(),R=Array.from({length:21},((e,t)=>{const r=B-t;return{value:r.toString(),label:`${r}年`}})),T=Array.from({length:12},((e,t)=>{const r=t+1;return{value:r.toString().padStart(2,"0"),label:`${r}月`}})),k=()=>{if(!S.birthYear||!S.birthMonth||!S.birthDay)return!1;const e=parseInt(S.birthYear),t=parseInt(S.birthMonth),r=parseInt(S.birthDay),n=new Date(e,t-1,r);if(n>new Date)return!1;const i=new Date;return i.setFullYear(i.getFullYear()-20),!(n<i)},P=l.map((e=>({value:e,label:e})));return r.jsxs("div",{className:"max-w-2xl mx-auto",children:[r.jsx("h1",{className:"text-2xl font-bold text-center mb-8",children:"ワンちゃん登録"}),_?r.jsx("div",{className:"flex justify-center items-center h-16 mb-6",children:r.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})}):F.length>0&&r.jsxs(s,{className:"mb-8",children:[r.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[r.jsx(c,{className:"w-5 h-5 text-blue-600 mr-2"}),"登録済みのワンちゃん"]}),r.jsx("div",{className:"space-y-4",children:F.map((e=>{const t=(e=>{var t;const r=null==(t=e.vaccine_certifications)?void 0:t[0];if(!r)return{status:"none",label:"未提出",color:"text-red-600 bg-red-100"};switch(r.status){case"approved":return{status:"approved",label:"承認済み",color:"text-green-600 bg-green-100"};case"pending":return{status:"pending",label:"承認待ち",color:"text-yellow-600 bg-yellow-100"};case"rejected":return{status:"rejected",label:"却下",color:"text-red-600 bg-red-100"};default:return{status:"none",label:"未提出",color:"text-red-600 bg-red-100"}}})(e),i="オス"===e.gender?"くん":"ちゃん";return r.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden",children:e.image_url?r.jsx("img",{src:e.image_url,alt:e.name,className:"w-full h-full object-cover"}):r.jsx(c,{className:"w-6 h-6 text-gray-500"})}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-semibold",children:[e.name,i]}),r.jsxs("p",{className:"text-sm text-gray-600",children:[e.breed," • ",e.gender]}),r.jsx("div",{className:"flex items-center mt-1",children:r.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full ${t.color}`,children:["ワクチン: ",t.label]})})]})]}),r.jsx(n,{size:"sm",variant:"secondary",onClick:()=>(e=>{var t,r,n,i;I(e);const a=new Date(e.birth_date),o=a.getFullYear().toString(),s=(a.getMonth()+1).toString().padStart(2,"0"),l=a.getDate().toString().padStart(2,"0");N({name:e.name,breed:e.breed,birthYear:o,birthMonth:s,birthDay:l,gender:e.gender,rabiesVaccineImage:null,comboVaccineImage:null,rabiesExpiryDate:(null==(r=null==(t=e.vaccine_certifications)?void 0:t[0])?void 0:r.rabies_expiry_date)||"",comboExpiryDate:(null==(i=null==(n=e.vaccine_certifications)?void 0:n[0])?void 0:i.combo_expiry_date)||""}),x(e.image_url||null),M(!0)})(e),children:r.jsx(f,{className:"w-4 h-4"})})]},e.id)}))})]}),r.jsx(s,{children:r.jsxs("form",{onSubmit:C?async e=>{var r,n,i,a;if(e.preventDefault(),E){b(!0),v("");try{if(!k())return v("正しい生年月日を選択してください。"),void b(!1);const e=`${S.birthYear}-${S.birthMonth}-${S.birthDay}`;let l;if("オス"===S.gender||"male"===S.gender||"male"===S.gender.toLowerCase())l="オス";else{if("メス"!==S.gender&&"female"!==S.gender&&"female"!==S.gender.toLowerCase())return v("性別を正しく選択してください。"),void b(!1);l="メス"}let c=E.image_url;if(w)try{const e=w.name.split(".").pop()||"jpg",r=Date.now(),n=`${E.id}/profile_${r}.${e}`,{error:i}=await t.storage.from("dog-images").upload(n,w,{cacheControl:"3600",upsert:!0});if(i)throw new Error(`画像のアップロードに失敗しました: ${i.message}`);const{data:{publicUrl:a}}=t.storage.from("dog-images").getPublicUrl(n);c=a}catch(o){v("画像のアップロードに失敗しましたが、ワンちゃんの情報は更新されました。")}const{error:f}=await t.from("dogs").update({name:S.name,breed:S.breed,birth_date:e,gender:l,image_url:c}).eq("id",E.id);if(f)throw f;if(S.rabiesVaccineImage||S.comboVaccineImage)try{const{data:e,error:o}=await t.from("vaccine_certifications").select("id").eq("dog_id",E.id).maybeSingle();if(o&&"PGRST116"!==o.code)throw o;let s=(null==(n=null==(r=E.vaccine_certifications)?void 0:r[0])?void 0:n.rabies_vaccine_image)||null,l=(null==(a=null==(i=E.vaccine_certifications)?void 0:i[0])?void 0:a.combo_vaccine_image)||null;if(S.rabiesVaccineImage){const e=S.rabiesVaccineImage.name.split(".").pop()||"jpg",r=Date.now();s=`${E.id}/rabies_${r}.${e}`;const{error:n}=await t.storage.from("vaccine-certs").upload(s,S.rabiesVaccineImage,{cacheControl:"3600",upsert:!0});if(n)throw n}if(S.comboVaccineImage){const e=S.comboVaccineImage.name.split(".").pop()||"jpg",r=Date.now();l=`${E.id}/combo_${r}.${e}`;const{error:n}=await t.storage.from("vaccine-certs").upload(l,S.comboVaccineImage,{cacheControl:"3600",upsert:!0});if(n)throw n}const c={status:"pending"};if(s&&(c.rabies_vaccine_image=s),l&&(c.combo_vaccine_image=l),S.rabiesExpiryDate&&(c.rabies_expiry_date=S.rabiesExpiryDate),S.comboExpiryDate&&(c.combo_expiry_date=S.comboExpiryDate),e){const{error:r}=await t.from("vaccine_certifications").update(c).eq("id",e.id);if(r)throw r}}catch(s){v("ワクチン証明書の更新に失敗しました。後でマイページから再試行してください。")}await D(),N({name:"",breed:"",birthYear:"",birthMonth:"",birthDay:"",gender:"",rabiesVaccineImage:null,comboVaccineImage:null,rabiesExpiryDate:"",comboExpiryDate:""}),y(null),x(null),I(null),M(!1),alert("ワンちゃんの情報を更新しました！")}catch(l){v("ワンちゃんの情報更新に失敗しました。もう一度お試しください。")}finally{b(!1)}}}:async e=>{var r,n;e.preventDefault(),b(!0),v("");try{if(!k())return v("正しい生年月日を選択してください。"),void b(!1);if(!S.rabiesExpiryDate||!S.comboExpiryDate)return v("ワクチンの有効期限を入力してください。"),void b(!1);const e=new Date,o=new Date(S.rabiesExpiryDate),s=new Date(S.comboExpiryDate);if(o<=e||s<=e)return v("ワクチンの有効期限は今日より後の日付を入力してください。"),void b(!1);const l=`${S.birthYear}-${S.birthMonth}-${S.birthDay}`;let c;if("オス"===S.gender||"male"===S.gender||"male"===S.gender.toLowerCase())c="オス";else{if("メス"!==S.gender&&"female"!==S.gender&&"female"!==S.gender.toLowerCase())return v("性別を正しく選択してください。"),void b(!1);c="メス"}const{data:f,error:u}=await t.from("profiles").select("id, name, user_type").eq("id",null==g?void 0:g.id).maybeSingle();if(u&&"PGRST116"!==u.code)throw u;if(!f){const e=(null==(r=null==g?void 0:g.user_metadata)?void 0:r.name)||(null==(n=null==g?void 0:g.email)?void 0:n.split("@")[0])||"ユーザー",{data:i,error:a}=await t.from("profiles").upsert([{id:null==g?void 0:g.id,user_type:"user",name:e,postal_code:"",address:"",phone_number:""}],{onConflict:"id"}).select().single();if(a)throw a}const{data:d,error:h}=await t.from("dogs").insert([{name:S.name,breed:S.breed,birth_date:l,gender:c,owner_id:null==g?void 0:g.id}]).select().single();if(h)throw h;let m=null;if(w)try{const e=w.name.split(".").pop()||"jpg",r=Date.now(),n=`${d.id}/profile_${r}.${e}`,{error:i}=await t.storage.from("dog-images").upload(n,w,{cacheControl:"3600",upsert:!0});if(i)throw new Error(`画像のアップロードに失敗しました: ${i.message}`);const{data:{publicUrl:a}}=t.storage.from("dog-images").getPublicUrl(n);m=a;const{error:o}=await t.from("dogs").update({image_url:m}).eq("id",d.id);if(o)throw new Error("画像URLの更新に失敗しました")}catch(i){v("画像のアップロードに失敗しましたが、ワンちゃんの登録は完了しました。後でマイページから画像を追加できます。")}if(S.rabiesVaccineImage&&S.comboVaccineImage)try{const e=S.rabiesVaccineImage.name.split(".").pop()||"jpg",r=S.comboVaccineImage.name.split(".").pop()||"jpg",n=Date.now(),i=`${d.id}/rabies_${n}.${e}`,a=`${d.id}/combo_${n}.${r}`,[o,s]=await Promise.all([t.storage.from("vaccine-certs").upload(i,S.rabiesVaccineImage,{cacheControl:"3600",upsert:!0}),t.storage.from("vaccine-certs").upload(a,S.comboVaccineImage,{cacheControl:"3600",upsert:!0})]);if(o.error)throw o.error;if(s.error)throw s.error;const{error:l}=await t.from("vaccine_certifications").insert([{dog_id:d.id,rabies_vaccine_image:i,combo_vaccine_image:a,rabies_expiry_date:S.rabiesExpiryDate,combo_expiry_date:S.comboExpiryDate}]);if(l)throw l}catch(a){v("ワクチン証明書のアップロードに失敗しました。後でマイページから追加してください。")}await D(),N({name:"",breed:"",birthYear:"",birthMonth:"",birthDay:"",gender:"",rabiesVaccineImage:null,comboVaccineImage:null,rabiesExpiryDate:"",comboExpiryDate:""}),y(null),x(null),M(!1),alert("ワンちゃんの登録が完了しました！")}catch(o){v("ワンちゃんの登録に失敗しました。もう一度お試しください。")}finally{b(!1)}},children:[p&&r.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg",children:p}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["ワンちゃんの写真",C?"":"（任意）"]}),A?r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:A,alt:"ワンちゃんのプレビュー",className:"w-full h-64 object-cover rounded-lg border-2 border-gray-300"}),r.jsx("button",{type:"button",onClick:()=>{y(null),x(null)},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:r.jsx(u,{className:"w-4 h-4"})})]}):r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[r.jsx("input",{type:"file",accept:"image/*",onChange:async e=>{var t;const r=null==(t=e.target.files)?void 0:t[0];if(r){if(r.size>10485760)return void v("画像ファイルは10MB以下にしてください。");if(!r.type.startsWith("image/"))return void v("画像ファイルを選択してください。");try{const e={maxSizeMB:.3,maxWidthOrHeight:800,useWebWorker:!0},t=await G(r,e);y(t);const n=new FileReader;n.onload=e=>{var t;x(null==(t=e.target)?void 0:t.result)},n.readAsDataURL(t),v("")}catch(n){return void v("画像の圧縮・リサイズに失敗しました")}}},className:"hidden",id:"dog-image"}),r.jsxs("label",{htmlFor:"dog-image",className:"cursor-pointer flex flex-col items-center",children:[r.jsx(d,{className:"w-12 h-12 text-gray-400 mb-2"}),r.jsx("span",{className:"text-sm text-gray-600",children:"クリックして画像を選択"}),r.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, GIF (最大10MB)"})]})]})]}),r.jsx(a,{label:"名前",value:S.name,onChange:e=>N({...S,name:e.target.value}),required:!0}),r.jsx(o,{label:"犬種",options:P,value:S.breed,onChange:e=>N({...S,breed:e.target.value}),required:!0}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"生年月日 *"}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsx("div",{children:r.jsxs("select",{value:S.birthYear,onChange:e=>{N({...S,birthYear:e.target.value,birthDay:""})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[r.jsx("option",{value:"",children:"年"}),R.map((e=>r.jsx("option",{value:e.value,children:e.label},e.value)))]})}),r.jsx("div",{children:r.jsxs("select",{value:S.birthMonth,onChange:e=>{N({...S,birthMonth:e.target.value,birthDay:""})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[r.jsx("option",{value:"",children:"月"}),T.map((e=>r.jsx("option",{value:e.value,children:e.label},e.value)))]})}),r.jsx("div",{children:r.jsxs("select",{value:S.birthDay,onChange:e=>N({...S,birthDay:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:!S.birthYear||!S.birthMonth,children:[r.jsx("option",{value:"",children:"日"}),(()=>{if(!S.birthYear||!S.birthMonth)return Array.from({length:31},((e,t)=>{const r=t+1;return{value:r.toString().padStart(2,"0"),label:`${r}日`}}));const e=parseInt(S.birthYear),t=parseInt(S.birthMonth),r=new Date(e,t,0).getDate();return Array.from({length:r},((e,t)=>{const r=t+1;return{value:r.toString().padStart(2,"0"),label:`${r}日`}}))})().map((e=>r.jsx("option",{value:e.value,children:e.label},e.value)))]})})]}),S.birthYear&&S.birthMonth&&!S.birthDay&&r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"日を選択してください"}),S.birthYear&&S.birthMonth&&S.birthDay&&!k()&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:"正しい生年月日を選択してください（未来の日付や20年以上前の日付は選択できません）"})]}),r.jsx(o,{label:"性別",options:[{value:"",label:"性別を選択してください"},{value:"オス",label:"オス"},{value:"メス",label:"メス"}],value:S.gender,onChange:e=>N({...S,gender:e.target.value}),required:!0}),C?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"狂犬病ワクチン接種証明書（更新する場合のみ）"}),r.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var t;return N({...S,rabiesVaccineImage:(null==(t=e.target.files)?void 0:t[0])||null})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"混合ワクチン接種証明書（更新する場合のみ）"}),r.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var t;return N({...S,comboVaccineImage:(null==(t=e.target.files)?void 0:t[0])||null})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsx("div",{className:"p-4 bg-yellow-50 rounded-lg mb-4",children:r.jsxs("div",{className:"flex items-start space-x-2",children:[r.jsx(h,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),r.jsxs("div",{className:"text-sm text-yellow-800",children:[r.jsx("p",{className:"font-medium mb-1",children:"ワクチン証明書の更新について"}),r.jsx("p",{children:"新しいワクチン証明書をアップロードすると、再度審査が必要になります。審査完了までドッグランの利用ができなくなる場合があります。"})]})]})})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"狂犬病ワクチン接種証明書"}),r.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var t;return N({...S,rabiesVaccineImage:(null==(t=e.target.files)?void 0:t[0])||null})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"狂犬病ワクチン有効期限 *"}),r.jsx("input",{type:"date",value:S.rabiesExpiryDate,onChange:e=>N({...S,rabiesExpiryDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:(new Date).toISOString().split("T")[0],required:!0})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"混合ワクチン接種証明書"}),r.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var t;return N({...S,comboVaccineImage:(null==(t=e.target.files)?void 0:t[0])||null})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"混合ワクチン有効期限 *"}),r.jsx("input",{type:"date",value:S.comboExpiryDate,onChange:e=>N({...S,comboExpiryDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:(new Date).toISOString().split("T")[0],required:!0})]})]}),!C&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mt-4 p-3 bg-yellow-50 rounded-lg",children:r.jsx("p",{className:"text-sm text-yellow-800",children:"※ ワクチン接種証明書は運営による確認後に承認されます。承認されるまでドッグランの利用はできません。"})}),r.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:r.jsxs("p",{className:"text-sm text-blue-800",children:[r.jsx("span",{className:"font-medium",children:"生年月日について:"}),r.jsx("br",{}),"• 年、月、日をそれぞれ選択してください",r.jsx("br",{}),"• 未来の日付は選択できません",r.jsx("br",{}),"• 20年以上前の日付は選択できません",r.jsx("br",{}),"• 月を変更すると、その月の日数に応じて日の選択肢が更新されます"]})}),r.jsx("div",{className:"mt-4 p-3 bg-green-50 rounded-lg",children:r.jsxs("p",{className:"text-sm text-green-800",children:[r.jsx("span",{className:"font-medium",children:"写真について:"}),r.jsx("br",{}),"• ワンちゃんの写真は任意ですが、コミュニティで他の飼い主さんに見てもらえます",r.jsx("br",{}),"• JPG、PNG、GIF形式で最大10MBまでアップロード可能",r.jsx("br",{}),"• 後からマイページで変更することもできます"]})}),r.jsx("div",{className:"mt-4 p-3 bg-orange-50 rounded-lg",children:r.jsxs("p",{className:"text-sm text-orange-800",children:[r.jsx("span",{className:"font-medium",children:"ワクチン有効期限について:"}),r.jsx("br",{}),"• 狂犬病ワクチンと混合ワクチンの有効期限を正確に入力してください",r.jsx("br",{}),"• 有効期限が切れると自動的に再承認待ちになります",r.jsx("br",{}),"• 期限切れ30日前に通知をお送りします",r.jsx("br",{}),"• 新しいワクチン証明書は期限切れ前にアップロードしてください"]})})]}),r.jsxs("div",{className:"flex justify-between mt-4",children:[C&&r.jsx(n,{type:"button",variant:"secondary",onClick:()=>{M(!1),I(null),N({name:"",breed:"",birthYear:"",birthMonth:"",birthDay:"",gender:"",rabiesVaccineImage:null,comboVaccineImage:null,rabiesExpiryDate:"",comboExpiryDate:""}),y(null),x(null)},children:"キャンセル"}),r.jsx(n,{type:"submit",isLoading:m,className:C?"":"w-full",children:C?"更新する":"登録する"})]})]})})]})}G.getDataUrlFromFile=D,G.getFilefromDataUrl=N,G.loadImage=B,G.drawImageInCanvas=P,G.drawFileInCanvas=H,G.canvasToFile=L,G.getExifOrientation=$,G.handleMaxWidthOrHeight=z,G.followExifOrientation=q,G.cleanupCanvasMemory=O,G.isAutoOrientationInBrowser=V,G.approximateBelowMaximumCanvasSizeOfBrowser=T,G.copyExifWithoutOrientation=g,G.getBrowserName=R,G.version="2.0.2";export{K as DogRegistration};
