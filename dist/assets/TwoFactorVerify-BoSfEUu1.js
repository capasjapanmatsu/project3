import{j as a,B as w,s as m}from"./index-BB1ywuBb.js";import{r as s,u as j,d as C,R as v}from"./react-vendor-Co5xHYdE.js";import"./supabase-vendor-FDBaXLCh.js";import"./ui-vendor-B2-VOB5s.js";function E(){const[n,h]=s.useState(""),[c,r]=s.useState(null),[f,l]=s.useState(!1),[i,g]=s.useState(null),[u,x]=s.useState(!1),p=j(),y=C(),t=new URLSearchParams(y.search).get("factorId");v.useEffect(()=>{(async()=>{if(t){l(!0),r(null);try{const{data:o,error:d}=await m.auth.mfa.challenge({factorId:t});if(d)throw d;g(o.id),x(!0)}catch(o){r(o.message||"チャレンジ作成に失敗しました")}finally{l(!1)}}})()},[t]);const b=async()=>{if(!(!i||!t)){l(!0),r(null);try{const{error:e}=await m.auth.mfa.verify({factorId:t,challengeId:i,code:n});if(e)throw e;p("/dashboard")}catch(e){r(e.message||"認証に失敗しました")}finally{l(!1)}}};return a.jsxs("div",{className:"max-w-md mx-auto p-8",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"2ファクタ認証コード入力"}),a.jsx("p",{className:"mb-2",children:"認証アプリで生成された6桁のコードを入力してください。"}),a.jsx("input",{type:"text",value:n,onChange:e=>h(e.target.value),maxLength:6,className:"border px-2 py-1 mb-4 w-full text-center text-lg tracking-widest",placeholder:"123456",autoFocus:!0,disabled:!u}),c&&a.jsx("p",{className:"text-red-600 mb-4",children:c}),a.jsx(w,{onClick:b,disabled:f||n.length!==6||!u,children:"認証する"})]})}export{E as default};
