import{b as e,j as s,B as r}from"./index-Dp3tQatg.js";import{u as t,r as a}from"./vendor-Cwmn0chA.js";import{C as n}from"./Card-CPEZwr97.js";import{I as o}from"./Input-BBpqNzSy.js";import"./supabase-Dzr8oIt2.js";import"./ui-BHmKMuva.js";function i(){const i=t(),[l,d]=a.useState(!1),[c,m]=a.useState(""),[u,x]=a.useState(!1),[h,p]=a.useState({password:"",confirmPassword:""});a.useEffect((()=>{const s=new URLSearchParams(window.location.hash.substring(1)),r=s.get("access_token"),t=s.get("refresh_token");r&&t?e.auth.setSession({access_token:r,refresh_token:t}):m("無効なリセットリンクです。再度パスワードリセットを行ってください。")}),[]);return u?s.jsx("div",{className:"max-w-md mx-auto",children:s.jsx(n,{className:"text-center",children:s.jsxs("div",{className:"mb-4",children:[s.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-green-600\\",fill:"none\\",stroke:"currentColor\\",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"パスワードが更新されました"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"新しいパスワードでログインできます。3秒後にログインページに移動します。"}),s.jsx(r,{onClick:()=>i("/login"),children:"ログインページへ"})]})})}):s.jsxs("div",{className:"max-w-md mx-auto",children:[s.jsx("h1",{className:"text-2xl font-bold text-center mb-8",children:"パスワードリセット"}),s.jsx(n,{children:s.jsxs("form",{onSubmit:async s=>{if(s.preventDefault(),d(!0),m(""),h.password!==h.confirmPassword)return m("パスワードが一致しません"),void d(!1);if(h.password.length<6)return m("パスワードは6文字以上で入力してください"),void d(!1);try{const{error:s}=await e.auth.updateUser({password:h.password});if(s)throw s;x(!0),setTimeout((()=>{i("/login")}),3e3)}catch(r){m(r.message||"パスワードリセットに失敗しました")}finally{d(!1)}},children:[c&&s.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg",children:c}),s.jsx(o,{label:"新しいパスワード",type:"password",value:h.password,onChange:e=>p({...h,password:e.target.value}),required:!0,minLength:6}),s.jsx(o,{label:"新しいパスワード（確認）",type:"password",value:h.confirmPassword,onChange:e=>p({...h,confirmPassword:e.target.value}),required:!0,minLength:6}),s.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:s.jsx("p",{className:"text-sm text-blue-800",children:"パスワードは6文字以上で設定してください。"})}),s.jsx(r,{type:"submit",isLoading:l,className:"w-full mt-4",children:"パスワードを更新"})]})})]})}export{i as ResetPassword};
