import{j as e}from"./motion-BHsL7Azw.js";import{r as s}from"./react-vendor-CMvmJHsS.js";import{a as t,d as a,L as r}from"./router-DXQOdrLL.js";import{u as l,S as i,B as c,s as n}from"./index-xaqGfu5h.js";import{C as d}from"./Card-DqVnP9TA.js";import{u as o}from"./useStripe-bJ8VafZ1.js";import{p as m}from"./stripe-config-03sBkt-B.js";import{_ as x,o as h,S as p,t as j,J as b,U as u,d as g}from"./ui-basic-D1oJx_i8.js";import"./heavy-features-Dlg1c9Yc.js";import"./supabase-D2tiogv8.js";import"./external-api-CcgPsVUa.js";function N(){return function(){const e=new Date,s=e.getFullYear(),t=e.getMonth(),a=new Date(s,t+1,0),r=new Date(s,t,e.getDate()),l=a.getTime()-r.getTime(),i=Math.ceil(l/864e5)+1;return Math.max(1,i)}()}const f=[{icon:e.jsx(u,{className:"w-8 h-8 text-blue-600"}),title:"全国どこでも使い放題",description:"登録済みドッグランが使い放題"},{icon:e.jsx(h,{className:"w-8 h-8 text-yellow-600"}),title:"ペットショップ10%OFF",description:"対象ショップでのお買い物が常に10%オフ"},{icon:e.jsx(g,{className:"w-8 h-8 text-green-600"}),title:"送料無料",description:"ペットショップでのご注文は送料無料"},{icon:e.jsx(p,{className:"w-8 h-8 text-purple-600"}),title:"ドッグラン施設貸切20%OFF",description:"プライベート空間をお得に利用"}],w={price:3800,period:"月額"};function y(){const{user:u}=l(),g=t(),{createCheckoutSession:y}=o(),[v]=a(),[_,S]=s.useState(!1),[D,F]=s.useState(!0),[C,k]=s.useState(""),q=m.find(e=>"subscription"===e.mode);s.useEffect(()=>{if(!u)return void F(!1);(async()=>{try{const{data:e,error:s}=await n.from("stripe_user_subscriptions").select("id, stripe_subscription_id").eq("user_id",u.id).eq("status","active").maybeSingle();S(!!e)}catch(e){}finally{F(!1)}})()},[u]);return D?e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 to-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"読み込み中..."})]})}):e.jsxs(e.Fragment,{children:[e.jsx(i,{title:"サブスクリプション紹介",description:"ドッグパークJPのサブスクリプションプランで、全国のドッグランが使い放題！"}),e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 to-white",children:[e.jsx("div",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-4",children:e.jsxs(r,{to:"/access-control",className:"inline-flex items-center text-blue-600 hover:text-blue-700",children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),"戻る"]})})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-12",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full mb-6",children:e.jsx(h,{className:"w-10 h-10 text-white"})}),e.jsxs("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-4",children:["サブスクリプションの",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600",children:"一時停止・退会"}),"は、"]}),e.jsx("p",{className:"text-xl text-gray-600 mb-2",children:"マイページよりいつでも簡単に行えます。"}),e.jsx("p",{className:"text-lg text-gray-500",children:"お客様のペースでサービスをご利用いただけます"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 rounded-2xl p-6 text-center mb-12 text-white",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx(p,{className:"w-6 h-6 mr-2"}),e.jsx("span",{className:"font-bold text-lg",children:"キャンペーン実施中"}),e.jsx(p,{className:"w-6 h-6 ml-2"})]}),e.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-2",children:"初月完全無料！今月登録すれば月末まで0円でお試し"}),e.jsx("p",{className:"text-lg opacity-90",children:"翌月1日から月額3,800円の統一料金で、いつでもキャンセル可能です"})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12",children:f.map((s,t)=>e.jsxs(d,{className:"text-center p-6 hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"flex justify-center mb-4",children:s.icon}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:s.title}),e.jsx("p",{className:"text-gray-600 text-sm",children:s.description})]},t))}),e.jsx("div",{className:"max-w-md mx-auto mb-8",children:e.jsxs(d,{className:"text-center p-8 border-2 border-blue-200 bg-gradient-to-b from-blue-50 to-white",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-5xl font-bold text-gray-900 mb-2",children:["¥",w.price.toLocaleString()]}),e.jsxs("div",{className:"text-gray-600",children:[w.period,"（税込）"]})]}),_?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center text-green-600 mb-4",children:[e.jsx(j,{className:"w-6 h-6 mr-2"}),e.jsx("span",{className:"font-semibold",children:"ご加入済み"})]}),e.jsx(c,{onClick:()=>g("/dashboard"),className:"w-full",children:"ダッシュボードに移動"})]}):e.jsxs(c,{onClick:()=>{(async()=>{if(u)if(_)g("/dashboard");else try{k("");const{data:s,error:t}=await n.from("stripe_user_subscriptions").select("id, created_at").eq("user_id",u.id).order("created_at",{ascending:!1}),a=s&&s.length>0;let r=0;if(a)r=0;else try{r=N()}catch(e){r=30}const l=q?.priceId||"price_1RZpDjAHWLDQ7ynZP7zD3TQB";await y({priceId:l,mode:"subscription",trialPeriodDays:r,successUrl:`${window.location.origin}/dashboard?subscription=success`,cancelUrl:`${window.location.origin}/subscription-intro?canceled=true`})}catch(s){k("決済ページの作成に失敗しました。しばらく時間をおいてから再度お試しください。")}else g("/login?redirect=/subscription-intro&message=サブスクリプションにご加入いただくには、まずログインが必要です。")})()},className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-lg py-4",disabled:D,children:[e.jsx(b,{className:"w-5 h-5 mr-2"}),"今すぐ無料で始める（翌月から月額3,800円）"]})]})}),C&&e.jsx("div",{className:"max-w-md mx-auto mb-8",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center",children:e.jsx("p",{className:"text-red-600 text-sm",children:C})})}),"true"===v.get("canceled")&&e.jsx("div",{className:"max-w-md mx-auto mb-8",children:e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center",children:e.jsx("p",{className:"text-yellow-700",children:"決済ページの作成に失敗しました。もう一度お試しください。"})})}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-8",children:"よくある質問"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"初月無料はどのような仕組みですか？"}),e.jsx("p",{className:"text-gray-600",children:"新規登録の方は、登録月の月末まで無料でご利用いただけます。例えば1月15日に登録された場合、1月31日まで無料で、2月1日から月額3,800円の課金が開始されます。"})]}),e.jsxs(d,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"解約はいつでもできますか？"}),e.jsx("p",{className:"text-gray-600",children:"はい、マイページからいつでも解約・一時停止が可能です。解約手数料等は一切かかりません。"})]}),e.jsxs(d,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"ペットショップの割引はどこで利用できますか？"}),e.jsxs("p",{className:"text-gray-600",children:["詳細は",e.jsx(r,{to:"/shop",className:"text-blue-600 hover:text-blue-700 underline ml-1",children:"ペットショップページ"}),"をご確認ください。対象店舗や商品の最新情報を掲載しています。"]})]}),e.jsxs(d,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"一度解約して再登録した場合も初月無料になりますか？"}),e.jsx("p",{className:"text-gray-600",children:"申し訳ございませんが、初月無料は新規登録時のみの特典です。再登録の場合は、何日からでも月額3,800円（月末まで）の満額請求となります。"})]})]})]})]})]})]})}export{y as SubscriptionIntro};
