import{j as e}from"./data-vendor-BmFUkYzE.js";import{r as n}from"./core-vendor-DBEP70vW.js";import{f as s,b0 as t,b1 as i,i as a,b2 as r,j as l,W as c,d as o,D as d,S as m,a5 as x,p as h,ao as p}from"./ui-vendor-B3gor5_P.js";import{m as g}from"./heavy-vendor-Bb5jGJvT.js";const j=()=>{const[j,u]=n.useState("overview"),[b,y]=n.useState(null),f=[{id:"manifest",title:"1. manifest.json の作成",description:"PWAのメタデータとアイコンを定義",type:"manifest",completed:!0,code:'{\n  "name": "ドッグパークJP - 愛犬とお散歩",\n  "short_name": "ドッグパークJP",\n  "description": "愛犬とのお散歩をもっと楽しく。全国のドッグランを簡単に検索・予約できるサービスです。",\n  "start_url": "/",\n  "scope": "/",\n  "display": "standalone",\n  "orientation": "portrait-primary",\n  "background_color": "#ffffff",\n  "theme_color": "#3B82F6",\n  "categories": ["lifestyle", "travel", "social"],\n  "lang": "ja",\n  "icons": [\n    {\n      "src": "/icons/icon-192x192.png",\n      "sizes": "192x192",\n      "type": "image/png",\n      "purpose": "maskable any"\n    },\n    {\n      "src": "/icons/icon-512x512.png",\n      "sizes": "512x512",\n      "type": "image/png",\n      "purpose": "maskable any"\n    }\n  ],\n  "shortcuts": [\n    {\n      "name": "ドッグラン検索",\n      "short_name": "検索",\n      "description": "近くのドッグランを検索",\n      "url": "/parks",\n      "icons": [\n        {\n          "src": "/icons/icon-192x192.png",\n          "sizes": "192x192",\n          "type": "image/png"\n        }\n      ]\n    }\n  ]\n}'},{id:"serviceworker",title:"2. Service Worker の実装",description:"キャッシュ戦略とオフライン機能を提供",type:"serviceworker",completed:!0,code:"// Service Worker の基本実装\nconst CACHE_NAME = 'dogpark-jp-v1.0.0';\nconst STATIC_RESOURCES = [\n  '/',\n  '/index.html',\n  '/manifest.json',\n  '/icons/icon-192x192.png',\n  '/icons/icon-512x512.png',\n  '/offline.html'\n];\n\n// インストール時のキャッシュ\nself.addEventListener('install', (event) => {\n  event.waitUntil(\n    caches.open(CACHE_NAME)\n      .then((cache) => cache.addAll(STATIC_RESOURCES))\n      .then(() => self.skipWaiting())\n  );\n});\n\n// アクティベート時の古いキャッシュ削除\nself.addEventListener('activate', (event) => {\n  event.waitUntil(\n    caches.keys().then((cacheNames) => {\n      return Promise.all(\n        cacheNames.map((cacheName) => {\n          if (cacheName !== CACHE_NAME) {\n            return caches.delete(cacheName);\n          }\n        })\n      );\n    }).then(() => self.clients.claim())\n  );\n});\n\n// フェッチイベントでキャッシュ戦略を実装\nself.addEventListener('fetch', (event) => {\n  if (event.request.method !== 'GET') return;\n  \n  event.respondWith(\n    caches.match(event.request)\n      .then((response) => {\n        if (response) {\n          return response;\n        }\n        return fetch(event.request)\n          .then((response) => {\n            if (response.status === 200) {\n              const responseClone = response.clone();\n              caches.open(CACHE_NAME)\n                .then((cache) => cache.put(event.request, responseClone));\n            }\n            return response;\n          })\n          .catch(() => {\n            if (event.request.mode === 'navigate') {\n              return caches.match('/offline.html');\n            }\n          });\n      })\n  );\n});"},{id:"registration",title:"3. Service Worker の登録",description:"メインアプリケーションでService Workerを登録",type:"registration",completed:!0,code:"// main.tsx または index.js\nif ('serviceWorker' in navigator && import.meta.env.PROD) {\n  window.addEventListener('load', async () => {\n    try {\n      const registration = await navigator.serviceWorker.register('/sw.js', {\n        scope: '/'\n      });\n      \n      \n      // 更新チェック\n      registration.addEventListener('updatefound', () => {\n        const newWorker = registration.installing;\n        if (newWorker) {\n          newWorker.addEventListener('statechange', () => {\n            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\n              showUpdateNotification();\n            }\n          });\n        }\n      });\n      \n    } catch (error) {\n      console.error('Service Worker 登録失敗:', error);\n    }\n  });\n}\n\n// PWA インストールプロンプト\nlet deferredPrompt;\n\nwindow.addEventListener('beforeinstallprompt', (e) => {\n  e.preventDefault();\n  deferredPrompt = e;\n  showInstallButton();\n});\n\n// インストールボタンクリック時\nasync function installPWA() {\n  if (deferredPrompt) {\n    deferredPrompt.prompt();\n    const { outcome } = await deferredPrompt.userChoice;\n    deferredPrompt = null;\n  }\n}"},{id:"html",title:"4. HTML の設定",description:"PWAに必要なメタタグとリンクを追加",type:"html",completed:!0,code:'<!DOCTYPE html>\n<html lang="ja">\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n  \n  \x3c!-- PWA必須メタタグ --\x3e\n  <meta name="theme-color" content="#3B82F6" />\n  <link rel="manifest" href="/manifest.json" />\n  \n  \x3c!-- Apple PWA対応 --\x3e\n  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />\n  <meta name="apple-mobile-web-app-capable" content="yes" />\n  <meta name="apple-mobile-web-app-status-bar-style" content="default" />\n  <meta name="apple-mobile-web-app-title" content="ドッグパークJP" />\n  \n  \x3c!-- Microsoft PWA対応 --\x3e\n  <meta name="msapplication-TileImage" content="/icons/icon-192x192.png" />\n  <meta name="msapplication-TileColor" content="#3B82F6" />\n  \n  \x3c!-- SEO最適化 --\x3e\n  <meta name="description" content="愛犬とのお散歩をもっと楽しく。全国のドッグランを簡単に検索・予約できるサービスです。" />\n  \n  <title>ドッグパークJP</title>\n</head>\n<body>\n  <div id="root"></div>\n  <script type="module" src="/src/main.tsx"><\/script>\n</body>\n</html>'},{id:"offline",title:"5. オフラインページの作成",description:"ネットワーク接続がない時の代替ページ",type:"html",completed:!0,code:'<!DOCTYPE html>\n<html lang="ja">\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n  <title>オフライン - ドッグパークJP</title>\n  <style>\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      min-height: 100vh;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      color: white;\n      text-align: center;\n      padding: 20px;\n    }\n    \n    .offline-container {\n      max-width: 500px;\n      padding: 40px 30px;\n      background: rgba(255, 255, 255, 0.1);\n      backdrop-filter: blur(10px);\n      border-radius: 20px;\n      border: 1px solid rgba(255, 255, 255, 0.2);\n    }\n    \n    .retry-button {\n      background: #3B82F6;\n      color: white;\n      border: none;\n      padding: 12px 24px;\n      border-radius: 8px;\n      cursor: pointer;\n      font-size: 16px;\n      margin-top: 20px;\n    }\n  </style>\n</head>\n<body>\n  <div class="offline-container">\n    <h1>🐕 オフラインです</h1>\n    <p>インターネット接続を確認してください</p>\n    <button class="retry-button" onclick="window.location.reload()">\n      再試行\n    </button>\n  </div>\n</body>\n</html>'},{id:"build",title:"6. ビルド設定の最適化",description:"Vite/Webpack等でPWA用の最適化を実装",type:"build",completed:!0,code:"// vite.config.ts\nimport { defineConfig } from 'vite';\nimport react from '@vitejs/plugin-react';\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    // PWA プラグイン（オプション）\n    // VitePWA({\n    //   registerType: 'autoUpdate',\n    //   includeAssets: ['favicon.ico', 'apple-touch-icon.png', 'masked-icon.svg'],\n    //   manifest: {\n    //     name: 'ドッグパークJP',\n    //     short_name: 'ドッグパークJP',\n    //     description: '愛犬とのお散歩をもっと楽しく',\n    //     theme_color: '#3B82F6',\n    //     icons: [\n    //       {\n    //         src: 'icons/icon-192x192.png',\n    //         sizes: '192x192',\n    //         type: 'image/png'\n    //       }\n    //     ]\n    //   }\n    // })\n  ],\n  build: {\n    rollupOptions: {\n      output: {\n        manualChunks: {\n          vendor: ['react', 'react-dom'],\n          router: ['react-router-dom']\n        }\n      }\n    }\n  }\n});"}],v=({icon:n,title:s,description:t,status:i})=>e.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0 text-2xl",children:n}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s}),"completed"===i&&e.jsx(a,{className:"w-5 h-5 text-green-500"}),"pending"===i&&e.jsx(h,{className:"w-5 h-5 text-yellow-500"}),"error"===i&&e.jsx(h,{className:"w-5 h-5 text-red-500"})]}),e.jsx("p",{className:"text-gray-600 mt-1",children:t})]})]})}),N=({code:n,language:s,id:t})=>e.jsxs("div",{className:"relative bg-gray-900 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-800",children:[e.jsx("span",{className:"text-sm text-gray-300",children:s}),e.jsxs("button",{onClick:()=>(async(e,n)=>{try{await navigator.clipboard.writeText(e),y(n),setTimeout(()=>y(null),2e3)}catch(s){}})(n,t),className:"flex items-center space-x-1 text-gray-300 hover:text-white transition-colors",children:[e.jsx(p,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:b===t?"コピー済み":"コピー"})]})]}),e.jsx("pre",{className:"p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-gray-100",children:n})})]});return e.jsxs("div",{className:"min-h-screen bg-gray-50 py-12",children:[e.jsxs(s,{children:[e.jsx("title",{children:"PWA実装ガイド - ドッグパークJP"}),e.jsx("meta",{name:"description",content:"ドッグパークJPのPWA（プログレッシブ・ウェブ・アプリ）実装の完全ガイド"})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs(g.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"PWA実装ガイド"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"ドッグパークJPのプログレッシブ・ウェブ・アプリ（PWA）実装の完全なガイドとコード例"})]}),e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx("div",{className:"bg-white rounded-lg p-1 shadow-sm border border-gray-200",children:[{key:"overview",label:"概要",icon:e.jsx(t,{className:"w-4 h-4"})},{key:"implementation",label:"実装",icon:e.jsx(i,{className:"w-4 h-4"})},{key:"testing",label:"テスト",icon:e.jsx(a,{className:"w-4 h-4"})},{key:"deployment",label:"デプロイ",icon:e.jsx(r,{className:"w-4 h-4"})}].map(n=>e.jsxs("button",{onClick:()=>u(n.key),className:"flex items-center space-x-2 px-4 py-2 rounded-md transition-colors "+(j===n.key?"bg-blue-500 text-white":"text-gray-600 hover:text-gray-900"),children:[n.icon,e.jsx("span",{children:n.label})]},n.key))})}),"overview"===j&&e.jsxs(g.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-8",children:[e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(v,{icon:e.jsx(l,{}),title:"ホーム画面への追加",description:"ネイティブアプリのようにホーム画面からアクセス可能",status:"completed"}),e.jsx(v,{icon:e.jsx(c,{}),title:"オフライン機能",description:"インターネット接続がなくても基本機能を利用可能",status:"completed"}),e.jsx(v,{icon:e.jsx(r,{}),title:"高速ロード",description:"Service Workerによるキャッシュで高速な読み込み",status:"completed"}),e.jsx(v,{icon:e.jsx(o,{}),title:"セキュアな配信",description:"HTTPS必須でセキュアな通信を保証",status:"completed"}),e.jsx(v,{icon:e.jsx(d,{}),title:"自動更新",description:"新しいバージョンを自動で検出・更新",status:"completed"}),e.jsx(v,{icon:e.jsx(m,{}),title:"プッシュ通知",description:"重要な情報をプッシュ通知で配信",status:"pending"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"PWAの利点"}),e.jsxs("ul",{className:"space-y-2 text-blue-800",children:[e.jsx("li",{children:"• ネイティブアプリのような体験を提供"}),e.jsx("li",{children:"• オフラインでも動作する信頼性"}),e.jsx("li",{children:"• 高速な読み込みとスムーズな操作"}),e.jsx("li",{children:"• インストール不要で簡単にアクセス"}),e.jsx("li",{children:"• アプリストアを経由せずに配信可能"}),e.jsx("li",{children:"• クロスプラットフォーム対応"})]})]})]}),"implementation"===j&&e.jsx(g.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-8",children:f.map((n,s)=>e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*s},className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:n.title}),n.completed&&e.jsx(a,{className:"w-6 h-6 text-green-500"})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:n.description}),n.code&&e.jsx(N,{code:n.code,language:"manifest"===n.type?"JSON":"html"===n.type?"HTML":"JavaScript",id:n.id})]},n.id))}),"testing"===j&&e.jsxs(g.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"PWA動作確認手順"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"1. Chrome DevToolsでの確認"}),e.jsxs("ul",{className:"list-disc list-inside text-gray-600 space-y-1",children:[e.jsx("li",{children:"Chrome DevToolsを開く（F12）"}),e.jsx("li",{children:"「Application」タブを選択"}),e.jsx("li",{children:"「Manifest」でmanifest.jsonの内容を確認"}),e.jsx("li",{children:"「Service Workers」でSWの登録状況を確認"}),e.jsx("li",{children:"「Storage」でキャッシュの状況を確認"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"2. Lighthouse PWA監査"}),e.jsxs("ul",{className:"list-disc list-inside text-gray-600 space-y-1",children:[e.jsx("li",{children:"Chrome DevToolsの「Lighthouse」タブを選択"}),e.jsx("li",{children:"「Progressive Web App」をチェック"}),e.jsx("li",{children:"「Generate report」をクリック"}),e.jsx("li",{children:"PWAスコアと改善点を確認"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"3. オフライン動作テスト"}),e.jsxs("ul",{className:"list-disc list-inside text-gray-600 space-y-1",children:[e.jsx("li",{children:"Chrome DevToolsの「Network」タブを選択"}),e.jsx("li",{children:"「Offline」にチェックを入れる"}),e.jsx("li",{children:"ページをリロードしてオフラインページが表示されるか確認"}),e.jsx("li",{children:"キャッシュされたリソースが正常に読み込まれるか確認"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"4. インストール可能性テスト"}),e.jsxs("ul",{className:"list-disc list-inside text-gray-600 space-y-1",children:[e.jsx("li",{children:"Chromeのアドレスバーにインストールアイコンが表示されるか確認"}),e.jsx("li",{children:"「Add to Home screen」が可能か確認"}),e.jsx("li",{children:"インストール後、スタンドアローンモードで起動するか確認"})]})]})]})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[e.jsx("h4",{className:"text-lg font-medium text-yellow-900 mb-2",children:"⚠️ テスト時の注意点"}),e.jsxs("ul",{className:"list-disc list-inside text-yellow-800 space-y-1",children:[e.jsx("li",{children:"PWAのテストは必ずHTTPS環境で行う（localhost除く）"}),e.jsx("li",{children:"Service Workerの更新時はハードリフレッシュ（Ctrl+Shift+R）を実行"}),e.jsx("li",{children:"キャッシュの動作確認時は「Disable cache」のチェックを外す"}),e.jsx("li",{children:"モバイルデバイスでの実機テストも必ず実施"})]})]})]}),"deployment"===j&&e.jsxs(g.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Netlifyでのデプロイ設定"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"_redirects ファイル"}),e.jsx(N,{code:"# SPA用のリダイレクト設定\n/*    /index.html   200\n\n# PWA用のヘッダー設定\n/manifest.json\n  Cache-Control: public, max-age=0, must-revalidate\n/sw.js\n  Cache-Control: public, max-age=0, must-revalidate\n/offline.html\n  Cache-Control: public, max-age=86400",language:"Text",id:"redirects"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"netlify.toml 設定"}),e.jsx(N,{code:'[build]\n  publish = "dist"\n  command = "npm run build"\n\n[build.environment]\n  NODE_VERSION = "18"\n\n[[headers]]\n  for = "/manifest.json"\n  [headers.values]\n    Cache-Control = "public, max-age=0, must-revalidate"\n    Content-Type = "application/manifest+json"\n\n[[headers]]\n  for = "/sw.js"\n  [headers.values]\n    Cache-Control = "public, max-age=0, must-revalidate"\n    Content-Type = "application/javascript"\n\n[[headers]]\n  for = "/*"\n  [headers.values]\n    X-Frame-Options = "DENY"\n    X-XSS-Protection = "1; mode=block"\n    X-Content-Type-Options = "nosniff"\n    Referrer-Policy = "strict-origin-when-cross-origin"',language:"TOML",id:"netlify-toml"})]})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[e.jsx("h4",{className:"text-lg font-medium text-green-900 mb-2",children:"✅ デプロイ完了後の確認事項"}),e.jsxs("ul",{className:"list-disc list-inside text-green-800 space-y-1",children:[e.jsx("li",{children:"HTTPS配信が有効になっているか確認"}),e.jsx("li",{children:"manifest.jsonが正しく配信されているか確認"}),e.jsx("li",{children:"Service Workerが登録されているか確認"}),e.jsx("li",{children:"PWA Lighthouseスコアが90以上になっているか確認"}),e.jsx("li",{children:"モバイルデバイスでインストール可能か確認"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"その他のホスティング設定"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Vercel"}),e.jsx(N,{code:'{\n  "headers": [\n    {\n      "source": "/sw.js",\n      "headers": [\n        {\n          "key": "Cache-Control",\n          "value": "public, max-age=0, must-revalidate"\n        }\n      ]\n    },\n    {\n      "source": "/manifest.json",\n      "headers": [\n        {\n          "key": "Cache-Control", \n          "value": "public, max-age=0, must-revalidate"\n        }\n      ]\n    }\n  ]\n}',language:"JSON",id:"vercel"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Firebase Hosting"}),e.jsx(N,{code:'{\n  "hosting": {\n    "public": "dist",\n    "ignore": ["firebase.json"],\n    "rewrites": [{\n      "source": "**",\n      "destination": "/index.html"\n    }],\n    "headers": [{\n      "source": "/sw.js",\n      "headers": [{\n        "key": "Cache-Control",\n        "value": "no-cache"\n      }]\n    }]\n  }\n}',language:"JSON",id:"firebase"})]})]})]})]}),e.jsx(g.div,{initial:{opacity:0},animate:{opacity:1},className:"mt-12 text-center",children:e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"🎉 PWA実装完了！"}),e.jsx("p",{className:"text-blue-800",children:"ドッグパークJPは完全なPWA対応が実装されており、 ユーザーはネイティブアプリのような体験を享受できます。"}),e.jsxs("div",{className:"mt-4 flex justify-center space-x-4",children:[e.jsxs("a",{href:"https://web.dev/pwa-checklist/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-blue-600 hover:text-blue-800",children:[e.jsx(x,{className:"w-4 h-4 mr-1"}),"PWA公式チェックリスト"]}),e.jsxs("a",{href:"https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-blue-600 hover:text-blue-800",children:[e.jsx(x,{className:"w-4 h-4 mr-1"}),"MDN PWAガイド"]})]})]})})]})]})};export{j as default};
