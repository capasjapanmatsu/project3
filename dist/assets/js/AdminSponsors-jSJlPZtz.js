import{j as e}from"./motion-CuO0nkIV.js";import{r as s}from"./react-vendor-cniURDpR.js";import{a as t,L as a}from"./router-Cg6wfOY4.js";import{B as n}from"./Button-D7FFKgkK.js";import{u as r,s as i,C as l}from"./index-qwdJeTcH.js";import{af as c,N as o,h as d,y as m,a7 as x}from"./ui-basic-icnN6BOT.js";import"./supabase-B0bqaRGb.js";import"./heavy-features-BIdEME4r.js";function p(){const{isAdmin:p}=r(),h=t(),[u,j]=s.useState([]),[f,g]=s.useState(!0),[y,b]=s.useState("all");s.useEffect(()=>{p?N():h("/")},[p,h]);const N=async()=>{try{let e=i.from("sponsor_inquiries").select("*").order("created_at",{ascending:!1});"all"!==y&&(e=e.eq("status",y));const{data:s,error:t}=await e;if(t)throw t;j(s||[])}catch(e){}finally{g(!1)}},v=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"contacted":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},w=e=>{switch(e){case"pending":return"未対応";case"contacted":return"連絡済み";case"completed":return"成約";case"declined":return"辞退";default:return e}};return f?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs(a,{to:"/admin",className:"inline-flex items-center text-gray-600 hover:text-gray-900 mb-4",children:[e.jsx(c,{className:"w-4 h-4 mr-2"}),"管理画面に戻る"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"スポンサー広告お問い合わせ管理"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"スポンサー広告に関するお問い合わせを管理できます。"})]}),e.jsx(l,{className:"p-4 mb-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ステータスで絞り込み："}),e.jsxs("select",{value:y,onChange:e=>{b(e.target.value),N()},className:"border rounded-lg px-3 py-1 text-sm",children:[e.jsx("option",{value:"all",children:"すべて"}),e.jsx("option",{value:"pending",children:"未対応"}),e.jsx("option",{value:"contacted",children:"連絡済み"}),e.jsx("option",{value:"completed",children:"成約"}),e.jsx("option",{value:"declined",children:"辞退"})]})]})}),0===u.length?e.jsx(l,{className:"p-8 text-center",children:e.jsx("p",{className:"text-gray-500",children:"お問い合わせはまだありません。"})}):e.jsx("div",{className:"space-y-4",children:u.map(s=>e.jsxs(l,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:[e.jsx(o,{className:"inline w-5 h-5 mr-2 text-gray-500"}),s.company_name]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"担当者："})," ",s.contact_person,"様"]}),e.jsxs("p",{children:[e.jsx(d,{className:"inline w-4 h-4 mr-1"}),e.jsx("a",{href:`mailto:${s.email}`,className:"text-blue-600 hover:text-blue-800",children:s.email})]}),e.jsxs("p",{children:[e.jsx(m,{className:"inline w-4 h-4 mr-1"}),new Date(s.created_at).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium ${v(s.status)}`,children:w(s.status)})})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ステータス変更"}),e.jsxs("select",{value:s.status,onChange:e=>(async(e,s)=>{try{const{error:t}=await i.from("sponsor_inquiries").update({status:s,updated_at:(new Date).toISOString()}).eq("id",e);if(t)throw t;await N()}catch(t){}})(s.id,e.target.value),className:"w-full border rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:"pending",children:"未対応"}),e.jsx("option",{value:"contacted",children:"連絡済み"}),e.jsx("option",{value:"completed",children:"成約"}),e.jsx("option",{value:"declined",children:"辞退"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"アクション"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(n,{onClick:()=>{const e=encodeURIComponent("【ドッグパークJP】スポンサー広告のご案内"),t="%0D%0A",a=encodeURIComponent(`${s.contact_person}様${t}${t}お世話になっております。`+t+"ドッグパークJP運営事務局です。"+t+t+"この度は、スポンサー広告にご興味をお持ちいただき、誠にありがとうございます。"+t+t+"詳細なご案内をさせていただきたく、ご連絡させていただきました。"+t+t+"【スポンサー広告プランのご案内】"+t+"・プラン内容の詳細説明"+t+"・料金体系"+t+"・掲載までの流れ"+t+"・その他ご質問への回答"+t+t+"ご都合の良い日時をお知らせいただければ、詳しくご説明させていただきます。"+t+t+"何かご不明な点がございましたら、お気軽にお問い合わせください。"+t+t+"よろしくお願いいたします。"+t+t+"--"+t+"ドッグパークJP運営事務局"+t+"メール: info@dogparkjp.com"+t+"ウェブサイト: https://dogparkjp.com"+t+t+"※送信元アドレスが info@dogparkjp.com になっていることをご確認ください。"),n=encodeURIComponent(s.email),r=`ms-outlook:compose?to=${n}&subject=${e}&body=${a}`;let i=!1;try{window.location.href=r,i=!0}catch{}setTimeout(()=>{if(i)return;const s=`https://outlook.office.com/mail/deeplink/compose?to=${n}&subject=${e}&body=${a}`;window.open(s,"_blank")||(window.location.href=`mailto:${n}?subject=${e}&body=${a}`)},200)},variant:"secondary",size:"sm",className:"flex-1",children:[e.jsx(d,{className:"w-4 h-4 mr-1"}),"メール送信"]}),e.jsxs(n,{onClick:async()=>{try{const e="【ドッグパークJP】スポンサー広告のご案内",t=`${s.contact_person}様\n\nお世話になっております。\nドッグパークJP運営事務局です。\n\nこの度はスポンサー広告にご興味をお持ちいただき、誠にありがとうございます。\n\n資料とご案内をお送りします。ご不明点があればお気軽にご返信ください。\n\n--\nドッグパークJP運営事務局\ninfo@dogparkjp.com`,a=await fetch("/.netlify/functions/send-sponsor-email-direct",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:s.email,subject:e,text:t})});if(!a.ok)throw new Error(await a.text());alert("info@dogparkjp.com から送信しました。")}catch(e){alert(`送信に失敗しました: ${e.message||e}`)}},variant:"secondary",size:"sm",className:"flex-1",children:[e.jsx(d,{className:"w-4 h-4 mr-1"}),"info@から送信"]}),e.jsxs(n,{onClick:()=>h(`/sponsor-application?inquiry_id=${s.id}`),variant:"secondary",size:"sm",className:"flex-1",children:[e.jsx(x,{className:"w-4 h-4 mr-1"}),"申込ページ"]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"メモ"}),e.jsx("textarea",{value:s.notes||"",onChange:e=>(async(e,s)=>{try{const{error:t}=await i.from("sponsor_inquiries").update({notes:s,updated_at:(new Date).toISOString()}).eq("id",e);if(t)throw t;await N()}catch(t){}})(s.id,e.target.value),placeholder:"対応内容などをメモできます...",className:"w-full border rounded-lg px-3 py-2 text-sm",rows:2})]})]})]},s.id))})]})})}export{p as AdminSponsors};
