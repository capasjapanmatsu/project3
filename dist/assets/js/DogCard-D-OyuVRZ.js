import{j as e}from"./motion-CuO0nkIV.js";import{r as s}from"./react-vendor-cniURDpR.js";import{L as a}from"./router-Cg6wfOY4.js";import{d as t}from"./dogBreeds-6lxY8Uni.js";import{B as r}from"./Button-CJFAG6V0.js";import{I as l}from"./ImageCropper-BqfqFQ-L.js";import{I as i}from"./Input-D3zjVn42.js";import{L as n}from"./LazyImage-D-JxrRiD.js";import{S as c}from"./Select-Dd_IZFKg.js";import{g as d,V as o}from"./VaccineBadge-BFc_cRH8.js";import{P as m,e as x,ad as g,ae as h,X as b,C as j,J as u,aA as p}from"./ui-basic-CaMd9YQ-.js";function N({dog:s,onEdit:t}){const l=d(s),i=v(s.gender);return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden",children:s.image_url?e.jsx(n,{src:s.image_url,alt:s.name,width:64,height:64,loading:"lazy",priority:!1,className:"w-full h-full object-cover rounded-full",placeholderSrc:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMzIiIGN5PSIzMiIgcj0iMzIiIGZpbGw9IiNGM0Y0RjYiLz4KPHN2ZyB4PSIyNCIgeT0iMjQiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5Q0EzQUYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj4KPGVsbGlwc2UgY3g9IjEyIiBjeT0iMTMiIHJ4PSIxMCIgcnk9IjQiLz4KPHBhdGggZD0ibTEyIDEzIDQuNS05IDQuNSA5Ii8+CjxwYXRoIGQ9Im0xMiAxMyA0LjUtOUw3IDEzIi8+CjxwYXRoIGQ9Im0xMiAxM0w3IDQgNy41IDEzIi8+Cjwvc3ZnPgo8L3N2Zz4K"}):e.jsx(m,{className:"w-8 h-8 text-gray-500"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold",children:[s.name,i]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.breed," • ",s.gender]}),s.microchip_number&&e.jsxs("p",{className:"text-xs text-gray-500",children:["マイクロチップ: ",s.microchip_number]}),e.jsx("div",{className:"flex items-center space-x-2 mt-1",children:e.jsx(o,{status:l,size:"sm"})})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(a,{to:"/jp-passport",children:e.jsx(r,{size:"sm",className:"bg-emerald-50 hover:bg-emerald-100 text-emerald-600 border-0",title:"JPパスポートを確認",children:e.jsx(x,{className:"w-4 h-4"})})}),e.jsx(r,{size:"sm",className:"bg-blue-50 hover:bg-blue-100 text-blue-600 border-0",onClick:()=>t(s),children:e.jsx(g,{className:"w-4 h-4"})})]})]})}function v(e){return"オス"===e?"くん":"ちゃん"}function y({dog:a,isUpdating:n,error:m,success:g,dogFormData:N,dogImagePreview:y,onClose:f,onSubmit:I,onDelete:w,onFormChange:C,onImageSelect:D,onImageRemove:P,rabiesVaccineFile:G,comboVaccineFile:k,rabiesExpiryDate:z,comboExpiryDate:M,onRabiesVaccineSelect:S,onComboVaccineSelect:B,onRabiesExpiryDateChange:E,onComboExpiryDateChange:Z,onImageCropped:H,onSubmitVaccine:J}){if(!a)return null;const A=v(a.gender),L=d(a),[Q,R]=s.useState(!1),[W,V]=s.useState(!1);return s.useEffect(()=>{R(!1)},[y,a?.id]),e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:[e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold",children:[a.name,A,"の情報編集"]}),e.jsxs("div",{className:"flex space-x-2",children:[w&&e.jsx("button",{type:"button",onClick:()=>{window.confirm(`${a.name}${A}を削除しますか？\n\nこの操作は元に戻せません。`)&&w(a)},className:"text-red-500 hover:text-red-700 p-1 rounded-lg hover:bg-red-50 transition-colors",title:"このワンちゃんを削除",children:e.jsx(h,{className:"w-5 h-5"})}),e.jsx("button",{onClick:f,className:"text-gray-500 hover:text-gray-700 p-1 rounded-lg hover:bg-gray-100 transition-colors",title:"編集を閉じる",children:e.jsx(b,{className:"w-5 h-5"})})]})]}),m&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg",children:m}),g&&e.jsxs("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-lg flex items-center",children:[e.jsx(x,{className:"w-5 h-5 mr-2"}),g]}),e.jsx("form",{onSubmit:I,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"基本情報"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ワンちゃんの写真"}),y&&!Q?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative w-full h-64 bg-gray-100 rounded-lg overflow-hidden border-2 border-gray-300",children:[e.jsx("img",{src:y,alt:"プレビュー",className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),R(!0),P()},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),P())},className:"absolute top-2 right-2 z-10 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-red-400","aria-label":"画像を削除",title:"画像を削除","data-testid":"dog-image-delete-button",children:e.jsx(h,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"mt-3 text-right",children:e.jsx(r,{type:"button",variant:"secondary",onClick:()=>V(!0),children:"画像を変更（トリミング）"})}),e.jsx("div",{className:"mt-2",children:e.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),R(!0),P()},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),P())},className:"text-sm text-red-600 hover:text-red-700 underline","data-testid":"dog-image-delete-text",children:"画像を削除"})})]}):e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:e.jsxs("button",{type:"button",onClick:()=>V(!0),className:"cursor-pointer flex flex-col items-center w-full",children:[e.jsx(j,{className:"w-12 h-12 text-gray-400 mb-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"クリックして画像を選択"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, WEBP (最大10MB)"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(i,{label:"名前",value:N.name,onChange:e=>C({...N,name:e.target.value}),required:!0}),e.jsx(c,{label:"犬種",options:t.map(e=>({value:e,label:e})),value:N.breed,onChange:e=>C({...N,breed:e.target.value}),required:!0}),e.jsx(c,{label:"性別",options:[{value:"",label:"性別を選択してください"},{value:"オス",label:"オス"},{value:"メス",label:"メス"}],value:N.gender,onChange:e=>C({...N,gender:e.target.value}),required:!0}),e.jsx(i,{label:"生年月日",type:"date",value:N.birthDate,onChange:e=>C({...N,birthDate:e.target.value}),required:!0}),e.jsx(i,{label:"マイクロチップNO",type:"text",value:N.microchipNumber,onChange:e=>C({...N,microchipNumber:e.target.value}),placeholder:"15桁の数字（任意）",maxLength:15})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(x,{className:"w-5 h-5 mr-2"}),"ワクチン証明書"]}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"現在のステータス:"}),e.jsx(o,{status:L,size:"md"})]}),"pending"===L&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"新しい証明書をアップロードすると、再度承認待ち状態になります。"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"狂犬病ワクチン証明書"}),G?e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-800",children:G.name}),e.jsx("button",{type:"button",onClick:()=>{const e=document.getElementById("rabies-vaccine-edit");e&&(e.value="");S({target:{files:[]}})},className:"text-red-600 hover:text-red-800",children:e.jsx(h,{className:"w-4 h-4"})})]})}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-gray-400 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:S,className:"hidden",id:"rabies-vaccine-edit"}),e.jsxs("label",{htmlFor:"rabies-vaccine-edit",className:"cursor-pointer flex flex-col items-center",children:[e.jsx(p,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"証明書をアップロード"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, GIF (最大10MB)"})]})]}),e.jsx(i,{label:"有効期限",type:"date",value:z,onChange:e=>E(e.target.value),className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"混合ワクチン証明書"}),k?e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-800",children:k.name}),e.jsx("button",{type:"button",onClick:()=>{const e=document.getElementById("combo-vaccine-edit");e&&(e.value="");B({target:{files:[]}})},className:"text-red-600 hover:text-red-800",children:e.jsx(h,{className:"w-4 h-4"})})]})}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-gray-400 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:B,className:"hidden",id:"combo-vaccine-edit"}),e.jsxs("label",{htmlFor:"combo-vaccine-edit",className:"cursor-pointer flex flex-col items-center",children:[e.jsx(p,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"証明書をアップロード"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, GIF (最大10MB)"})]})]}),e.jsx(i,{label:"有効期限",type:"date",value:M,onChange:e=>Z(e.target.value),className:"mt-2"})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"注意:"})," 新しいワクチン証明書をアップロードすると、管理者による再承認が必要になります。 承認されるまでドッグランのご利用はできません。"]})}),e.jsx("div",{className:"mt-3 text-right",children:J&&e.jsx(r,{type:"button",onClick:()=>J(),children:"ワクチン提出（審査待ちにする）"})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(r,{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:f,children:"キャンセル"}),e.jsxs(r,{type:"submit",isLoading:n,children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),"保存"]})]})]})})]})}),W&&e.jsx(l,{onCancel:()=>V(!1),onCropComplete:e=>{H&&H(e),V(!1),R(!1)},aspectRatio:1,maxWidth:1200,maxHeight:1200})]})}export{N as D,y as a};
