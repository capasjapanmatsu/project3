import{j as e}from"./motion-CuO0nkIV.js";import{r as s}from"./react-vendor-cniURDpR.js";import{a as t,L as a}from"./router-Cg6wfOY4.js";import{B as l}from"./Button-CJFAG6V0.js";import{d as i,C as r,s as n,u as c}from"./index-DN5wQuSm.js";import{I as d}from"./Input-D3zjVn42.js";import{b4 as m,i as x,a4 as o,aL as h,ac as j,o as g,e as p,b0 as b,N as u,aT as N,h as v,j as f,b3 as y,J as w,U as _,b5 as k,aU as S,z as P,b6 as I}from"./ui-basic-CaMd9YQ-.js";import{g as C,a as R}from"./adminFraudDetection-Dj_DchBp.js";import M from"./AdminFacilityApproval-CRFvm4eZ.js";import{AdminParkManagement as F}from"./AdminParkManagement-CDibB6s5.js";import U from"./AdminVaccineApproval-C87zpkhB.js";import"./supabase-B0bqaRGb.js";import"./heavy-features-BIdEME4r.js";import"./Select-Dd_IZFKg.js";const q=({onError:t,onSuccess:a})=>{const{isMaintenanceActive:c,maintenanceInfo:b,loading:u,refreshMaintenanceStatus:N,clientIP:v,isIPWhitelisted:f}=i(),[y,w]=s.useState([]),[_,k]=s.useState([]),[S,P]=s.useState(!0),[I,C]=s.useState(!1),[R,M]=s.useState(!1),[F,U]=s.useState({title:"",message:"",start_time:"",end_time:"",is_emergency:!1}),[q,D]=s.useState({ip_address:"",description:""}),A=async()=>{try{P(!0);let{data:e,error:s}=await n.from("maintenance_schedules").select("*").order("created_at",{ascending:!1});if(s&&"42703"===s.code){const t=await n.from("maintenance_schedules").select("*").order("start_time",{ascending:!1});e=t.data||[],s=t.error}s&&"PGRST116"!==s.code||w(e||[]);const{data:t,error:a}=await n.from("ip_whitelist").select("*").order("created_at",{ascending:!1});a&&"PGRST116"!==a.code||k(t||[])}catch(e){t("メンテナンスデータの取得でエラーが発生しました")}finally{P(!1)}};s.useEffect(()=>{A()},[]);const L=async e=>{try{const s=(new Date).toISOString();let t=null;const{error:l}=await n.from("maintenance_schedules").update({is_active:!1,end_time:s}).eq("id",e);if(t=l,l){const{error:a}=await n.from("maintenance_schedules").update({status:"completed",end_date:s}).eq("id",e);t=a}if(t)throw t;a("メンテナンスを終了しました"),await A(),await N()}catch(s){t("メンテナンス終了でエラーが発生しました")}};return u||S?e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"メンテナンス設定を読み込み中..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(r,{className:"p-4 bg-blue-50 border-blue-200",children:e.jsx("p",{className:"text-sm text-blue-800",children:"この画面ではメンテナンス情報を作成・終了できます。メンテナンスを開始すると、管理者とホワイトリストIP以外のユーザーには「メンテナンス中」の画面が表示され、アプリの利用が制限されます。"})}),e.jsxs(r,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(m,{className:"w-5 h-5 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold",children:"現在の状態"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex items-center px-3 py-2 rounded-lg "+(c?"bg-red-100 text-red-800":"bg-green-100 text-green-800"),children:c?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"メンテナンス中"})]}):e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"正常稼働中"})]})}),v&&e.jsxs("div",{className:"flex items-center px-3 py-2 rounded-lg "+(f?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:["IP: ",v]}),f&&e.jsx("span",{className:"ml-1",children:"(ホワイトリスト)"})]})]}),b&&e.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-yellow-800",children:b.title}),e.jsx("p",{className:"text-yellow-700 mt-1",children:b.message}),e.jsx("div",{className:"flex justify-end mt-3",children:e.jsx(l,{size:"sm",onClick:()=>{L(b.id)},className:"bg-red-600 hover:bg-red-700 text-white",children:"メンテナンス終了"})})]})]}),e.jsxs(r,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{className:"w-5 h-5 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold",children:"メンテナンススケジュール"})]}),e.jsxs(l,{onClick:()=>C(!I),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"新規作成"]})]}),I&&e.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"新しいメンテナンススケジュール（アプリ全体）"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(d,{label:"タイトル",value:F.title,onChange:e=>U({...F,title:e.target.value}),placeholder:"メンテナンスのタイトル"}),e.jsx(d,{label:"開始時刻",type:"datetime-local",value:F.start_time,onChange:e=>U({...F,start_time:e.target.value})})]}),e.jsx("div",{className:"mt-4 text-sm text-gray-700",children:"このメンテナンスはアプリ全体に適用されます（ドッグラン個別は対象外）。"}),e.jsx("div",{className:"mt-4",children:e.jsx(d,{label:"メッセージ",value:F.message,onChange:e=>U({...F,message:e.target.value}),placeholder:"メンテナンス内容の説明"})}),e.jsx("div",{className:"mt-4",children:e.jsx(d,{label:"終了時刻（オプション）",type:"datetime-local",value:F.end_time,onChange:e=>U({...F,end_time:e.target.value})})}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:F.is_emergency,onChange:e=>U({...F,is_emergency:e.target.checked}),className:"mr-2"}),"緊急メンテナンス"]})}),e.jsxs("div",{className:"flex space-x-2 mt-4",children:[e.jsx(l,{onClick:()=>{(async()=>{try{if(!F.title||!F.message)return void t("タイトルとメッセージは必須です");const e=(new Date).toISOString(),s=[{title:F.title,description:F.message,start_date:F.start_time||e,end_date:F.end_time||null,status:"active"},{title:F.title,message:F.message,start_date:F.start_time||e,end_date:F.end_time||null,status:"active"},{title:F.title,message:F.message,start_time:F.start_time||e,end_time:F.end_time||null,is_active:!0},{title:F.title,description:F.message,start_time:F.start_time||e,end_time:F.end_time||null,is_active:!0},{name:F.title,description:F.message,start_date:F.start_time||e,end_date:F.end_time||null,status:"active"},{name:F.title,message:F.message,start_date:F.start_time||e,end_date:F.end_time||null,status:"active"},{name:F.title,description:F.message,start_time:F.start_time||e,end_time:F.end_time||null,is_active:!0}];let l=null;for(const t of s){const{error:e}=await n.from("maintenance_schedules").insert([t]);if(!e){l=null;break}l=e}if(l)throw l;if(F.is_emergency)try{await n.from("maintenance_schedules").update({is_emergency:!0}).order("created_at",{ascending:!1}).limit(1)}catch{}a("メンテナンススケジュールを作成しました"),C(!1),U({title:"",message:"",start_time:"",end_time:"",is_emergency:!1}),await A(),await N()}catch(e){t("スケジュール作成でエラーが発生しました")}})()},className:"bg-green-600 hover:bg-green-700",children:"作成"}),e.jsx(l,{variant:"secondary",onClick:()=>C(!1),children:"キャンセル"})]})]}),e.jsx("div",{className:"space-y-3",children:0===y.length?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"スケジュールがありません"}):y.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:s.message}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[e.jsxs("span",{children:["開始: ",s.start_time?new Date(s.start_time).toLocaleString():"未設定"]}),s.end_time&&e.jsxs("span",{children:["終了: ",new Date(s.end_time).toLocaleString()]}),s.is_emergency&&e.jsx("span",{className:"text-red-600 font-semibold",children:"緊急"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+(s.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:s.is_active?"アクティブ":"終了"}),s.is_active&&e.jsx(l,{size:"sm",onClick:()=>{L(s.id)},className:"bg-red-600 hover:bg-red-700 text-white",children:"終了"})]})]},s.id))})]}),e.jsxs(r,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{className:"w-5 h-5 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold",children:"IPホワイトリスト管理"})]}),e.jsxs(l,{onClick:()=>M(!R),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"IP追加"]})]}),R&&e.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"新しいIP追加"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(d,{label:"IPアドレス",value:q.ip_address,onChange:e=>D({...q,ip_address:e.target.value}),placeholder:"例: 192.168.1.1"}),e.jsx(d,{label:"説明",value:q.description,onChange:e=>D({...q,description:e.target.value}),placeholder:"このIPの説明"})]}),e.jsxs("div",{className:"flex space-x-2 mt-4",children:[e.jsx(l,{onClick:()=>{(async()=>{try{if(!q.ip_address)return void t("IPアドレスは必須です");const{error:e}=await n.from("ip_whitelist").insert([q]);if(e)throw e;a("IPをホワイトリストに追加しました"),M(!1),D({ip_address:"",description:""}),await A()}catch(e){t("IP追加でエラーが発生しました")}})()},className:"bg-green-600 hover:bg-green-700",children:"追加"}),e.jsx(l,{variant:"secondary",onClick:()=>M(!1),children:"キャンセル"})]})]}),e.jsx("div",{className:"space-y-3",children:0===_.length?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"ホワイトリストにIPがありません"}):_.map(s=>e.jsx("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s.ip_address}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description}),e.jsxs("p",{className:"text-xs text-gray-500",children:["追加日: ",new Date(s.created_at).toLocaleString()]})]})},s.id))})]})]})};function D(){const{user:i,isAdmin:d}=c(),m=t(),[h,j]=s.useState("overview"),[g,D]=s.useState({totalUsers:0,totalParks:0,pendingParks:0,pendingVaccines:0,pendingFacilities:0,totalReservations:0,monthlyRevenue:0,lastMonthRevenue:0,totalSubscriptions:0,activeSubscriptions:0,newUsersThisMonth:0,unreadMessages:0}),[A,L]=s.useState(!0),[T,V]=s.useState(""),[z,E]=s.useState(""),[H,J]=s.useState(null),[B,G]=s.useState([]);s.useEffect(()=>{d?(O(),Q(),W()):m("/")},[d,m]);const O=async()=>{try{L(!0),V(""),E("");const{count:e,error:s}=await n.from("vaccine_certifications").select("*",{count:"exact",head:!0}).eq("status","pending"),{data:t,error:a}=await n.rpc("get_admin_stats");if(a)throw a;const l=t;if(l){const s=null!==e?e:l.pending_vaccines||0;D({totalUsers:l.total_users||0,totalParks:l.total_parks||0,pendingParks:l.pending_parks||0,pendingVaccines:s,pendingFacilities:l.pending_facilities||0,totalReservations:l.total_reservations||0,monthlyRevenue:l.monthly_revenue||0,lastMonthRevenue:l.last_month_revenue||0,totalSubscriptions:l.total_subscriptions||0,activeSubscriptions:l.active_subscriptions||0,newUsersThisMonth:l.new_users_this_month||0,unreadMessages:l.unread_messages||0})}}catch(e){V("管理者データの取得に失敗しました。")}finally{L(!1)}},Q=async()=>{try{const{data:e,error:s}=await n.from("information_schema.tables").select("table_name").eq("table_schema","public").eq("table_name","fraud_detection_logs");if(s||!e||0===e.length)return void G([]);const[t]=await Promise.all([C()]);G(t)}catch(e){G([])}},W=async()=>{try{const{data:e,error:s}=await n.from("information_schema.tables").select("table_name").eq("table_schema","public").eq("table_name","fraud_detection_logs");if(s||!e||0===e.length)return void J(null);const t=await R();J(t)}catch(e){J(null)}},Y=()=>0===g.lastMonthRevenue?0:(g.monthlyRevenue-g.lastMonthRevenue)/g.lastMonthRevenue*100;return d?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(b,{className:"w-8 h-8 text-blue-600 mr-3"}),"管理者ダッシュボード"]}),e.jsx("p",{className:"text-gray-600",children:"システム全体の監視と管理"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-sm text-gray-600",children:["管理者: ",i?.email]})})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[T&&e.jsxs("div",{className:"bg-red-100 border border-red-300 text-red-800 rounded-lg p-4 mb-6",children:[e.jsx(x,{className:"w-5 h-5 inline mr-2"}),T]}),z&&e.jsxs("div",{className:"bg-green-100 border border-green-300 text-green-800 rounded-lg p-4 mb-6",children:[e.jsx(o,{className:"w-5 h-5 inline mr-2"}),z]}),(g.pendingParks>0||g.pendingVaccines>0||g.pendingFacilities>0||(H?.totalHighRiskUsers||0)>0)&&e.jsxs(r,{className:"p-6 mb-6 border-red-200 bg-red-50",children:[e.jsxs("h2",{className:"text-lg font-semibold text-red-900 mb-4 flex items-center",children:[e.jsx(x,{className:"w-6 h-6 text-red-600 mr-2"}),"緊急対応が必要な項目"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[g.pendingParks>0&&e.jsx(a,{to:"/admin/parks",className:"block",children:e.jsx("div",{className:"bg-white rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"承認待ちドッグラン"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:g.pendingParks})]}),e.jsx(u,{className:"w-8 h-8 text-red-500"})]})})}),g.pendingVaccines>0&&e.jsx(a,{to:"/admin/vaccine-approval",className:"block",children:e.jsx("div",{className:"bg-white rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ワクチン証明書承認待ち"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:g.pendingVaccines})]}),e.jsx(p,{className:"w-8 h-8 text-red-500"})]})})}),e.jsx(a,{to:"/admin/facility-approval",className:"block",children:e.jsx("div",{className:"bg-white rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"施設承認管理"}),e.jsx("p",{className:"text-2xl font-bold "+(g.pendingFacilities>0?"text-red-600":"text-green-600"),children:g.pendingFacilities>0?g.pendingFacilities:"0"}),e.jsx("p",{className:"text-xs text-gray-500",children:g.pendingFacilities>0?"件の承認待ち":"承認待ちなし"})]}),e.jsx(u,{className:"w-8 h-8 "+(g.pendingFacilities>0?"text-red-500":"text-green-500")})]})})}),(H?.totalHighRiskUsers||0)>0&&e.jsx(a,{to:"/admin/users?filter=high_risk",className:"block",children:e.jsx("div",{className:"bg-white rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"高リスクユーザー"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:H?.totalHighRiskUsers||0})]}),e.jsx(N,{className:"w-8 h-8 text-red-500"})]})})}),e.jsx(a,{to:"/admin/inquiries",className:"block",children:e.jsx("div",{className:"bg-white rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"新着メッセージ"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:g.unreadMessages||0})]}),e.jsx(v,{className:"w-8 h-8 text-blue-500"})]})})})]}),B.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-md font-semibold text-red-900 mb-3",children:"最新の高リスクユーザー"}),e.jsx("div",{className:"bg-white rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"ユーザー"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"リスクスコア"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"検知タイプ"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"最終検知"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"アクション"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:B.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.userName}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email})]})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full "+("high"===s.riskLevel?"bg-red-100 text-red-800":"medium"===s.riskLevel?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:s.riskScore})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.detectionTypes.join(", ")})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("div",{className:"text-sm text-gray-900",children:new Date(s.lastDetection).toLocaleDateString("ja-JP")})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(a,{to:"/admin/users?filter=high_risk",children:e.jsxs(l,{variant:"secondary",size:"sm",children:[e.jsx(f,{className:"w-4 h-4 mr-1"}),"詳細"]})})})]},s.userId))})]})})]})]}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:[{id:"overview",label:"概要",icon:y},{id:"pages",label:"ページ管理",icon:w},{id:"parks",label:"ドッグラン",icon:u,badge:g.pendingParks},{id:"facilities",label:"その他施設",icon:u,badge:g.pendingFacilities},{id:"users",label:"ユーザー",icon:_},{id:"vaccine-approval",label:"ワクチン",icon:p,badge:g.pendingVaccines}].map(s=>{const t=s.icon,a=void 0!==s.badge&&s.badge>0;return e.jsxs("button",{onClick:()=>j(s.id),className:"relative inline-flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+(h===s.id?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:[e.jsx(t,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:s.label}),a&&e.jsx("span",{className:"ml-2 inline-flex items-center justify-center text-white text-xs font-bold rounded-full min-w-[22px] h-[22px] px-1.5 bg-red-500 shadow-lg animate-pulse",children:s.badge})]},s.id)})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{id:"fraud",label:"不正検知",icon:N},{id:"maintenance",label:"メンテナンス",icon:b},{id:"sponsors",label:"スポンサー",icon:k},{id:"news-link",label:"新着情報",icon:w,to:"/admin/news"},{id:"inquiries",label:"お問い合わせ",icon:v},{id:"sales-link",label:"売り上げ管理",icon:S,to:"/admin/sales-overview"},{id:"shop-link",label:"ショップ管理",icon:P,to:"/admin/shop"}].map(s=>{const t=s.icon;return s.to?e.jsxs(a,{to:s.to,className:"relative flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors no-underline hover:no-underline text-gray-600 hover:text-blue-700 hover:bg-blue-50",children:[e.jsx(t,{className:"w-4 h-4 mr-2"}),s.label]},s.id):e.jsxs("button",{onClick:()=>j(s.id),className:"relative flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-colors "+(h===s.id?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:[e.jsx(t,{className:"w-4 h-4 mr-2"}),s.label]},s.id)})})]}),"overview"===h&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"総ユーザー数"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.totalUsers}),e.jsxs("p",{className:"text-sm text-green-600",children:["今月 +",g.newUsersThisMonth,"人"]})]}),e.jsx(_,{className:"w-8 h-8 text-blue-500"})]})}),e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"総ドッグラン数"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.totalParks}),g.pendingParks>0&&e.jsxs("p",{className:"text-sm text-orange-600",children:["承認待ち ",g.pendingParks,"件"]})]}),e.jsx(u,{className:"w-8 h-8 text-green-500"})]})}),e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"月間売上"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(K=g.monthlyRevenue,new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY"}).format(K))}),e.jsxs("p",{className:"text-sm "+(Y()>=0?"text-green-600":"text-red-600"),children:["前月比 ",Y()>=0?"+":"",Y().toFixed(1),"%"]})]}),e.jsx(S,{className:"w-8 h-8 text-yellow-500"})]})}),e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"アクティブサブスクリプション"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.activeSubscriptions}),e.jsxs("p",{className:"text-sm text-gray-600",children:["総数 ",g.totalSubscriptions,"件"]})]}),e.jsx(I,{className:"w-8 h-8 text-purple-500"})]})})]}),e.jsxs(r,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"クイックアクション"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(a,{to:"/admin/users",children:e.jsxs(l,{className:"w-full justify-start",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"ユーザー管理"]})}),e.jsx(a,{to:"/admin/parks",children:e.jsxs(l,{className:"w-full justify-start",children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"ドッグラン管理"]})}),e.jsx(a,{to:"/admin/sales",children:e.jsxs(l,{className:"w-full justify-start",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"売上レポート"]})}),e.jsx(a,{to:"/admin/shop",children:e.jsxs(l,{className:"w-full justify-start",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"ショップ管理"]})})]})]})]}),"pages"===h&&e.jsx("div",{className:"space-y-6",children:e.jsxs(r,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ページ管理"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"p-4 bg-white rounded-lg border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsx("h4",{className:"font-medium text-gray-900",children:"ランディングページ"})}),e.jsx(a,{to:"/landing",target:"_blank",children:e.jsx(l,{className:"bg-blue-600 hover:bg-blue-700",children:"開く"})})]})}),e.jsx("div",{className:"p-4 bg-white rounded-lg border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"スポンサー向け案内"}),e.jsx("p",{className:"text-sm text-gray-600",children:"金額・プラン記載の説明ページ"})]}),e.jsx(a,{to:"/sponsor-application",target:"_blank",children:e.jsx(l,{className:"bg-blue-600 hover:bg-blue-700",children:"開く"})})]})})]})]})}),"fraud"===h&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"高リスクユーザー"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:H?.totalHighRiskUsers||0})]}),e.jsx(N,{className:"w-8 h-8 text-red-500"})]})}),e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"中リスクユーザー"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:H?.totalMediumRiskUsers||0})]}),e.jsx(x,{className:"w-8 h-8 text-yellow-500"})]})}),e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"最近の検知"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:H?.recentDetections||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"過去30日"})]}),e.jsx(f,{className:"w-8 h-8 text-blue-500"})]})}),e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ブロック済み"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:H?.blockedAttempts||0})]}),e.jsx(p,{className:"w-8 h-8 text-green-500"})]})}),e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"トライアル悪用"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:H?.trialAbuseCount||0})]}),e.jsx(x,{className:"w-8 h-8 text-purple-500"})]})})]}),e.jsxs(r,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"不正検知管理"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 bg-red-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-900",children:"高リスクユーザーの監視"}),e.jsx("p",{className:"text-sm text-red-700",children:"リスクスコア70以上のユーザーを定期的に確認し、必要に応じて制限措置を実施してください。"})]}),e.jsx(a,{to:"/admin/users?filter=high_risk",children:e.jsxs(l,{className:"bg-red-600 hover:bg-red-700",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"確認する"]})})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 bg-yellow-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-yellow-900",children:"中リスクユーザーの監視"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"リスクスコア50-69のユーザーの動向を監視し、パターンを分析してください。"})]}),e.jsx(a,{to:"/admin/users?filter=medium_risk",children:e.jsxs(l,{variant:"secondary",children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),"確認する"]})})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"全ユーザー管理"}),e.jsx("p",{className:"text-sm text-blue-700",children:"すべてのユーザーの不正検知状況を確認し、総合的な監視を行います。"})]}),e.jsx(a,{to:"/admin/users",children:e.jsxs(l,{variant:"secondary",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"ユーザー一覧"]})})]})]})]})]}),"sponsors"===h&&e.jsxs(r,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"スポンサー広告お問い合わせ管理"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"スポンサー広告のお問い合わせを管理できます。"}),e.jsx(a,{to:"/admin/sponsors",className:"text-blue-600 hover:text-blue-800",children:"詳細な管理画面へ →"})]}),"facilities"===h&&e.jsx(M,{}),"parks"===h&&e.jsx(F,{}),"vaccine-approval"===h&&e.jsx(U,{}),"users"===h&&e.jsxs(r,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"ユーザー管理"}),e.jsxs("p",{className:"text-gray-600",children:["詳細なユーザー管理は",e.jsx(a,{to:"/admin/users",className:"text-blue-600 hover:text-blue-800 mx-1",children:"ユーザー管理ページ"}),"で行えます。"]})]}),"maintenance"===h&&e.jsx("div",{children:e.jsx(q,{onError:V,onSuccess:E})}),"inquiries"===h&&e.jsxs(r,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"お問い合わせ（ユーザー⇄管理者）"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"ユーザーからの問い合わせ・DMを一覧管理します。"}),e.jsx(a,{to:"/admin/inquiries",className:"inline-block",children:e.jsxs(l,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"お問い合わせ一覧へ"]})})]})]})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs(r,{className:"p-8 text-center",children:[e.jsx(p,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"アクセス拒否"}),e.jsx("p",{className:"text-gray-600",children:"管理者権限が必要です。"})]})});var K}export{D as AdminDashboard};
