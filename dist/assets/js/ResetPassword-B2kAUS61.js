import{j as e}from"./motion-BHsL7Azw.js";import{c as s}from"./supabase--qivnNSU.js";import{r as t}from"./react-vendor-CMvmJHsS.js";import{a as r}from"./router-DXQOdrLL.js";const a=s("https://onmcivwxtzqajcovptgf.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9ubWNpdnd4dHpxYWpjb3ZwdGdmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkxODk3OTUsImV4cCI6MjA2NDc2NTc5NX0.AqFCz3GQUVeGaG2988LCzsE4aJpeio3xScoxv5T0-OU",{auth:{persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1}}),o=()=>{const s=r(),[o,n]=t.useState(""),[i,l]=t.useState(""),[c,d]=t.useState(""),[u,m]=t.useState(!1),[b,h]=t.useState(!1),[x,g]=t.useState(!0),[p,f]=t.useState(null);t.useEffect(()=>{(()=>{try{g(!0);const e=new URLSearchParams(window.location.hash.substring(1)),s=e.get("access_token"),t=e.get("refresh_token");if("recovery"===e.get("type")&&s&&t)f(s),h(!0),d("âœ… èªè¨¼ãŒå®Œäº†ã—ã¾ã—ãŸã€‚æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚"),window.history.replaceState({},document.title,window.location.pathname);else{const e=new URLSearchParams(window.location.search),s=e.get("token");"recovery"===e.get("type")&&s?(f(s),h(!0),d("âœ… æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚")):(d("âŒ ç„¡åŠ¹ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆãƒªãƒ³ã‚¯ã§ã™ã€‚å†åº¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆã‚’è¡Œã£ã¦ãã ã•ã„ã€‚"),h(!1))}}catch(e){d("âŒ èªè¨¼å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚"),h(!1)}finally{g(!1)}})()},[]);return x?e.jsx("div",{className:"max-w-md mx-auto mt-10 p-6 bg-white rounded shadow",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"èªè¨¼æƒ…å ±ã‚’ç¢ºèªä¸­..."})]})}):e.jsxs("div",{className:"max-w-md mx-auto mt-10 p-6 bg-white rounded shadow",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®š"}),c&&e.jsx("div",{className:"mb-4 p-4 rounded-lg border "+(c.includes("âœ…")||c.includes("è¨­å®šã—ã¦ãã ã•ã„")?"text-green-700 bg-green-100 border-green-300":c.includes("âŒ")?"text-red-700 bg-red-100 border-red-300":c.includes("ğŸ”„")?"text-blue-700 bg-blue-100 border-blue-300":"text-gray-700 bg-gray-100 border-gray-300"),children:e.jsx("p",{className:"text-sm",children:c})}),b?e.jsxs("form",{onSubmit:e=>{(async e=>{if(e.preventDefault(),o===i)if(o.length<6)d("âŒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯6æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");else if(p){m(!0),d("ğŸ”„ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ›´æ–°ä¸­...");try{const{error:e}=await a.auth.setSession({access_token:p,refresh_token:p});if(e)throw e;const{error:t}=await a.auth.updateUser({password:o});if(t)throw t;await a.auth.signOut(),d("âœ… ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£å¸¸ã«å¤‰æ›´ã•ã‚Œã¾ã—ãŸï¼ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«ç§»å‹•ã—ã¾ã™..."),"Notification"in window&&"granted"===Notification.permission&&new Notification("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´å®Œäº†",{body:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£å¸¸ã«å¤‰æ›´ã•ã‚Œã¾ã—ãŸã€‚æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚",icon:"/favicon.svg"}),setTimeout(()=>{s("/login")},3e3)}catch(t){const e=t instanceof Error?t.message:"ä¸æ˜ãªã‚¨ãƒ©ãƒ¼";e.includes("session_not_found")?d("âŒ ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆã‚’æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã—ã¦ãã ã•ã„ã€‚"):e.includes("invalid_token")?d("âŒ ç„¡åŠ¹ãªãƒˆãƒ¼ã‚¯ãƒ³ã§ã™ã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆã‚’æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã—ã¦ãã ã•ã„ã€‚"):e.includes("Token has expired")?d("âŒ ãƒªã‚»ãƒƒãƒˆãƒªãƒ³ã‚¯ã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚Œã¦ã„ã¾ã™ã€‚æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆã‚’è¡Œã£ã¦ãã ã•ã„ã€‚"):d(`âŒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ: ${e}`)}finally{m(!1)}}else d("âŒ ãƒªã‚»ãƒƒãƒˆãƒˆãƒ¼ã‚¯ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å†åº¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆã‚’è¡Œã£ã¦ãã ã•ã„ã€‚");else d("âŒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“ã€‚")})(e)},children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ *"}),e.jsx("input",{type:"password",className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:o,onChange:e=>n(e.target.value),required:!0,minLength:6,placeholder:"6æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèª *"}),e.jsx("input",{type:"password",className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:i,onChange:e=>l(e.target.value),required:!0,minLength:6,placeholder:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å†å…¥åŠ›ã—ã¦ãã ã•ã„"})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",disabled:u,children:u?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"æ›´æ–°ä¸­..."]}):"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´"})]}):e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"âš ï¸"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆãƒªãƒ³ã‚¯ãŒç„¡åŠ¹ã¾ãŸã¯æœŸé™åˆ‡ã‚Œã§ã™ã€‚"})]}),e.jsx("button",{onClick:()=>s("/forgot-password"),className:"w-full bg-gray-600 text-white py-3 px-4 rounded-lg hover:bg-gray-700 transition-colors",children:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆã‚’å†å®Ÿè¡Œ"})]})]})};export{o as default};
