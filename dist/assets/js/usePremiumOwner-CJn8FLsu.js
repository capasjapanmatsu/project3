import{u as e,s as t}from"./index-Cxr3hxlQ.js";import{r}from"./react-vendor-cniURDpR.js";function i(){const{user:i}=e(),[s,a]=r.useState("loading"),[c,o]=r.useState(""),n="price_1S1xlxAHWLDQ7ynZEPzFnGJf";r.useEffect(()=>{let e=!0;return(async()=>{try{if(!i)return void(e&&a("inactive"));let{data:r,error:s}=await t.from("stripe_user_subscriptions").select("status, price_id").maybeSingle();if((s||!r)&&s?.message)try{const e=await t.from("user_subscriptions").select("status, product_key, price_id").eq("user_id",i.id).order("created_at",{ascending:!1}).limit(1).maybeSingle();r=e.data,s=e.error}catch{}if(s)throw s;const c=r?.status;if(!e)return;a(!!r&&("active"===c||"trialing"===c)&&(r?.price_id===n||!0)?"active":"inactive")}catch(r){if(!e)return;o(r?.message||"failed to load"),a("error")}})(),()=>{e=!1}},[i]);const u=r.useMemo(()=>"active"===s,[s]);return{state:s,isActive:u,error:c}}export{i as u};
