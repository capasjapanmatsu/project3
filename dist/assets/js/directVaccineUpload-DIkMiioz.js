import{s as e}from"./index-CGsnfrXi.js";import"./motion-BHsL7Azw.js";import"./react-vendor-CMvmJHsS.js";import"./heavy-features-Dlg1c9Yc.js";import"./router-DXQOdrLL.js";import"./supabase-D2tiogv8.js";import"./ui-basic-C77EGLVg.js";const t=async(t,r,s="vaccine-certs")=>{try{if(!(r&&r instanceof File))throw new Error("無効なファイルです");let a=r.type;if(!a||"application/octet-stream"===a){const e=r.name.split(".").pop()?.toLowerCase();switch(e){case"jpg":case"jpeg":a="image/jpeg";break;case"png":a="image/png";break;case"gif":a="image/gif";break;case"webp":a="image/webp";break;default:throw new Error(`サポートされていないファイル形式: ${e}`)}}if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(a))throw new Error(`サポートされていないMIMEタイプ: ${a}`);const{data:{session:o},error:i}=await e.auth.getSession();if(i)throw new Error("認証エラーが発生しました");if(!o?.access_token)throw new Error("認証されていません。ログインしてください。");const c=o.access_token,n=`${"https://onmcivwxtzqajcovptgf.supabase.co"}/storage/v1/object/${s}/${t}`,p=await fetch(n,{method:"PUT",headers:{Authorization:`Bearer ${c}`,"Content-Type":a,"Cache-Control":"3600","x-upsert":"true"},body:r});if(!p.ok){await p.text();throw 520===p.status?new Error("一時的なサーバーエラーが発生しました。しばらく待ってから再度お試しください。"):p.status>=500?new Error(`サーバーエラーが発生しました (${p.status})。しばらく待ってから再度お試しください。`):new Error(`アップロードに失敗しました: ${p.status} ${p.statusText}`)}await p.json();const{data:{publicUrl:g}}=e.storage.from(s).getPublicUrl(t);return{success:!0,url:g}}catch(a){return{success:!1,error:a.message}}};export{t as directVaccineUpload};
