var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,c=(e,s)=>{for(var a in s||(s={}))r.call(s,a)&&n(e,a,s[a]);if(t)for(var a of t(s))l.call(s,a)&&n(e,a,s[a]);return e},i=(e,t)=>s(e,a(t)),d=(e,s,a)=>new Promise(((t,r)=>{var l=e=>{try{c(a.next(e))}catch(s){r(s)}},n=e=>{try{c(a.throw(e))}catch(s){r(s)}},c=e=>e.done?t(e.value):Promise.resolve(e.value).then(l,n);c((a=a.apply(e,s)).next())}));import{u as x,j as m,C as o,B as h}from"./index.oOj2R_C7.js";import{u as j,r as u}from"./router.icJHpBzt.js";import{A as g,aD as p,f as v,az as b,q as f,t as y,g as N,h as w}from"./ui.UnEvinBv.js";import"./vendor.D1SiiUJb.js";import"./supabase.CZ8ekJUM.js";function _(){const{user:e,isAdmin:s}=x(),a=j(),[t,r]=u.useState([]),[l,n]=u.useState(!0),[_,S]=u.useState(""),[k,P]=u.useState("all"),[D,O]=u.useState(null),[C,J]=u.useState(!1),[L,z]=u.useState(""),[A,E]=u.useState(!1);u.useEffect((()=>{s?T():a("/")}),[s,a]);const T=()=>d(null,null,(function*(){try{n(!0),S("");r([{id:"1",dog_name:"ポチ",owner_name:"田中太郎",vaccine_type:"狂犬病ワクチン",vaccine_date:"2025-07-10",veterinarian:"○○動物病院",status:"pending",created_at:"2025-07-15T10:30:00Z"},{id:"2",dog_name:"ハナ",owner_name:"佐藤花子",vaccine_type:"混合ワクチン",vaccine_date:"2025-07-12",veterinarian:"△△ペットクリニック",status:"pending",created_at:"2025-07-15T11:00:00Z"}])}catch(e){S("ワクチン証明書データの取得に失敗しました")}finally{n(!1)}})),Z=t.filter((e=>"all"===k||e.status===k)),$=e=>{switch(e){case"pending":return"text-yellow-600 bg-yellow-50";case"approved":return"text-green-600 bg-green-50";case"rejected":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}},q=e=>{switch(e){case"pending":return"承認待ち";case"approved":return"承認済み";case"rejected":return"却下";default:return"不明"}};return s?m.jsxs("div",{className:"max-w-7xl mx-auto p-4",children:[m.jsxs("div",{className:"mb-8",children:[m.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"ワクチン証明書 承認管理"}),m.jsx("p",{className:"text-gray-600",children:"登録されたワクチン証明書の承認・却下を管理します。"})]}),_&&m.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:m.jsxs("div",{className:"flex items-center",children:[m.jsx(g,{className:"w-5 h-5 text-red-500 mr-2"}),m.jsx("span",{className:"text-red-700",children:_})]})}),m.jsx("div",{className:"mb-6",children:m.jsx("div",{className:"flex space-x-4",children:[{key:"all",label:"すべて",count:t.length},{key:"pending",label:"承認待ち",count:t.filter((e=>"pending"===e.status)).length},{key:"approved",label:"承認済み",count:t.filter((e=>"approved"===e.status)).length},{key:"rejected",label:"却下",count:t.filter((e=>"rejected"===e.status)).length}].map((({key:e,label:s,count:a})=>m.jsxs("button",{onClick:()=>P(e),className:"px-4 py-2 rounded-lg font-medium transition-colors "+(k===e?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:[s," (",a,")"]},e)))})}),l?m.jsx("div",{className:"flex justify-center items-center h-64",children:m.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Z.map((e=>m.jsxs(o,{className:"p-6 hover:shadow-lg transition-shadow",children:[m.jsxs("div",{className:"flex items-center justify-between mb-4",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(p,{className:"w-5 h-5 text-blue-600"}),m.jsx("h3",{className:"font-semibold text-lg",children:e.dog_name})]}),m.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${$(e.status)}`,children:q(e.status)})]}),m.jsxs("div",{className:"space-y-2 mb-4",children:[m.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[m.jsx(v,{className:"w-4 h-4 mr-2"}),m.jsx("span",{children:e.owner_name})]}),m.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[m.jsx(b,{className:"w-4 h-4 mr-2"}),m.jsx("span",{children:e.vaccine_type})]}),m.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[m.jsx(f,{className:"w-4 h-4 mr-2"}),m.jsx("span",{children:new Date(e.vaccine_date).toLocaleDateString("ja-JP")})]})]}),m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("button",{onClick:()=>{O(e),J(!0)},className:"flex items-center text-blue-600 hover:text-blue-800 transition-colors",children:[m.jsx(y,{className:"w-4 h-4 mr-1"}),"詳細"]}),m.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString("ja-JP")})]})]},e.id)))}),C&&D&&m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:m.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[m.jsx("div",{className:"p-6 border-b",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("h2",{className:"text-xl font-semibold",children:"ワクチン証明書詳細"}),m.jsx("button",{onClick:()=>J(!1),className:"text-gray-400 hover:text-gray-600",children:m.jsx(N,{className:"w-6 h-6"})})]})}),m.jsxs("div",{className:"p-6",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"基本情報"}),m.jsxs("div",{className:"space-y-2 text-sm",children:[m.jsxs("div",{children:[m.jsx("strong",{children:"犬の名前:"})," ",D.dog_name]}),m.jsxs("div",{children:[m.jsx("strong",{children:"飼い主:"})," ",D.owner_name]}),m.jsxs("div",{children:[m.jsx("strong",{children:"ワクチン種別:"})," ",D.vaccine_type]}),m.jsxs("div",{children:[m.jsx("strong",{children:"接種日:"})," ",new Date(D.vaccine_date).toLocaleDateString("ja-JP")]}),m.jsxs("div",{children:[m.jsx("strong",{children:"動物病院:"})," ",D.veterinarian]})]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"ステータス"}),m.jsxs("div",{className:"space-y-2 text-sm",children:[m.jsxs("div",{children:[m.jsx("strong",{children:"現在の状態:"}),m.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs ${$(D.status)}`,children:q(D.status)})]}),m.jsxs("div",{children:[m.jsx("strong",{children:"申請日:"})," ",new Date(D.created_at).toLocaleDateString("ja-JP")]}),D.admin_notes&&m.jsxs("div",{children:[m.jsx("strong",{children:"管理者メモ:"})," ",D.admin_notes]})]})]})]}),"pending"===D.status&&m.jsxs("div",{children:[m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"却下理由 (却下する場合のみ)"}),m.jsx("textarea",{value:L,onChange:e=>z(e.target.value),rows:3,placeholder:"却下する理由を入力してください",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),m.jsxs("div",{className:"flex justify-end space-x-3",children:[m.jsxs(h,{onClick:()=>{return e=D.id,d(null,null,(function*(){try{E(!0),S(""),r((s=>s.map((s=>s.id===e?i(c({},s),{status:"approved"}):s)))),J(!1),O(null)}catch(s){S("ワクチン証明書の承認に失敗しました")}finally{E(!1)}}));var e},disabled:A,className:"bg-green-600 hover:bg-green-700",children:[m.jsx(w,{className:"w-4 h-4 mr-1"}),"承認する"]}),m.jsxs(h,{onClick:()=>{return e=D.id,d(null,null,(function*(){if(L.trim())try{E(!0),S(""),r((s=>s.map((s=>s.id===e?i(c({},s),{status:"rejected",admin_notes:L}):s)))),J(!1),O(null),z("")}catch(s){S("ワクチン証明書の却下に失敗しました")}finally{E(!1)}else S("却下理由を入力してください")}));var e},disabled:A,className:"bg-red-600 hover:bg-red-700",children:[m.jsx(N,{className:"w-4 h-4 mr-1"}),"却下する"]})]})]})]})]})})]}):m.jsx("div",{className:"max-w-4xl mx-auto p-4",children:m.jsx(o,{className:"p-6",children:m.jsxs("div",{className:"flex items-center justify-center",children:[m.jsx(g,{className:"w-12 h-12 text-red-500 mr-4"}),m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-semibold text-red-700",children:"アクセス権限がありません"}),m.jsx("p",{className:"text-red-600",children:"このページは管理者のみアクセス可能です。"})]})]})})})}export{_ as default};
