/*! Build: 2025-07-17T07:59:15.523Z
Version: 0.0.0 */
import{r as e,j as s,L as t,f as r,aM as a,n as l,A as c,G as n,z as i,p as d}from"./vendor-react.D8SVeCGP.js";import{B as x,C as m}from"./components-admin.GT3qRZg5.js";import{t as u,l as o,m as h,q as p}from"./utils.C9ZsMnW6.js";import"./vendor-misc.qnLj5toF.js";import"./hooks.CTtJlocA.js";import"./vendor-stripe.B5MJ2ewd.js";import"./pages-dog.BrfoFXaJ.js";import"./vendor-supabase.RBPF72ft.js";function j({id:l,onStatusChange:c,className:n=""}){const[i,d]=e.useState(null),[m,h]=e.useState(!1),[p,j]=e.useState(null),y=e.useCallback((async()=>{if(l)try{h(!0),j(null);const e=await u({id:l});d(e),c&&c(e)}catch(e){o("error","Error checking deployment status:",{error:e}),j(e.message||"デプロイステータスの取得に失敗しました")}finally{h(!1)}}),[l,c]);return e.useEffect((()=>{l&&y()}),[l,y]),m?s.jsxs("div",{className:`flex items-center space-x-2 ${n}`,children:[s.jsx(t,{className:"w-4 h-4 text-blue-600 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600",children:"ステータスを確認中..."})]}):p?s.jsxs("div",{className:`flex items-center space-x-2 ${n}`,children:[s.jsx(r,{className:"w-4 h-4 text-red-600"}),s.jsx("span",{className:"text-sm text-red-600",children:p}),s.jsx(x,{size:"sm",variant:"secondary",onClick:()=>{y()},children:"再試行"})]}):i?s.jsxs("div",{className:`space-y-2 ${n}`,children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"ステータス:"}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(e=>{switch(e){case"ready":return"text-green-600 bg-green-100";case"error":case"failed":return"text-red-600 bg-red-100";case"building":case"enqueued":case"processing":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}})(i.status||"")}`,children:(e=>{switch(e){case"ready":return"完了";case"error":case"failed":return"失敗";case"building":return"ビルド中";case"enqueued":return"待機中";case"processing":return"処理中";default:return e}})(i.status||"")})]}),i.deploy_url&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"URL:"}),s.jsxs("a",{href:i.deploy_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 flex items-center",children:[i.deploy_url.replace(/^https?:\/\//,""),s.jsx(a,{className:"w-3 h-3 ml-1"})]})]}),s.jsx(x,{size:"sm",variant:"secondary",onClick:()=>{y()},children:"更新"})]}):s.jsx("div",{className:`flex items-center space-x-2 ${n}`,children:s.jsx(x,{size:"sm",onClick:()=>{y()},children:"ステータスを確認"})})}function y(){const[t,u]=e.useState([]),[o,y]=e.useState(!0);e.useEffect((()=>{(()=>{try{const e=h("deploymentHistory");e&&u(JSON.parse(e))}catch(e){}finally{y(!1)}})()}),[]);const f=e=>{switch(e){case"ready":return"text-green-600 bg-green-100";case"error":case"failed":return"text-red-600 bg-red-100";case"building":case"enqueued":case"processing":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}},b=e=>{switch(e){case"ready":return"完了";case"error":case"failed":return"失敗";case"building":return"ビルド中";case"enqueued":return"待機中";case"processing":return"処理中";default:return e}};return o?s.jsx("div",{className:"flex justify-center items-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[s.jsx("div",{className:"flex items-center space-x-4 mb-6",children:s.jsxs(l,{to:"/deploy",className:"flex items-center text-gray-600 hover:text-gray-800 transition-colors",children:[s.jsx(c,{className:"w-4 h-4 mr-2"}),"デプロイページに戻る"]})}),s.jsxs("div",{className:"text-center mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-4 flex items-center justify-center",children:[s.jsx(n,{className:"w-8 h-8 text-blue-600 mr-3"}),"デプロイ履歴"]}),s.jsx("p",{className:"text-lg text-gray-600",children:"過去のデプロイ履歴を確認できます"})]}),error&&s.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start",children:[s.jsx(r,{className:"w-5 h-5 text-red-600 mt-0.5 mr-3 flex-shrink-0"}),s.jsx("p",{className:"text-red-800",children:error})]}),0===t.length?s.jsxs(m,{className:"p-6 text-center",children:[s.jsx(i,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"デプロイ履歴がありません"}),s.jsx("p",{className:"text-gray-500 mb-6",children:"まだデプロイを行っていないようです"}),s.jsx(l,{to:"/deploy",children:s.jsxs(x,{children:[s.jsx(n,{className:"w-4 h-4 mr-2"}),"デプロイを開始する"]})})]}):s.jsx("div",{className:"space-y-4",children:t.map((e=>s.jsx(m,{className:"p-6",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f(e.status)}`,children:b(e.status)}),s.jsx("span",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleString("ja-JP")})]}),s.jsxs("h3",{className:"font-semibold mb-2",children:["デプロイID: ",e.id]}),e.deploy_url&&s.jsxs("a",{href:e.deploy_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 flex items-center",children:[e.deploy_url.replace(/^https?:\/\//,""),s.jsx(a,{className:"w-3 h-3 ml-1"})]})]}),s.jsx(j,{id:e.id,onStatusChange:s=>{return r=e.id,a=s,u((e=>e.map((e=>e.id===r?{...e,status:a.status||e.status,deploy_url:a.deploy_url||e.deploy_url}:e)))),void p("deploymentHistory",JSON.stringify(t.map((e=>e.id===r?{...e,status:a.status||e.status,deploy_url:a.deploy_url||e.deploy_url}:e))));var r,a}})]})},e.id)))}),s.jsx(m,{className:"p-6 bg-blue-50 border-blue-200",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(d,{className:"w-6 h-6 text-blue-600 mt-1"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"デプロイ履歴について"}),s.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[s.jsx("p",{children:"• デプロイ履歴はブラウザのローカルストレージに保存されます"}),s.jsx("p",{children:"• 別のブラウザやデバイスでは履歴が共有されません"}),s.jsx("p",{children:"• 各デプロイの最新ステータスを確認できます"}),s.jsx("p",{children:"• 「更新」ボタンをクリックすると最新の状態を取得します"})]})]})]})})]})}export{y as DeploymentHistory};
