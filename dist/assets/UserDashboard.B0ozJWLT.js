/*! Build: 2025-07-17T07:59:15.523Z
Version: 0.0.0 */
import{j as e,P as s,i as a,W as t,C as l,B as r,ak as i,p as n,$ as c,k as d,f as o,z as m,X as x,n as g,a as h,v as u,ad as p,b4 as j,aD as N,b5 as b,b6 as f,u as v,aF as w,r as y,J as _,M as k,o as D,s as S,ag as C}from"./vendor-react.D8SVeCGP.js";import{C as E,B as F,u as R}from"./components-admin.GT3qRZg5.js";import{D as $,a as q}from"./pages-dog.BrfoFXaJ.js";import{c as V}from"./hooks.CTtJlocA.js";import{s as I,v as M,k as U}from"./utils.C9ZsMnW6.js";import"./vendor-misc.qnLj5toF.js";import"./vendor-stripe.B5MJ2ewd.js";import"./vendor-supabase.RBPF72ft.js";const P=({dogs:a,user:t,selectedDog:l,showDogEditModal:r,isUpdatingDog:i,dogUpdateError:n,dogUpdateSuccess:c,dogFormData:d,dogImageFile:o,dogImagePreview:m,rabiesVaccineFile:x,comboVaccineFile:g,rabiesExpiryDate:h,comboExpiryDate:u,onDogSelect:p,onCloseDogEditModal:j,onUpdateDog:N,onDeleteDog:b,onDogImageSelect:f,onDogImageRemove:v,onRabiesVaccineSelect:w,onComboVaccineSelect:y,onFormDataChange:_,onRabiesExpiryDateChange:k,onComboExpiryDateChange:D})=>e.jsxs(E,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ•"}),"ç™»éŒ²æ¸ˆã¿ã®æ„›çŠ¬"]}),e.jsxs("a",{href:"/register-dog",className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-md text-sm font-medium inline-flex items-center",children:[e.jsx(s,{className:"w-4 h-4 mr-2"}),"æ„›çŠ¬ã‚’ç™»éŒ²"]})]}),0===a.length?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ•"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"ã¾ã æ„›çŠ¬ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“"}),e.jsx("p",{className:"text-sm mb-4",children:"ãƒ‰ãƒƒã‚°ãƒ©ãƒ³ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã«ã€æ„›çŠ¬ã®æƒ…å ±ã‚’ç™»éŒ²ã—ã¦ãã ã•ã„"}),e.jsxs("a",{href:"/register-dog",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md font-medium inline-flex items-center",children:[e.jsx(s,{className:"w-4 h-4 mr-2"}),"æ„›çŠ¬ã‚’ç™»éŒ²"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map((s=>e.jsx($,{dog:s,onEdit:()=>p(s)},s.id)))}),r&&l&&e.jsx(q,{dog:l,isUpdating:i,error:n,success:c,dogFormData:d,dogImagePreview:m,onClose:j,onSubmit:N,onDelete:b,onFormChange:_,onImageSelect:f,onImageRemove:v,rabiesVaccineFile:x,comboVaccineFile:g,rabiesExpiryDate:h,comboExpiryDate:u,onRabiesVaccineSelect:w,onComboVaccineSelect:y,onRabiesExpiryDateChange:k,onComboExpiryDateChange:D})]}),L=({notifications:s,onMarkAsRead:c})=>{const d=s=>{switch(s){case"reservation":return e.jsx(n,{className:"w-4 h-4 text-blue-600"});case"message":return e.jsx(i,{className:"w-4 h-4 text-green-600"});case"park_approval":return e.jsx(r,{className:"w-4 h-4 text-purple-600"});case"vaccine_approval":return e.jsx(l,{className:"w-4 h-4 text-green-600"});default:return e.jsx(a,{className:"w-4 h-4 text-gray-600"})}};return e.jsxs(E,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[e.jsx(a,{className:"w-5 h-5 mr-2"}),"é€šçŸ¥",s.length>0&&e.jsx("span",{className:"ml-2 bg-red-500 text-white text-xs rounded-full px-2 py-1",children:s.length})]}),s.length>0&&e.jsxs(F,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>{s.forEach((e=>{c(e.id)}))},children:[e.jsx(t,{className:"w-4 h-4 mr-2"}),"ã™ã¹ã¦æ—¢èª­ã«ã™ã‚‹"]})]}),0===s.length?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸ””"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"æ–°ã—ã„é€šçŸ¥ã¯ã‚ã‚Šã¾ã›ã‚“"}),e.jsx("p",{className:"text-sm",children:"æœ€æ–°ã®æƒ…å ±ã‚„ãŠçŸ¥ã‚‰ã›ãŒã‚ã‚‹ã¨ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™"})]}):e.jsx("div",{className:"space-y-4",children:s.map((s=>e.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:d(s.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(s.created_at).toLocaleString("ja-JP")})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(F,{size:"sm",onClick:()=>c(s.id),className:"bg-blue-600 hover:bg-blue-700 text-white",children:e.jsx(t,{className:"w-4 h-4"})})})]},s.id)))})]})};function z({park:s,onSelect:a}){return e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>a(s),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.address}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(c,{className:"w-4 h-4 text-yellow-400 fill-current"}),e.jsx("span",{className:"text-sm",children:s.average_rating.toFixed(1)})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[s.review_count,"ä»¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[B(s.status),e.jsx(F,{size:"sm",className:"bg-white hover:bg-gray-50 border border-gray-300 text-gray-700",children:e.jsx(d,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:["æ–™é‡‘: Â¥",s.price,"/æ—¥"]}),e.jsxs("div",{children:["åŽå®¹äººæ•°: ",s.max_capacity,"äºº"]}),e.jsxs("div",{children:["ç¾åœ¨ã®åˆ©ç”¨è€…: ",s.current_occupancy,"äºº"]}),e.jsxs("div",{children:["ãƒ¬ãƒ“ãƒ¥ãƒ¼: â˜…",s.average_rating.toFixed(1)]})]}),"pending"===s.status&&e.jsxs("div",{className:"mt-3 p-2 bg-yellow-50 rounded text-sm text-yellow-800",children:[e.jsx(o,{className:"w-4 h-4 inline mr-1"}),"ç®¡ç†è€…ã«ã‚ˆã‚‹æ‰¿èªã‚’ãŠå¾…ã¡ãã ã•ã„"]}),"first_stage_passed"===s.status&&e.jsxs("div",{className:"mt-3 p-2 bg-blue-50 rounded text-sm text-blue-800",children:[e.jsx(l,{className:"w-4 h-4 inline mr-1"}),"ç¬¬ä¸€å¯©æŸ»é€šéŽï¼ç¬¬äºŒå¯©æŸ»ã®è©³ç´°æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"]}),"second_stage_review"===s.status&&e.jsxs("div",{className:"mt-3 p-2 bg-purple-50 rounded text-sm text-purple-800",children:[e.jsx(m,{className:"w-4 h-4 inline mr-1"}),"ç¬¬äºŒå¯©æŸ»ä¸­ã§ã™ã€‚å¯©æŸ»å®Œäº†ã¾ã§ãŠå¾…ã¡ãã ã•ã„"]})]})}function B(s){return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${{pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",confirmed:"bg-blue-100 text-blue-800",cancelled:"bg-gray-100 text-gray-800",first_stage_passed:"bg-blue-100 text-blue-800",second_stage_review:"bg-purple-100 text-purple-800",qr_testing:"bg-orange-100 text-orange-800"}[s]||"bg-gray-100 text-gray-800"}`,children:{pending:"æ‰¿èªå¾…ã¡",approved:"æ‰¿èªæ¸ˆã¿",rejected:"å´ä¸‹",confirmed:"ç¢ºå®š",cancelled:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«",first_stage_passed:"ç¬¬ä¸€å¯©æŸ»é€šéŽ",second_stage_review:"ç¬¬äºŒå¯©æŸ»ä¸­",qr_testing:"QRæ¤œæŸ»ä¸­"}[s]||s})}function A({park:s,onClose:a}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold",children:[s.name,"ã®ç®¡ç†"]}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700",children:e.jsx(x,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"åŸºæœ¬æƒ…å ±"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ä½æ‰€:"})," ",s.address]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:"})," ",B(s.status)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"æ–™é‡‘:"})," Â¥",s.price,"/æ—¥"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"æœ€å¤§åŽå®¹äººæ•°:"})," ",s.max_capacity,"äºº"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ç¾åœ¨ã®åˆ©ç”¨è€…æ•°:"})," ",s.current_occupancy,"äºº"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"è©•ä¾¡:"})," â˜…",s.average_rating.toFixed(1)," (",s.review_count,"ä»¶)"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"è¨­å‚™æƒ…å ±"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries({parking:"é§è»Šå ´",shower:"ã‚·ãƒ£ãƒ¯ãƒ¼è¨­å‚™",restroom:"ãƒˆã‚¤ãƒ¬",agility:"ã‚¢ã‚¸ãƒªãƒ†ã‚£è¨­å‚™",rest_area:"ä¼‘æ†©ã‚¹ãƒšãƒ¼ã‚¹",water_station:"çµ¦æ°´è¨­å‚™"}).map((([a,t])=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded "+(s.facilities[a]?"bg-green-500":"bg-gray-300")}),e.jsx("span",{className:"text-sm",children:t})]},a)))})]})]}),"first_stage_passed"===s.status&&e.jsx("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(l,{className:"w-5 h-5 text-blue-600 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"ç¬¬ä¸€å¯©æŸ»é€šéŽ"}),e.jsx("p",{className:"text-sm text-blue-800 mb-3",children:"ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ç¬¬ä¸€å¯©æŸ»ã«é€šéŽã—ã¾ã—ãŸã€‚æ¬¡ã¯è©³ç´°ãªæ–½è¨­æƒ…å ±ã¨ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãŒå¿…è¦ã§ã™ã€‚"}),e.jsx(g,{to:`/parks/${s.id}/second-stage`,children:e.jsx(F,{className:"bg-blue-600 hover:bg-blue-700",children:"ç¬¬äºŒå¯©æŸ»ã‚’é€²ã‚ã‚‹"})})]})]})}),"second_stage_review"===s.status&&e.jsx("div",{className:"mb-6 p-4 bg-purple-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(m,{className:"w-5 h-5 text-purple-600 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-purple-900 mb-2",children:"ç¬¬äºŒå¯©æŸ»ä¸­"}),e.jsx("p",{className:"text-sm text-purple-800",children:"ç¾åœ¨ã€ç®¡ç†è€…ãŒæ–½è¨­ç”»åƒã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚å¯©æŸ»å®Œäº†ã¾ã§ãŠå¾…ã¡ãã ã•ã„ã€‚ å¯©æŸ»ã«ã¯é€šå¸¸3-5å–¶æ¥­æ—¥ã‹ã‹ã‚Šã¾ã™ã€‚çµæžœã¯ãƒ¡ãƒ¼ãƒ«ã¨ã‚¢ãƒ—ãƒªå†…é€šçŸ¥ã§ãŠçŸ¥ã‚‰ã›ã—ã¾ã™ã€‚"})]})]})}),"approved"===s.status&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"çµ±è¨ˆæƒ…å ±"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsx("h4",{className:"font-medium text-blue-900",children:"ä»Šæœˆã®äºˆç´„"})}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"32ä»¶"}),e.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"å‰æœˆæ¯” +12%"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(H,{className:"w-5 h-5 text-green-600"}),e.jsx("h4",{className:"font-medium text-green-900",children:"ä»Šæœˆã®åŽç›Š"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:"Â¥25,600"}),e.jsx("p",{className:"text-xs text-green-700 mt-1",children:"å‰æœˆæ¯” +8%"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(W,{className:"w-5 h-5 text-purple-600"}),e.jsx("h4",{className:"font-medium text-purple-900",children:"åˆ©ç”¨è€…æ•°"})]}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:"128äºº"}),e.jsx("p",{className:"text-xs text-purple-700 mt-1",children:"å‰æœˆæ¯” +15%"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["approved"===s.status&&e.jsx(g,{to:`/parks/${s.id}`,children:e.jsxs(F,{className:"w-full bg-white hover:bg-gray-50 border border-gray-300 text-gray-700",children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),"å…¬é–‹ãƒšãƒ¼ã‚¸ã‚’è¦‹ã‚‹"]})}),"approved"===s.status&&e.jsx(g,{to:"/owner-payment-system",children:e.jsxs(F,{className:"w-full bg-white hover:bg-gray-50 border border-gray-300 text-gray-700",children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"åŽç›Šãƒ¬ãƒãƒ¼ãƒˆ"]})}),"second_stage_review"===s.status?e.jsx("div",{className:"w-full text-center py-3 text-gray-600 text-sm bg-gray-50 rounded border",children:"å¯©æŸ»ä¸­ã®ãŸã‚æ“ä½œã§ãã¾ã›ã‚“"}):e.jsx(g,{to:"first_stage_passed"===s.status?`/parks/${s.id}/second-stage`:`/parks/${s.id}/manage`,children:e.jsx(F,{className:"w-full",children:"first_stage_passed"===s.status?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"ç¬¬äºŒå¯©æŸ»ã‚’é€²ã‚ã‚‹"]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"w-4 h-4 mr-2"}),"approved"===s.status?"è¨­å®šã‚’ç·¨é›†":"è©³ç´°ã‚’è¦‹ã‚‹"]})})})]})]})})})}function H({className:s}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[e.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),e.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]})}function W({className:s}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[e.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})}function T({className:s}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[e.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}const J=({icon:s,label:a,value:t,color:l,trend:r})=>{const i={up:e.jsx(f,{className:"w-4 h-4 text-green-500"}),down:e.jsx(b,{className:"w-4 h-4 text-red-500"}),neutral:e.jsx(N,{className:"w-4 h-4 text-gray-500"})};return e.jsxs(E,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${{blue:"bg-blue-50 text-blue-600",green:"bg-green-50 text-green-600",purple:"bg-purple-50 text-purple-600",orange:"bg-orange-50 text-orange-600"}[l]}`,children:s}),e.jsx("div",{className:"flex items-center space-x-1",children:i[r]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t}),e.jsx("p",{className:"text-sm text-gray-600",children:a})]})]})},O=({dogs:s,ownedParks:a,recentReservations:t,profile:l})=>{const i={approved:s.filter((e=>{var s;return null==(s=e.vaccine_certifications)?void 0:s.some((e=>"approved"===e.status))})).length,pending:s.filter((e=>{var s;return null==(s=e.vaccine_certifications)?void 0:s.some((e=>"pending"===e.status))})).length,total:s.length},c={approved:a.filter((e=>"approved"===e.status)).length,pending:a.filter((e=>"pending"===e.status)).length,total:a.length},d=(()=>{const e=new Date;return e.setDate(1),e.setHours(0,0,0,0),{monthly:t.filter((s=>new Date(s.created_at)>=e)).length,total:t.length}})();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(J,{icon:e.jsx(p,{className:"w-6 h-6"}),label:"ç™»éŒ²æ¸ˆã¿ã®æ„›çŠ¬",value:s.length,color:"blue",trend:s.length>0?"up":"neutral"}),e.jsx(J,{icon:e.jsx(n,{className:"w-6 h-6"}),label:"ä»Šæœˆã®äºˆç´„",value:d.monthly,color:"green",trend:d.monthly>0?"up":"neutral"}),e.jsx(J,{icon:e.jsx(r,{className:"w-6 h-6"}),label:"æ‰€æœ‰æ–½è¨­",value:a.length,color:"purple",trend:a.length>0?"up":"neutral"}),e.jsx(J,{icon:e.jsx(j,{className:"w-6 h-6"}),label:"ç·äºˆç´„æ•°",value:d.total,color:"orange",trend:d.total>0?"up":"neutral"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(E,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(j,{className:"w-5 h-5 mr-2"}),"ãƒ¯ã‚¯ãƒãƒ³è¨¼æ˜Žæ›¸ã®çŠ¶æ³"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[i.total,"é ­ä¸­"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:"æ‰¿èªæ¸ˆã¿"})]}),e.jsxs("span",{className:"text-sm font-medium text-green-600",children:[i.approved,"é ­"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:"å¯©æŸ»ä¸­"})]}),e.jsxs("span",{className:"text-sm font-medium text-yellow-600",children:[i.pending,"é ­"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"}),e.jsx("span",{className:"text-sm",children:"æœªç™»éŒ²"})]}),e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[i.total-i.approved-i.pending,"é ­"]})]})]}),i.total>0&&e.jsx("div",{className:"mt-4 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:i.approved/i.total*100+"%"}})})]}),"owner"===(null==l?void 0:l.user_type)&&e.jsxs(E,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(r,{className:"w-5 h-5 mr-2"}),"æ–½è¨­ç®¡ç†çŠ¶æ³"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[c.total,"æ–½è¨­"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:"é‹å–¶ä¸­"})]}),e.jsxs("span",{className:"text-sm font-medium text-green-600",children:[c.approved,"æ–½è¨­"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:"å¯©æŸ»ä¸­"})]}),e.jsxs("span",{className:"text-sm font-medium text-yellow-600",children:[c.pending,"æ–½è¨­"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"}),e.jsx("span",{className:"text-sm",children:"ãã®ä»–"})]}),e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[c.total-c.approved-c.pending,"æ–½è¨­"]})]})]}),c.total>0&&e.jsx("div",{className:"mt-4 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:c.approved/c.total*100+"%"}})})]})]})]})};function Q(){const{user:s,logout:t,isAdmin:i}=R(),n=v(),c=w(),[d,o]=y.useState(null),[m,x]=y.useState([]),[h,u]=y.useState([]),[p,j]=y.useState([]),[N,b]=y.useState([]),[f,$]=y.useState([]),[q,B]=y.useState([]),[H,W]=y.useState(!0);V();const[T,J]=y.useState(!1),[Q,G]=y.useState(null),[K,X]=y.useState(!1),[Y,Z]=y.useState(null),[ee,se]=y.useState(!1),[ae,te]=y.useState(!1),[le,re]=y.useState(""),[ie,ne]=y.useState(""),[ce,de]=y.useState({name:"",breed:"",gender:"",birthDate:""}),[oe,me]=y.useState(null),[xe,ge]=y.useState(null),[he,ue]=y.useState(null),[pe,je]=y.useState(null),[Ne,be]=y.useState(""),[fe,ve]=y.useState(""),we=async()=>{try{const[a,t,l,r,i,n]=await Promise.all([I.from("profiles").select("*").eq("id",null==s?void 0:s.id).single(),I.from("dogs").select("*, vaccine_certifications(*)").eq("owner_id",null==s?void 0:s.id).order("created_at",{ascending:!1}),I.from("dog_parks").select("*").eq("owner_id",null==s?void 0:s.id).order("created_at",{ascending:!1}),I.from("reservations").select("*, dog_park:dog_parks(*), dog:dogs(*)").eq("user_id",null==s?void 0:s.id).order("created_at",{ascending:!1}).limit(5),I.from("notifications").select("*").eq("user_id",null==s?void 0:s.id).eq("read",!1).order("created_at",{ascending:!1}).limit(5),I.from("news_announcements").select("*").order("created_at",{ascending:!1}).limit(3)]);let c=[];try{const e=await I.from("dog_likes").select("\n            *,\n            dog:dogs(\n              *,\n              vaccine_certifications(*)\n            )\n          ").eq("user_id",null==s?void 0:s.id).order("created_at",{ascending:!1}).limit(10);e.data&&(c=e.data)}catch(e){}[a,t,l,r,i,n].forEach(((e,s)=>{e.error})),o(a.data),x(t.data||[]),u(l.data||[]),j(r.data||[]),b(i.data||[]),$(n.data||[]),B(c.map((e=>e.dog)).filter(Boolean))}catch(a){}finally{W(!1)}};y.useEffect((()=>{s&&we(),c.search.includes("success=true")&&(J(!0),window.history.replaceState({},document.title,c.pathname),setTimeout((()=>J(!1)),5e3))}),[s,n,c]);const ye=e=>{G(e),X(!0)};return H?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"ãƒžã‚¤ãƒšãƒ¼ã‚¸"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["ã‚ˆã†ã“ãã€",(null==d?void 0:d.name)||"ãƒ¦ãƒ¼ã‚¶ãƒ¼","ã•ã‚“ï¼"]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:i&&e.jsxs("a",{href:"/admin",className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md font-medium inline-flex items-center",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"ç®¡ç†è€…ç”»é¢"]})})]}),T&&e.jsxs("div",{className:"mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg flex items-center",children:[e.jsx(l,{className:"w-5 h-5 mr-2"}),"æ“ä½œãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸï¼"]}),e.jsxs("div",{className:"space-y-8",children:[e.jsx(O,{dogs:m,ownedParks:h,recentReservations:p,profile:d}),e.jsx(P,{dogs:m,user:s,selectedDog:Y,showDogEditModal:ee,isUpdatingDog:ae,dogUpdateError:le,dogUpdateSuccess:ie,dogFormData:ce,dogImageFile:oe,dogImagePreview:xe,rabiesVaccineFile:he,comboVaccineFile:pe,rabiesExpiryDate:Ne,comboExpiryDate:fe,onDogSelect:e=>{var s;Z(e);const a=new Date(e.birth_date).toISOString().split("T")[0];de({name:e.name,breed:e.breed,gender:e.gender,birthDate:a||""}),ge(e.image_url||null);const t=null==(s=e.vaccine_certifications)?void 0:s[0];be((null==t?void 0:t.rabies_expiry_date)||""),ve((null==t?void 0:t.combo_expiry_date)||""),se(!0)},onCloseDogEditModal:()=>se(!1),onUpdateDog:e=>{(async e=>{if(e.preventDefault(),Y&&s){te(!0),re(""),ne("");try{if(!(ce.name&&ce.breed&&ce.gender&&ce.birthDate))throw new Error("ã™ã¹ã¦ã®å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");if(!["ã‚ªã‚¹","ãƒ¡ã‚¹"].includes(ce.gender))throw new Error("æ€§åˆ¥ã¯ã€Œã‚ªã‚¹ã€ã¾ãŸã¯ã€Œãƒ¡ã‚¹ã€ã‚’é¸æŠžã—ã¦ãã ã•ã„");let e=null;if((he||pe)&&(e=await U(Y.id,he||void 0,pe||void 0,Ne,fe),!e.success))throw new Error(e.error||"ãƒ¯ã‚¯ãƒãƒ³è¨¼æ˜Žæ›¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ");const s={name:ce.name,breed:ce.breed,gender:ce.gender,birth_date:ce.birthDate};if(oe){const e=`profile_${Date.now()}_${oe.name}`,a=`${Y.id}/${e}`,{error:t}=await I.storage.from("dog-images").upload(a,oe,{upsert:!0});if(t)throw t;s.image_url=I.storage.from("dog-images").getPublicUrl(a).data.publicUrl}const{error:a}=await I.from("dogs").update(s).eq("id",Y.id);if(a)throw a;ne("ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸï¼"),se(!1),await we(),me(null),ue(null),je(null),be(""),ve("")}catch(a){re(a instanceof Error?a.message:"ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®æƒ…å ±ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ")}finally{te(!1)}}})(e)},onDeleteDog:e=>{(async e=>{if(window.confirm(`${e.name}ã®æƒ…å ±ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚`))try{te(!0);const{error:s}=await I.from("dogs").delete().eq("id",e.id);if(s)throw s;ne(`${e.name}ã®æƒ…å ±ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚`),se(!1),await we()}catch(s){re("ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®æƒ…å ±ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚")}finally{te(!1)}})(e)},onDogImageSelect:async e=>{var s;const a=null==(s=e.target.files)?void 0:s[0];if(a)try{if(a.size>10485760)return void re("ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¯10MBä»¥ä¸‹ã«ã—ã¦ãã ã•ã„ã€‚");if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(a.type))return void re(`ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ç”»åƒå½¢å¼ã§ã™: ${a.type}`);me(a);const e=new FileReader;e.onload=e=>{var s;ge(null==(s=e.target)?void 0:s.result)},e.readAsDataURL(a),re("")}catch(t){re("ç”»åƒã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸã€‚åˆ¥ã®ç”»åƒã‚’ãŠè©¦ã—ãã ã•ã„ã€‚")}},onDogImageRemove:()=>{(async()=>{if(null==Y?void 0:Y.image_url)try{te(!0),re("");const{error:e}=await I.from("dogs").update({image_url:null}).eq("id",Y.id);if(e)return void re("ç”»åƒã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");me(null),ge(null),await we(),ne("ç”»åƒã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚"),setTimeout((()=>ne("")),3e3)}catch(e){re("ç”»åƒã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚")}finally{te(!1)}})()},onRabiesVaccineSelect:async e=>{var s;const a=null==(s=e.target.files)?void 0:s[0];if(a){const e=M(a);if(!e.isValid)return void re(e.error||"ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ");ue(a),re("")}else ue(null)},onComboVaccineSelect:async e=>{var s;const a=null==(s=e.target.files)?void 0:s[0];if(a){const e=M(a);if(!e.isValid)return void re(e.error||"ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ");je(a),re("")}else je(null)},onFormDataChange:de,onRabiesExpiryDateChange:be,onComboExpiryDateChange:ve}),h.length>0&&e.jsxs(E,{className:"p-6",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:[e.jsx(r,{className:"w-6 h-6 text-green-600 mr-2"}),"ç®¡ç†ä¸­ã®ãƒ‰ãƒƒã‚°ãƒ©ãƒ³ (",h.length,"æ–½è¨­)"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:h.map((s=>e.jsx(z,{park:s,onSelect:ye},s.id)))})]}),e.jsxs(E,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(g,{to:"/parks",className:"group",children:e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors",children:[e.jsx(k,{className:"w-8 h-8 text-blue-600 mb-2"}),e.jsx("h3",{className:"font-medium text-blue-900",children:"ãƒ‰ãƒƒã‚°ãƒ©ãƒ³æ¤œç´¢"}),e.jsx("p",{className:"text-sm text-blue-700",children:"è¿‘ãã®ãƒ‰ãƒƒã‚°ãƒ©ãƒ³ã‚’æŽ¢ã™"})]})}),e.jsx(g,{to:"/community",className:"group",children:e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg hover:bg-green-100 transition-colors",children:[e.jsx(D,{className:"w-8 h-8 text-green-600 mb-2"}),e.jsx("h3",{className:"font-medium text-green-900",children:"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£"}),e.jsx("p",{className:"text-sm text-green-700",children:"ä»–ã®é£¼ã„ä¸»ã¨äº¤æµ"})]})}),e.jsx(g,{to:"/petshop",className:"group",children:e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors",children:[e.jsx(S,{className:"w-8 h-8 text-purple-600 mb-2"}),e.jsx("h3",{className:"font-medium text-purple-900",children:"ãƒšãƒƒãƒˆã‚·ãƒ§ãƒƒãƒ—"}),e.jsx("p",{className:"text-sm text-purple-700",children:"ãƒšãƒƒãƒˆç”¨å“ã‚’è³¼å…¥"})]})}),e.jsx(g,{to:"/news",className:"group",children:e.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg hover:bg-orange-100 transition-colors",children:[e.jsx(a,{className:"w-8 h-8 text-orange-600 mb-2"}),e.jsx("h3",{className:"font-medium text-orange-900",children:"æ–°ç€æƒ…å ±"}),e.jsx("p",{className:"text-sm text-orange-700",children:"æœ€æ–°ã®ãŠçŸ¥ã‚‰ã›"})]})}),e.jsx(g,{to:"/liked-dogs",className:"group",children:e.jsxs("div",{className:"p-4 bg-pink-50 rounded-lg hover:bg-pink-100 transition-colors",children:[e.jsx(C,{className:"w-8 h-8 text-pink-600 mb-2"}),e.jsx("h3",{className:"font-medium text-pink-900",children:"ã„ã„ã­ã—ãŸãƒ¯ãƒ³ã¡ã‚ƒã‚“"}),e.jsx("p",{className:"text-sm text-pink-700",children:"ãŠæ°—ã«å…¥ã‚Šã®ãƒ¯ãƒ³ã¡ã‚ƒã‚“"})]})}),e.jsx(g,{to:"/park-registration-agreement",className:"group",children:e.jsxs("div",{className:"p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg hover:from-yellow-100 hover:to-orange-100 transition-colors border-2 border-orange-200",children:[e.jsx(r,{className:"w-8 h-8 text-orange-600 mb-2"}),e.jsx("h3",{className:"font-medium text-orange-900",children:"ãƒ‰ãƒƒã‚°ãƒ©ãƒ³ã‚ªãƒ¼ãƒŠãƒ¼å‹Ÿé›†"}),e.jsx("p",{className:"text-sm text-orange-700",children:"ã‚ãªãŸã®ãƒ‰ãƒƒã‚°ãƒ©ãƒ³ã‚’ç™»éŒ²"}),e.jsx("div",{className:"mt-2 text-xs text-orange-600 font-medium",children:"ðŸŽ¯ åŽç›ŠåŒ–ã®ãƒãƒ£ãƒ³ã‚¹ï¼"})]})}),e.jsx(g,{to:"/facility-registration",className:"group",children:e.jsxs("div",{className:"p-4 bg-gradient-to-r from-teal-50 to-cyan-50 rounded-lg hover:from-teal-100 hover:to-cyan-100 transition-colors border-2 border-teal-200",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(C,{className:"w-6 h-6 text-teal-600 mr-2"}),e.jsx(S,{className:"w-6 h-6 text-teal-600"})]}),e.jsx("h3",{className:"font-medium text-teal-900",children:"ãƒšãƒƒãƒˆé–¢é€£æ–½è¨­ç™»éŒ²"}),e.jsx("p",{className:"text-sm text-teal-700",children:"åº—èˆ—ãƒ»å®¿æ³Šæ–½è¨­ãƒ»ã‚µãƒ­ãƒ³ãªã©"}),e.jsx("div",{className:"mt-2 text-xs text-teal-600 font-medium",children:"ðŸŽ‰ ä»Šãªã‚‰ç„¡æ–™æŽ²è¼‰ï¼"})]})})]})]}),N.length>0&&e.jsx(L,{notifications:N,onMarkAsRead:e=>{(async e=>{try{await I.from("notifications").update({read:!0}).eq("id",e),b((s=>s.filter((s=>s.id!==e))))}catch(s){}})(e)}}),e.jsxs(E,{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(C,{className:"w-6 h-6 text-pink-600 mr-2"}),"ã„ã„ã­ã—ãŸãƒ¯ãƒ³ã¡ã‚ƒã‚“ (",q.length,"åŒ¹)"]}),0===q.length?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(C,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"ã¾ã ã„ã„ã­ã—ãŸãƒ¯ãƒ³ã¡ã‚ƒã‚“ã¯ã„ã¾ã›ã‚“"}),e.jsx("p",{className:"text-sm",children:"æ°—ã«ãªã‚‹ãƒ¯ãƒ³ã¡ã‚ƒã‚“ãŒã„ãŸã‚‰ã€ã„ã„ã­ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼"}),e.jsx(g,{to:"/community",className:"mt-4 inline-block",children:e.jsx(F,{size:"sm",children:"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚’è¦‹ã‚‹"})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:q.map((s=>e.jsxs(g,{to:`/dog/${s.id}`,className:"group block bg-white border border-gray-200 rounded-lg hover:shadow-md transition-shadow overflow-hidden",children:[e.jsx("div",{className:"aspect-square bg-gray-200 overflow-hidden",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-4xl",children:"ðŸ•"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 truncate",children:[s.name,"ã‚ªã‚¹"===s.gender?"ãã‚“":"ã¡ã‚ƒã‚“"]}),e.jsx(C,{className:"w-4 h-4 text-pink-500 fill-current"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:s.breed}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["ã‚ªã‚¹"===s.gender?"â™‚":"â™€"," ",s.gender]}),s.like_count>0&&e.jsxs("span",{children:[s.like_count,"ä»¶ã®ã„ã„ã­"]})]})]})]},s.id)))}),q.length>=10&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:"æœ€æ–°ã®10åŒ¹ã‚’è¡¨ç¤ºä¸­"})})]})]}),K&&Q&&e.jsx(A,{park:Q,onClose:()=>X(!1)})]})}export{Q as UserDashboard};
