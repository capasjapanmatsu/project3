var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,c=(s,t,l)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[t]=l,i=(e,s)=>{for(var t in s||(s={}))a.call(s,t)&&c(e,t,s[t]);if(l)for(var t of l(s))r.call(s,t)&&c(e,t,s[t]);return e},n=(e,l)=>s(e,t(l)),d=(e,s,t)=>new Promise(((l,a)=>{var r=e=>{try{i(t.next(e))}catch(s){a(s)}},c=e=>{try{i(t.throw(e))}catch(s){a(s)}},i=e=>e.done?l(e.value):Promise.resolve(e.value).then(r,c);i((t=t.apply(e,s)).next())}));import{u as x,j as m,C as o,B as h,s as u}from"./index.D9xag4tn.js";import{r as j,a as p,u as g,L as b}from"./router.BWT_vQps.js";import{O as N,a as f,l as y,d as v,R as w,p as _,e as k,c as S,A as C,a7 as I,b as P,o as E,v as D,a2 as T,j as O,F as q,ag as $,aa as z,aE as L,x as M,aG as R,t as A}from"./ui.BPlS2KKq.js";import{V as B,g as Q}from"./VaccineBadge.DLhIwHr_.js";import"./vendor.D1SiiUJb.js";import"./supabase.CZ8ekJUM.js";function F({lockId:e,parkName:s="ドッグパーク",purpose:t="entry",className:l="",onSuccess:a,onError:r,reservationId:c}){const{user:i}=x(),[n,p]=j.useState(null),[g,b]=j.useState(null),[C,I]=j.useState(null),[P,E]=j.useState(!1),[D,T]=j.useState(null),[O,q]=j.useState(!1),[$,z]=j.useState(!1),[L,M]=j.useState(!1),[R,A]=j.useState("");j.useEffect((()=>{if(n&&g){const e=setInterval((()=>{const s=new Date,t=g.getTime()-s.getTime();if(t<=0)I("期限切れ"),p(null),b(null),clearInterval(e);else{const e=Math.floor(t/6e4),s=Math.floor(t%6e4/1e3);I(`${e}:${s.toString().padStart(2,"0")}`)}}),1e3);return()=>clearInterval(e)}}),[n,g]);const B=()=>d(null,null,(function*(){if(i){E(!0),T(null);try{const{data:{session:l}}=yield u.auth.getSession();if(!(null==l?void 0:l.access_token))throw new Error("認証が必要です");let r=5,i=null;if(c){const e=yield(s=c,d(null,null,(function*(){try{const{data:e,error:t}=yield u.from("reservations").select("\n          *,\n          dog_park:dog_parks(*),\n          dog:dogs(*)\n        ").eq("id",s).single();return t?null:e}catch(e){return null}})));if(e&&"whole_facility"===e.reservation_type&&(i=(e=>{var s,t;try{const l=new Date(e.date),a=e.start_time.split(":").map(Number),r=null!=(s=a[0])?s:0,c=null!=(t=a[1])?t:0;return l.setHours(r,c,0,0),new Date(l.getTime()+60*e.duration*60*1e3)}catch(l){return null}})(e),i)){const e=new Date,s=i.getTime()-e.getTime();r=Math.max(1,Math.ceil(s/6e4))}}const n=yield fetch("/functions/v1/generate-pin",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l.access_token}`},body:JSON.stringify({lock_id:e,purpose:t,expiry_minutes:r,reservation_id:c||void 0})});if(!n.ok){const e=yield n.json();throw new Error(e.error||"PINコードの生成に失敗しました")}const{pin:x,expires_at:m}=yield n.json();p(x),b(new Date(m)),z(!0),a&&a(x),setTimeout((()=>{z(!1)}),3e3)}catch(l){const e=l instanceof Error?l.message:"PINコードの生成に失敗しました";if(e.startsWith("PAYMENT_REQUIRED:")){const s=e.replace("PAYMENT_REQUIRED:","").trim();A(s),M(!0),T(null)}else T(e),M(!1);r&&r(e)}finally{E(!1)}var s}}));return m.jsx(o,{className:`p-4 ${l}`,children:m.jsxs("div",{className:"text-center",children:[m.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center justify-center",children:[m.jsx(N,{className:"w-5 h-5 text-blue-600 mr-2"}),s,"の","entry"===t?"入口":"出口"]}),n?m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border-2 border-blue-200 mx-auto",children:[m.jsx("p",{className:"text-sm text-blue-800 mb-1",children:"PINコード:"}),m.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[m.jsx("p",{className:"text-3xl font-bold tracking-widest text-blue-700",children:n}),m.jsx("button",{onClick:()=>{n&&navigator.clipboard.writeText(n).then((()=>{q(!0),setTimeout((()=>q(!1)),2e3)})).catch((()=>{}))},className:"p-1 text-blue-600 hover:text-blue-800 transition-colors",title:"コピー",children:O?m.jsx(f,{className:"w-5 h-5"}):m.jsx(y,{className:"w-5 h-5"})})]})]}),m.jsx("div",{className:"bg-yellow-50 p-2 rounded-lg",children:m.jsxs("div",{className:"flex items-center justify-center space-x-2 text-yellow-800",children:[m.jsx(v,{className:"w-4 h-4"}),m.jsxs("span",{className:"font-medium",children:["有効期限: ",C]})]})}),m.jsx("div",{className:"flex justify-center space-x-3",children:m.jsxs(h,{onClick:()=>{B()},variant:"secondary",size:"sm",isLoading:P,children:[m.jsx(w,{className:"w-4 h-4 mr-1"}),"再生成"]})}),m.jsxs("p",{className:"text-xs text-gray-500",children:["entry"===t?"入場":"退場","時にスマートロックのキーパッドに上記のPINコードを入力してください"]})]}):m.jsxs("div",{className:"space-y-4",children:[m.jsxs("p",{className:"text-gray-600 mb-4",children:["entry"===t?"入場":"退場","用のPINコードを生成します。",m.jsx("br",{}),"生成されたPINコードは5分間有効です。"]}),D&&m.jsxs("div",{className:"bg-red-50 p-3 rounded-lg flex items-center justify-center text-red-600",children:[m.jsx(_,{className:"w-4 h-4 mr-1"}),m.jsx("span",{children:D})]}),L&&m.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[m.jsxs("div",{className:"flex items-start space-x-3 mb-4",children:[m.jsx(k,{className:"w-6 h-6 text-blue-600 mt-1 flex-shrink-0"}),m.jsxs("div",{children:[m.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"決済が必要です"}),m.jsx("p",{className:"text-sm text-blue-800 mb-4",children:R})]})]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs(h,{onClick:()=>window.location.href="/subscription",className:"w-full bg-purple-600 hover:bg-purple-700",children:[m.jsx(k,{className:"w-4 h-4 mr-2"}),"サブスクリプションに加入（¥3,800/月）"]}),m.jsxs(h,{onClick:()=>window.location.href="/parks",variant:"secondary",className:"w-full",children:[m.jsx(S,{className:"w-4 h-4 mr-2"}),"1日券を購入（¥800）"]})]}),m.jsxs("p",{className:"text-xs text-blue-700 mt-3",children:["• サブスクリプション：全国のドッグランが使い放題",m.jsx("br",{}),"• 1日券：選択したドッグランで24時間利用可能"]})]}),$&&m.jsxs("div",{className:"bg-green-50 p-3 rounded-lg flex items-center justify-center text-green-600",children:[m.jsx(f,{className:"w-4 h-4 mr-1"}),m.jsx("span",{children:"PINコードを生成しました"})]}),m.jsxs(h,{onClick:()=>{B()},isLoading:P,className:"w-full",children:[m.jsx(N,{className:"w-4 h-4 mr-2"}),"entry"===t?"入場":"退場","用PINを生成"]})]})]})})}const J=e=>{if(!e)return null;return new Date(e).toISOString()};function U(){const{parkId:e}=p(),{user:s}=x(),t=g(),[l,a]=j.useState(null),[r,c]=j.useState(!0),[y,w]=j.useState(""),[k,U]=j.useState(""),[V,Y]=j.useState("overview"),[G,H]=j.useState([]),[W,Z]=j.useState(null),[K,X]=j.useState("entry"),[ee,se]=j.useState([]),[te,le]=j.useState([]),[ae,re]=j.useState([]),[ce,ie]=j.useState(!1),[ne,de]=j.useState({title:"",description:"",start_date:"",end_date:"",is_emergency:!1,notify_users:!0}),[xe,me]=j.useState(!1),[oe,he]=j.useState(!1),[ue,je]=j.useState(!1),[pe,ge]=j.useState({max_capacity:0,facilities:{parking:!1,shower:!1,restroom:!1,agility:!1,rest_area:!1,water_station:!1},large_dog_area:!1,small_dog_area:!1,private_booths:!1,private_booth_count:0,facility_details:"",description:""});j.useEffect((()=>{s&&e?be():t("/owner-dashboard")}),[s,e,t]),j.useEffect((()=>{d(null,null,(function*(){if(s)try{const{data:e,error:t}=yield u.from("dogs").select("\n            *,\n            vaccine_certifications (\n              id,\n              status,\n              rabies_expiry_date,\n              combo_expiry_date,\n              approved_at\n            )\n          ").eq("owner_id",s.id);if(t)throw t;const l=(e||[]).filter((e=>"approved"===Q(e)));se(l)}catch(e){}}))}),[s]);const be=()=>d(null,null,(function*(){try{c(!0);const{data:l,error:r}=yield u.from("dog_parks").select("*").eq("id",e).eq("owner_id",null==s?void 0:s.id).single();if(r)throw r;if(!l)return void t("/owner-dashboard");a(l),ge({max_capacity:l.max_capacity||0,facilities:l.facilities||{parking:!1,shower:!1,restroom:!1,agility:!1,rest_area:!1,water_station:!1},large_dog_area:l.large_dog_area||!1,small_dog_area:l.small_dog_area||!1,private_booths:l.private_booths||!1,private_booth_count:l.private_booth_count||0,facility_details:l.facility_details||"",description:l.description||""});const{data:i,error:n}=yield u.from("smart_locks").select("*").eq("park_id",e);if(n)throw n;H(i||[]),i&&i.length>0&&Z(i[0]);const{data:d,error:x}=yield u.from("dogs").select("\n          *,\n          vaccine_certifications!inner(*)\n        ").eq("owner_id",null==s?void 0:s.id).eq("vaccine_certifications.status","approved");if(x)throw x;se(d||[]),yield Ne()}catch(l){w("データの取得に失敗しました。")}finally{c(!1)}})),Ne=()=>d(null,null,(function*(){try{const{data:s,error:t}=yield u.from("park_maintenance").select("*").eq("park_id",e).order("start_date",{ascending:!1});if(t)throw t;re(s||[])}catch(s){}})),fe=e=>"オス"===e?"くん":"ちゃん",ye=e=>e?new Date(e).toLocaleString("ja-JP",{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Tokyo"}):"未設定";return r?m.jsx("div",{className:"flex justify-center items-center h-64",children:m.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):l?m.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[m.jsx("div",{className:"flex items-center space-x-4 mb-6",children:m.jsxs(b,{to:"/owner-dashboard",className:"flex items-center text-blue-600 hover:text-blue-800",children:[m.jsx(C,{className:"w-4 h-4 mr-2"}),"ダッシュボードに戻る"]})}),m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("div",{children:[m.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-2 flex items-center",children:[m.jsx(I,{className:"w-8 h-8 text-blue-600 mr-3"}),l.name,"の管理"]}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(P,{className:"w-4 h-4 text-gray-500"}),m.jsx("p",{className:"text-gray-600",children:l.address})]})]}),m.jsxs("div",{className:"flex space-x-3",children:[m.jsx(b,{to:`/parks/${l.id}`,children:m.jsxs(h,{variant:"secondary",children:[m.jsx(E,{className:"w-4 h-4 mr-2"}),"公開ページを見る"]})}),m.jsxs(h,{onClick:()=>he(!0),children:[m.jsx(D,{className:"w-4 h-4 mr-2"}),"設定を編集"]})]})]}),y&&m.jsxs("div",{className:"bg-red-100 border border-red-300 text-red-800 rounded-lg p-4 flex items-start",children:[m.jsx(_,{className:"w-5 h-5 text-red-600 mt-0.5 mr-3 flex-shrink-0"}),m.jsx("p",{children:y})]}),k&&m.jsxs("div",{className:"bg-green-100 border border-green-300 text-green-800 rounded-lg p-4 flex items-start",children:[m.jsx(f,{className:"w-5 h-5 text-green-600 mt-0.5 mr-3 flex-shrink-0"}),m.jsx("p",{children:k})]}),m.jsxs("div",{className:"flex space-x-4 border-b",children:[m.jsxs("button",{className:"px-4 py-2 font-medium "+("overview"===V?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>Y("overview"),children:[m.jsx(I,{className:"w-4 h-4 inline mr-2"}),"概要"]}),m.jsxs("button",{className:"px-4 py-2 font-medium "+("stats"===V?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>Y("stats"),children:[m.jsx(T,{className:"w-4 h-4 inline mr-2"}),"統計・収益"]}),m.jsxs("button",{className:"px-4 py-2 font-medium "+("pins"===V?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>Y("pins"),children:[m.jsx(N,{className:"w-4 h-4 inline mr-2"}),"PINコード管理"]}),m.jsxs("button",{className:"px-4 py-2 font-medium "+("settings"===V?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>Y("settings"),children:[m.jsx(O,{className:"w-4 h-4 inline mr-2"}),"設定"]})]}),"overview"===V&&m.jsxs("div",{className:"space-y-6",children:[m.jsxs(o,{className:"p-6",children:[m.jsxs("h2",{className:"text-xl font-semibold mb-6 flex items-center",children:[m.jsx(q,{className:"w-6 h-6 text-blue-600 mr-2"}),"基本情報"]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"font-semibold mb-3",children:"施設情報"}),m.jsxs("div",{className:"space-y-2 text-sm",children:[m.jsxs("p",{children:[m.jsx("span",{className:"font-medium",children:"住所:"})," ",l.address]}),m.jsxs("p",{children:[m.jsx("span",{className:"font-medium",children:"ステータス:"})," ","approved"===l.status?"運営中":"審査中"]}),m.jsxs("p",{children:[m.jsx("span",{className:"font-medium",children:"料金:"})," ¥",l.price,"/日"]}),m.jsxs("p",{children:[m.jsx("span",{className:"font-medium",children:"最大収容人数:"})," ",l.max_capacity,"人"]}),m.jsxs("p",{children:[m.jsx("span",{className:"font-medium",children:"現在の利用者数:"})," ",l.current_occupancy,"人"]}),m.jsxs("p",{children:[m.jsx("span",{className:"font-medium",children:"評価:"})," ★",l.average_rating.toFixed(1)," (",l.review_count,"件)"]})]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"font-semibold mb-3",children:"設備情報"}),m.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries({parking:"駐車場",shower:"シャワー設備",restroom:"トイレ",agility:"アジリティ設備",rest_area:"休憩スペース",water_station:"給水設備"}).map((([e,s])=>m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("div",{className:"w-4 h-4 rounded "+(l.facilities[e]?"bg-green-500":"bg-gray-300")}),m.jsx("span",{className:"text-sm",children:s})]},e)))}),m.jsxs("div",{className:"mt-4 space-y-2",children:[m.jsxs("p",{children:[m.jsx("span",{className:"font-medium",children:"大型犬エリア:"})," ",l.large_dog_area?"あり":"なし"]}),m.jsxs("p",{children:[m.jsx("span",{className:"font-medium",children:"小型犬エリア:"})," ",l.small_dog_area?"あり":"なし"]}),m.jsxs("p",{children:[m.jsx("span",{className:"font-medium",children:"プライベートブース:"})," ",l.private_booths?`${l.private_booth_count}室`:"なし"]})]})]})]})]}),m.jsxs(o,{className:"p-6",children:[m.jsxs("h2",{className:"text-xl font-semibold mb-6 flex items-center",children:[m.jsx(S,{className:"w-6 h-6 text-blue-600 mr-2"}),"今日の統計"]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[m.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[m.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[m.jsx(S,{className:"w-5 h-5 text-blue-600"}),m.jsx("h4",{className:"font-medium text-blue-900",children:"今日の予約"})]}),m.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"5件"}),m.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"前日比 +2件"})]}),m.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[m.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[m.jsx($,{className:"w-5 h-5 text-green-600"}),m.jsx("h4",{className:"font-medium text-green-900",children:"今日の収益"})]}),m.jsx("p",{className:"text-2xl font-bold text-green-600",children:"¥4,000"}),m.jsx("p",{className:"text-xs text-green-700 mt-1",children:"前日比 +¥1,600"})]}),m.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[m.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[m.jsx(z,{className:"w-5 h-5 text-purple-600"}),m.jsx("h4",{className:"font-medium text-purple-900",children:"利用者数"})]}),m.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[l.current_occupancy,"人"]}),m.jsxs("p",{className:"text-xs text-purple-700 mt-1",children:["最大: ",l.max_capacity,"人"]})]})]})]}),m.jsxs(o,{className:"p-6",children:[m.jsxs("div",{className:"flex justify-between items-center mb-6",children:[m.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:[m.jsx(L,{className:"w-6 h-6 text-blue-600 mr-2"}),"施設画像"]}),m.jsx(b,{to:`/parks/${l.id}/second-stage`,children:m.jsxs(h,{size:"sm",children:[m.jsx(D,{className:"w-4 h-4 mr-2"}),"画像を管理"]})})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.image_url?m.jsx("div",{className:"h-48 rounded-lg overflow-hidden",children:m.jsx("img",{src:l.image_url,alt:`${l.name} - メイン画像`,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="https://via.placeholder.com/400x300?text=No+Image"}})}):m.jsx("div",{className:"h-48 bg-gray-100 rounded-lg flex items-center justify-center",children:m.jsx("p",{className:"text-gray-500",children:"メイン画像なし"})}),l.cover_image_url?m.jsx("div",{className:"h-48 rounded-lg overflow-hidden",children:m.jsx("img",{src:l.cover_image_url,alt:`${l.name} - カバー画像`,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="https://via.placeholder.com/400x300?text=No+Image"}})}):m.jsx("div",{className:"h-48 bg-gray-100 rounded-lg flex items-center justify-center",children:m.jsx("p",{className:"text-gray-500",children:"カバー画像なし"})}),m.jsx("div",{className:"h-48 bg-gray-100 rounded-lg flex items-center justify-center",children:m.jsxs(b,{to:`/parks/${l.id}/second-stage`,className:"text-blue-600 hover:text-blue-800 flex flex-col items-center",children:[m.jsx(L,{className:"w-8 h-8 mb-2"}),m.jsx("p",{children:"その他の画像を管理"})]})})]})]})]}),"stats"===V&&m.jsxs("div",{className:"space-y-6",children:[m.jsxs(o,{className:"p-6",children:[m.jsxs("h2",{className:"text-xl font-semibold mb-6 flex items-center",children:[m.jsx(T,{className:"w-6 h-6 text-blue-600 mr-2"}),"利用統計"]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[m.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[m.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[m.jsx(S,{className:"w-5 h-5 text-blue-600"}),m.jsx("h4",{className:"font-medium text-blue-900",children:"今月の予約"})]}),m.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"32件"}),m.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"前月比 +12%"})]}),m.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[m.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[m.jsx($,{className:"w-5 h-5 text-green-600"}),m.jsx("h4",{className:"font-medium text-green-900",children:"今月の収益"})]}),m.jsx("p",{className:"text-2xl font-bold text-green-600",children:"¥25,600"}),m.jsx("p",{className:"text-xs text-green-700 mt-1",children:"前月比 +8%"})]}),m.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[m.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[m.jsx(z,{className:"w-5 h-5 text-purple-600"}),m.jsx("h4",{className:"font-medium text-purple-900",children:"利用者数"})]}),m.jsx("p",{className:"text-2xl font-bold text-purple-600",children:"128人"}),m.jsx("p",{className:"text-xs text-purple-700 mt-1",children:"前月比 +15%"})]})]}),m.jsx("div",{className:"h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:m.jsx("p",{className:"text-gray-500",children:"利用統計グラフ（実装予定）"})})]}),m.jsxs(o,{className:"p-6",children:[m.jsxs("h2",{className:"text-xl font-semibold mb-6 flex items-center",children:[m.jsx($,{className:"w-6 h-6 text-blue-600 mr-2"}),"収益情報"]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[m.jsx("h3",{className:"font-semibold text-blue-900 mb-3",children:"収益配分"}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-sm text-blue-800 mb-1",children:"オーナー取り分（80%）"}),m.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"¥20,480"})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-sm text-blue-800 mb-1",children:"プラットフォーム手数料（20%）"}),m.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"¥5,120"})]})]})]}),m.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[m.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"収益内訳"}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-sm text-green-800 mb-1",children:"通常利用"}),m.jsx("p",{className:"text-xl font-bold text-green-600",children:"¥12,800"}),m.jsx("p",{className:"text-xs text-green-700",children:"16件"})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-sm text-green-800 mb-1",children:"施設貸し切り"}),m.jsx("p",{className:"text-xl font-bold text-green-600",children:"¥8,800"}),m.jsx("p",{className:"text-xs text-green-700",children:"2件"})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-sm text-green-800 mb-1",children:"プライベートブース"}),m.jsx("p",{className:"text-xl font-bold text-green-600",children:"¥4,000"}),m.jsx("p",{className:"text-xs text-green-700",children:"2件"})]})]})]}),m.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[m.jsx("h3",{className:"font-semibold text-purple-900 mb-3",children:"振込情報"}),m.jsx("p",{className:"text-sm text-purple-800 mb-2",children:"振込は毎月15日に前月分を一括で行います。振込手数料は当社負担です。"}),m.jsx(b,{to:"/owner-payment-system",children:m.jsxs(h,{size:"sm",className:"bg-purple-600 hover:bg-purple-700",children:[m.jsx($,{className:"w-4 h-4 mr-2"}),"振込情報を確認"]})})]})]})]})]}),"pins"===V&&m.jsxs("div",{className:"space-y-6",children:[m.jsxs(o,{className:"p-6",children:[m.jsxs("h2",{className:"text-xl font-semibold mb-6 flex items-center",children:[m.jsx(N,{className:"w-6 h-6 text-blue-600 mr-2"}),"オーナー用PINコード発行"]}),m.jsx("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:m.jsxs("div",{className:"flex items-start space-x-3",children:[m.jsx(f,{className:"w-5 h-5 text-blue-600 mt-1 flex-shrink-0"}),m.jsxs("div",{className:"text-sm text-blue-800",children:[m.jsx("p",{className:"font-medium mb-1",children:"オーナー特権"}),m.jsx("p",{children:"オーナーは決済不要でPINコードを発行できます。施設の管理やメンテナンスに使用してください。"}),m.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[m.jsx("li",{children:"PINコードは5分間有効です"}),m.jsx("li",{children:"入場・退場それぞれでPINコードが必要です"}),m.jsx("li",{children:"スタッフと共有することもできます"}),m.jsx("li",{children:"入場する犬を選択してください"})]})]})]})}),m.jsxs("div",{className:"flex justify-center space-x-4 mb-4",children:[m.jsxs("button",{className:"px-6 py-3 rounded-lg flex items-center space-x-2 "+("entry"===K?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),onClick:()=>X("entry"),children:[m.jsx(C,{className:"w-5 h-5"}),m.jsx("span",{children:"入場"})]}),m.jsxs("button",{className:"px-6 py-3 rounded-lg flex items-center space-x-2 "+("exit"===K?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),onClick:()=>X("exit"),children:[m.jsx(C,{className:"w-5 h-5 rotate-180"}),m.jsx("span",{children:"退場"})]})]}),G.length>0&&m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"スマートロックを選択"}),m.jsx("select",{value:(null==W?void 0:W.id)||"",onChange:e=>{const s=G.find((s=>s.id===e.target.value));Z(s||null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:G.map((e=>m.jsx("option",{value:e.id,children:e.lock_name},e.id)))})]}),m.jsxs("div",{className:"mb-6",children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["入場するワンちゃんを選択（最大",3,"頭）"]}),0===ee.length?m.jsx("div",{className:"p-4 bg-yellow-50 rounded-lg",children:m.jsxs("p",{className:"text-yellow-800",children:["ワクチン接種証明書が承認されたワンちゃんがいません。",m.jsx(b,{to:"/register-dog",className:"text-blue-600 hover:underline ml-1",children:"ワンちゃんを登録する"})]})}):m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ee.map((e=>{const s=te.includes(e.id),t=!s&&te.length>=3;return m.jsxs("div",{className:"p-4 border-2 rounded-lg cursor-pointer transition-colors relative "+(s?"border-green-500 bg-green-50":t?"border-gray-200 bg-gray-50 opacity-50 cursor-not-allowed":"border-gray-200 hover:border-gray-300"),onClick:()=>{return!t&&(s=e.id,void le((e=>e.includes(s)?e.filter((e=>e!==s)):e.length>=3?(w("最大3頭まで選択可能です。"),e):(w(""),[...e,s]))));var s},children:[s&&m.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center",children:m.jsx(f,{className:"w-4 h-4"})}),m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden",children:e.image_url?m.jsx("img",{src:e.image_url,alt:e.name,className:"w-full h-full object-cover"}):m.jsx("div",{className:"w-6 h-6 text-gray-500",children:"🐾"})}),m.jsxs("div",{children:[m.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[m.jsxs("h3",{className:"font-semibold",children:[e.name,fe(e.gender)]}),m.jsx(B,{status:Q(e),size:"sm"})]}),m.jsxs("p",{className:"text-sm text-gray-600",children:[e.breed," • ",e.gender]})]})]})]},e.id)}))}),te.length>0&&m.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:[m.jsx("h4",{className:"font-medium text-green-900 mb-1",children:"選択中のワンちゃん"}),m.jsx("p",{className:"text-sm text-green-800",children:te.map((e=>{const s=ee.find((s=>s.id===e));return s?`${s.name}${fe(s.gender)}`:""})).filter((e=>e)).join("、")}),m.jsxs("p",{className:"text-xs text-green-700 mt-1",children:[te.length,"頭が同時入場できます"]})]})]}),W?m.jsx("div",{className:"mt-6",children:te.length>0?m.jsx(F,{lockId:W.lock_id,parkName:l.name,purpose:K,onSuccess:e=>{U(`PINコードを生成しました: ${e}`),setTimeout((()=>{U("")}),3e3)},onError:e=>{w(e),setTimeout((()=>{w("")}),5e3)}}):m.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg text-center",children:[m.jsx(_,{className:"w-6 h-6 text-yellow-600 mx-auto mb-2"}),m.jsx("p",{className:"text-yellow-800 font-medium",children:"ワンちゃんを1頭以上選択してください"}),m.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"PINコードを発行するには、入場するワンちゃんを選択する必要があります"})]})}):m.jsxs("div",{className:"text-center py-8",children:[m.jsx(N,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),m.jsx("p",{className:"text-gray-600 mb-4",children:"スマートロックが設定されていません"}),m.jsx(h,{onClick:()=>Y("settings"),children:"スマートロックを設定する"})]})]}),m.jsx(o,{className:"p-6 bg-blue-50 border-blue-200",children:m.jsxs("div",{className:"flex items-start space-x-3",children:[m.jsx(N,{className:"w-6 h-6 text-blue-600 mt-1"}),m.jsxs("div",{children:[m.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"PINコードについて"}),m.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[m.jsx("p",{children:"• 利用者はPINコードを使用して入退場します"}),m.jsx("p",{children:"• PINコードは5分間有効で、利用者が支払い後に発行されます"}),m.jsx("p",{children:"• オーナーは決済不要でPINコードを発行できます"}),m.jsx("p",{children:"• 施設貸し切りの場合、利用者は友達にPINコードを共有できます"})]})]})]})})]}),"settings"===V&&m.jsxs("div",{className:"space-y-6",children:[oe&&m.jsxs(o,{className:"p-6 bg-blue-50 border-blue-200",children:[m.jsxs("div",{className:"flex justify-between items-center mb-6",children:[m.jsx("h3",{className:"text-xl font-semibold text-blue-900",children:"施設情報の編集"}),m.jsx("button",{onClick:()=>he(!1),className:"text-blue-600 hover:text-blue-800",children:m.jsx(M,{className:"w-5 h-5"})})]}),m.jsxs("form",{onSubmit:e=>d(null,null,(function*(){if(e.preventDefault(),l&&s){je(!0);try{if(pe.max_capacity<1)throw new Error("収容人数は1人以上で入力してください。");if(pe.private_booths&&pe.private_booth_count<1)throw new Error("プライベートブースがある場合は、部屋数を1以上で入力してください。");const{error:e}=yield u.from("dog_parks").update({max_capacity:pe.max_capacity,facilities:pe.facilities,large_dog_area:pe.large_dog_area,small_dog_area:pe.small_dog_area,private_booths:pe.private_booths,private_booth_count:pe.private_booths?pe.private_booth_count:0,facility_details:pe.facility_details,description:pe.description,updated_at:(new Date).toISOString()}).eq("id",l.id);if(e)throw e;U("施設情報を更新しました。"),he(!1),yield be(),setTimeout((()=>{U("")}),3e3)}catch(t){w(t instanceof Error?t.message:"施設情報の更新に失敗しました。"),setTimeout((()=>{w("")}),5e3)}finally{je(!1)}}})),className:"space-y-6",children:[m.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[m.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"変更不可項目"}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[m.jsxs("div",{children:[m.jsx("span",{className:"font-medium",children:"住所:"})," ",l.address]}),m.jsxs("div",{children:[m.jsx("span",{className:"font-medium",children:"料金:"})," ¥",l.price,"/日（全国統一料金）"]})]})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"最大収容人数 *"}),m.jsx("input",{type:"number",min:"1",max:"100",value:pe.max_capacity,onChange:e=>ge((s=>n(i({},s),{max_capacity:parseInt(e.target.value)||0}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"説明文"}),m.jsx("textarea",{value:pe.description,onChange:e=>ge((s=>n(i({},s),{description:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"施設の特徴や利用案内など"})]})]}),m.jsxs("div",{children:[m.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"エリア設定"}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.jsxs("label",{className:"flex items-center space-x-2",children:[m.jsx("input",{type:"checkbox",checked:pe.large_dog_area,onChange:e=>ge((s=>n(i({},s),{large_dog_area:e.target.checked}))),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),m.jsx("span",{className:"text-sm text-gray-700",children:"大型犬エリア"})]}),m.jsxs("label",{className:"flex items-center space-x-2",children:[m.jsx("input",{type:"checkbox",checked:pe.small_dog_area,onChange:e=>ge((s=>n(i({},s),{small_dog_area:e.target.checked}))),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),m.jsx("span",{className:"text-sm text-gray-700",children:"小型犬エリア"})]})]})]}),m.jsxs("div",{children:[m.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"プライベートブース"}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("label",{className:"flex items-center space-x-2",children:[m.jsx("input",{type:"checkbox",checked:pe.private_booths,onChange:e=>ge((s=>n(i({},s),{private_booths:e.target.checked}))),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),m.jsx("span",{className:"text-sm text-gray-700",children:"プライベートブースあり"})]}),pe.private_booths&&m.jsxs("div",{className:"ml-6",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"部屋数"}),m.jsx("input",{type:"number",min:"1",max:"10",value:pe.private_booth_count,onChange:e=>ge((s=>n(i({},s),{private_booth_count:parseInt(e.target.value)||0}))),className:"w-24 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),m.jsxs("div",{children:[m.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"設備情報"}),m.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Object.entries({parking:"駐車場",shower:"シャワー設備",restroom:"トイレ",agility:"アジリティ設備",rest_area:"休憩スペース",water_station:"給水設備"}).map((([e,s])=>m.jsxs("label",{className:"flex items-center space-x-2",children:[m.jsx("input",{type:"checkbox",checked:pe.facilities[e],onChange:s=>ge((t=>n(i({},t),{facilities:n(i({},t.facilities),{[e]:s.target.checked})}))),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),m.jsx("span",{className:"text-sm text-gray-700",children:s})]},e)))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"設備詳細説明"}),m.jsx("textarea",{value:pe.facility_details,onChange:e=>ge((s=>n(i({},s),{facility_details:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"設備の詳細説明や利用案内など"})]}),m.jsxs("div",{className:"flex justify-end space-x-3",children:[m.jsx(h,{type:"button",variant:"secondary",onClick:()=>he(!1),children:"キャンセル"}),m.jsx(h,{type:"submit",isLoading:ue,className:"bg-blue-600 hover:bg-blue-700",children:"更新"})]})]})]}),m.jsxs(o,{className:"p-6",children:[m.jsxs("h2",{className:"text-xl font-semibold mb-6 flex items-center",children:[m.jsx(O,{className:"w-6 h-6 text-blue-600 mr-2"}),"施設設定"]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[m.jsx("h3",{className:"font-semibold text-blue-900 mb-3",children:"基本設定"}),m.jsx("p",{className:"text-sm text-blue-800 mb-3",children:"施設の基本情報や設備情報を編集できます。住所と料金は変更できません。"}),m.jsxs(h,{size:"sm",onClick:()=>he(!0),children:[m.jsx(D,{className:"w-4 h-4 mr-2"}),"基本情報を編集"]})]}),m.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[m.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"料金設定"}),m.jsx("p",{className:"text-sm text-green-800 mb-3",children:"料金体系は全国統一です。変更はできません。"}),m.jsxs("ul",{className:"text-sm text-green-800 space-y-1",children:[m.jsx("li",{children:"• 通常利用: ¥800/日（固定）"}),m.jsx("li",{children:"• 施設貸し切り: ¥4,400/時間（固定）"}),m.jsx("li",{children:"• プライベートブース: サブスク使い放題・1日券でも利用可能（追加料金なし）"})]})]}),m.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[m.jsx("h3",{className:"font-semibold text-purple-900 mb-3",children:"スマートロック設定"}),m.jsx("p",{className:"text-sm text-purple-800 mb-3",children:"スマートロックの設定を管理します。"}),m.jsxs(h,{size:"sm",className:"bg-purple-600 hover:bg-purple-700",children:[m.jsx(N,{className:"w-4 h-4 mr-2"}),"スマートロックを管理"]})]}),m.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[m.jsx("h3",{className:"font-semibold text-orange-900 mb-3",children:"営業時間設定"}),m.jsx("p",{className:"text-sm text-orange-800 mb-3",children:"営業時間は24時間です。変更はできません。"}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(v,{className:"w-5 h-5 text-orange-600"}),m.jsx("span",{className:"font-medium",children:"24時間営業"})]})]})]})]}),m.jsxs(o,{className:"p-6",children:[m.jsxs("div",{className:"flex justify-between items-center mb-6",children:[m.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:[m.jsx(R,{className:"w-6 h-6 text-blue-600 mr-2"}),"メンテナンス管理"]}),m.jsxs(h,{onClick:()=>ie(!0),className:"bg-blue-600 hover:bg-blue-700",children:[m.jsx(A,{className:"w-4 h-4 mr-2"}),"メンテナンス予定を追加"]})]}),ce&&m.jsxs(o,{className:"p-4 mb-6 bg-blue-50 border-blue-200",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4",children:[m.jsx("h3",{className:"text-lg font-semibold text-blue-900",children:"新しいメンテナンス予定"}),m.jsx("button",{onClick:()=>ie(!1),className:"text-blue-600 hover:text-blue-800",children:m.jsx(M,{className:"w-5 h-5"})})]}),m.jsxs("form",{onSubmit:t=>d(null,null,(function*(){if(t.preventDefault(),s&&e){me(!0);try{if(!ne.title||!ne.start_date||!ne.end_date)throw new Error("必須項目を入力してください。");const t=new Date(ne.start_date);if(new Date(ne.end_date)<=t)throw new Error("終了日時は開始日時より後に設定してください。");if(t<new Date)throw new Error("開始日時は現在時刻より後に設定してください。");const{error:l}=yield u.from("park_maintenance").insert({park_id:e,title:ne.title,description:ne.description,start_date:J(ne.start_date),end_date:J(ne.end_date),is_emergency:ne.is_emergency,notify_users:ne.notify_users,created_by:s.id});if(l)throw l;U("メンテナンススケジュールを作成しました。"),ie(!1),de({title:"",description:"",start_date:"",end_date:"",is_emergency:!1,notify_users:!0}),yield Ne()}catch(l){w(l instanceof Error?l.message:"メンテナンススケジュールの作成に失敗しました。")}finally{me(!1)}}})),className:"space-y-4",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"メンテナンス内容 *"}),m.jsx("input",{type:"text",value:ne.title,onChange:e=>de((s=>n(i({},s),{title:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"例：設備点検・清掃作業",required:!0})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"開始日時 * (日本時間)"}),m.jsx("input",{type:"datetime-local",value:ne.start_date,onChange:e=>de((s=>n(i({},s),{start_date:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),m.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"日本時間で入力してください"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"終了日時 * (日本時間)"}),m.jsx("input",{type:"datetime-local",value:ne.end_date,onChange:e=>de((s=>n(i({},s),{end_date:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),m.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"日本時間で入力してください"})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"詳細説明"}),m.jsx("textarea",{value:ne.description,onChange:e=>de((s=>n(i({},s),{description:e.target.value}))),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"メンテナンス内容の詳細説明（任意）"})]}),m.jsxs("div",{className:"flex items-center space-x-6",children:[m.jsxs("label",{className:"flex items-center space-x-2",children:[m.jsx("input",{type:"checkbox",checked:ne.is_emergency,onChange:e=>de((s=>n(i({},s),{is_emergency:e.target.checked}))),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),m.jsx("span",{className:"text-sm text-gray-700",children:"緊急メンテナンス"})]}),m.jsxs("label",{className:"flex items-center space-x-2",children:[m.jsx("input",{type:"checkbox",checked:ne.notify_users,onChange:e=>de((s=>n(i({},s),{notify_users:e.target.checked}))),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),m.jsx("span",{className:"text-sm text-gray-700",children:"ユーザーに通知"})]})]}),m.jsxs("div",{className:"flex justify-end space-x-3",children:[m.jsx(h,{type:"button",variant:"secondary",onClick:()=>ie(!1),children:"キャンセル"}),m.jsx(h,{type:"submit",isLoading:xe,className:"bg-blue-600 hover:bg-blue-700",children:"作成"})]})]})]}),m.jsx("div",{className:"space-y-4",children:0===ae.length?m.jsxs("div",{className:"text-center py-8 text-gray-500",children:[m.jsx(R,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),m.jsx("p",{className:"text-lg font-medium mb-2",children:"メンテナンス予定がありません"}),m.jsx("p",{className:"text-sm",children:"施設のメンテナンス予定を追加してください"})]}):ae.map((e=>{const s=(e=>{const s=new Date,t=new Date(e.start_date),l=new Date(e.end_date);return"cancelled"===e.status?{status:"cancelled",label:"キャンセル済み",color:"bg-gray-500"}:"completed"===e.status?{status:"completed",label:"完了",color:"bg-gray-500"}:s>=t&&s<l?{status:"active",label:"メンテナンス中",color:"bg-red-500"}:s<t?{status:"scheduled",label:"予定",color:"bg-yellow-500"}:{status:"completed",label:"完了",color:"bg-gray-500"}})(e);return m.jsx(o,{className:"p-4",children:m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsxs("div",{className:"flex-1",children:[m.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[m.jsx("h3",{className:"font-semibold text-lg",children:e.title}),m.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium text-white ${s.color}`,children:s.label}),e.is_emergency&&m.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"緊急"})]}),e.description&&m.jsx("p",{className:"text-gray-600 mb-3",children:e.description}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[m.jsxs("div",{children:[m.jsx("span",{className:"font-medium",children:"開始:"})," ",ye(e.start_date)]}),m.jsxs("div",{children:[m.jsx("span",{className:"font-medium",children:"終了:"})," ",ye(e.end_date)]})]})]}),m.jsx("div",{className:"flex items-center space-x-2",children:"scheduled"===e.status&&m.jsx(h,{size:"sm",variant:"secondary",onClick:()=>{return s=e.id,d(null,null,(function*(){if(window.confirm("このメンテナンススケジュールを削除しますか？"))try{const{error:e}=yield u.from("park_maintenance").delete().eq("id",s);if(e)throw e;U("メンテナンススケジュールを削除しました。"),yield Ne()}catch(e){w("メンテナンススケジュールの削除に失敗しました。")}}));var s},className:"text-red-600 hover:text-red-800",children:m.jsx(M,{className:"w-4 h-4"})})})]})},e.id)}))}),m.jsx("div",{className:"mt-6 p-4 bg-yellow-50 rounded-lg",children:m.jsxs("div",{className:"flex items-start space-x-3",children:[m.jsx(_,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),m.jsxs("div",{className:"text-sm text-yellow-800",children:[m.jsx("p",{className:"font-medium mb-1",children:"メンテナンス機能について"}),m.jsxs("ul",{className:"space-y-1",children:[m.jsx("li",{children:"• メンテナンス中は新規予約を受け付けません"}),m.jsx("li",{children:"• 既存の予約がある場合は事前に利用者に連絡してください"}),m.jsx("li",{children:"• 緊急メンテナンスの場合は即座に施設が利用停止になります"}),m.jsx("li",{children:"• ユーザー通知を有効にすると、利用者にメール通知が送信されます"})]})]})]})})]}),m.jsx(o,{className:"p-6 bg-gray-50",children:m.jsxs("div",{className:"flex items-start space-x-3",children:[m.jsx(q,{className:"w-6 h-6 text-gray-600 mt-1"}),m.jsxs("div",{children:[m.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"運営サポート"}),m.jsxs("div",{className:"text-sm text-gray-700 space-y-1",children:[m.jsx("p",{children:"• 設定に関するご質問は運営事務局までお問い合わせください"}),m.jsx("p",{children:"• QRコードシステムの設置・設定サポートを提供しています"}),m.jsx("p",{children:"• 運営開始後も継続的なサポートを行います"}),m.jsx("p",{children:"• 📧 サポート窓口: info@dogparkjp.com"})]})]})]})})]})]}):m.jsxs("div",{className:"max-w-4xl mx-auto text-center py-12",children:[m.jsx(_,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),m.jsx("h2",{className:"text-2xl font-bold mb-2",children:"ドッグランが見つかりません"}),m.jsx("p",{className:"text-gray-600 mb-6",children:"指定されたドッグランが見つからないか、アクセス権限がありません。"}),m.jsx(b,{to:"/owner-dashboard",children:m.jsx(h,{children:"ダッシュボードに戻る"})})]})}export{U as ParkManagement};
