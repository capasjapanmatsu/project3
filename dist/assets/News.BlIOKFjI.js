var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,c=(e,s)=>{for(var a in s||(s={}))r.call(s,a)&&l(e,a,s[a]);if(t)for(var a of t(s))n.call(s,a)&&l(e,a,s[a]);return e},i=(e,t)=>s(e,a(t));import{s as o,j as x,C as d}from"./index.D9xag4tn.js";import{r as m,L as h}from"./router.BWT_vQps.js";import{I as p}from"./Input.tFQgyGuP.js";import{a3 as j,a4 as u,F as g,a5 as f,a6 as w,p as b,c as y,V as N,b as v}from"./ui.BPlS2KKq.js";import"./vendor.D1SiiUJb.js";import"./supabase.CZ8ekJUM.js";function C(){const[e,s]=m.useState([]),[a,t]=m.useState([]),[r,n]=m.useState(!0),[l,C]=m.useState(""),[k,O]=m.useState(""),[_,L]=m.useState("all");m.useEffect((()=>{P()}),[]);const P=()=>{return e=null,a=null,r=function*(){try{n(!0);const{data:e,error:a}=yield o.from("news_announcements").select("*").order("created_at",{ascending:!1});if(a)throw a;const{data:r,error:l}=yield o.from("new_park_openings").select("*").order("created_at",{ascending:!1});if(l)throw l;s(e||[]),t(r||[])}catch(e){C("新着情報の取得に失敗しました。")}finally{n(!1)}},new Promise(((s,t)=>{var n=e=>{try{c(r.next(e))}catch(s){t(s)}},l=e=>{try{c(r.throw(e))}catch(s){t(s)}},c=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,l);c((r=r.apply(e,a)).next())}));var e,a,r},S=e=>({news:"お知らせ",announcement:"重要なお知らせ",sale:"セール情報"}[e]||e),D=e=>{switch(e){case"news":return x.jsx(g,{className:"w-4 h-4"});case"announcement":return x.jsx(f,{className:"w-4 h-4"});case"sale":return x.jsx(w,{className:"w-4 h-4"});default:return x.jsx(j,{className:"w-4 h-4"})}},$=e=>new Date(e).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}),I=e.filter((e=>{const s=e.title.toLowerCase().includes(k.toLowerCase())||e.content.toLowerCase().includes(k.toLowerCase()),a="all"===_||e.category===_;return s&&a})),J=a.filter((e=>e.name.toLowerCase().includes(k.toLowerCase())||e.address.toLowerCase().includes(k.toLowerCase()))),E=[...I.map((e=>i(c({},e),{type:"news",date:e.created_at}))),...J.map((e=>i(c({},e),{type:"park",date:e.created_at})))].sort(((e,s)=>new Date(s.date).getTime()-new Date(e.date).getTime()));return r?x.jsx("div",{className:"flex justify-center items-center h-64",children:x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):l?x.jsx("div",{className:"flex justify-center items-center h-64",children:x.jsxs("div",{className:"text-red-500",children:["エラー: ",l]})}):0===e.length&&0===a.length?x.jsx("div",{className:"flex justify-center items-center h-64",children:x.jsxs("div",{children:["データがありません（APIレスポンス: news=",JSON.stringify(e),", newParks=",JSON.stringify(a),")"]})}):x.jsxs("div",{className:"max-w-4xl mx-auto",children:[x.jsxs("h1",{className:"text-2xl font-bold mb-8 flex items-center",children:[x.jsx(j,{className:"w-8 h-8 text-blue-600 mr-3"}),"新着情報"]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[x.jsx("div",{className:"md:col-span-2",children:x.jsx(p,{label:"",value:k,onChange:e=>O(e.target.value),placeholder:"タイトル、内容で検索...",icon:x.jsx(u,{className:"w-4 h-4 text-gray-500"})})}),x.jsx("div",{children:x.jsxs("select",{value:_,onChange:e=>L(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[x.jsx("option",{value:"all",children:"すべてのカテゴリー"}),x.jsx("option",{value:"news",children:"お知らせ"}),x.jsx("option",{value:"announcement",children:"重要なお知らせ"}),x.jsx("option",{value:"sale",children:"セール情報"})]})})]}),x.jsxs("div",{className:"flex space-x-2 overflow-x-auto pb-2 mb-6",children:[x.jsxs("button",{onClick:()=>L("all"),className:"flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors "+("all"===_?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[x.jsx(j,{className:"w-4 h-4"}),x.jsx("span",{children:"すべて"})]}),x.jsxs("button",{onClick:()=>L("news"),className:"flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors "+("news"===_?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[x.jsx(g,{className:"w-4 h-4"}),x.jsx("span",{children:"お知らせ"})]}),x.jsxs("button",{onClick:()=>L("announcement"),className:"flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors "+("announcement"===_?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[x.jsx(f,{className:"w-4 h-4"}),x.jsx("span",{children:"重要なお知らせ"})]}),x.jsxs("button",{onClick:()=>L("sale"),className:"flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors "+("sale"===_?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[x.jsx(w,{className:"w-4 h-4"}),x.jsx("span",{children:"セール情報"})]})]}),l&&x.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start",children:[x.jsx(b,{className:"w-5 h-5 text-red-600 mt-0.5 mr-3 flex-shrink-0"}),x.jsx("p",{className:"text-red-800",children:l})]}),0===E.length?x.jsxs(d,{className:"text-center py-12",children:[x.jsx(j,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),x.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"新着情報はありません"}),x.jsx("p",{className:"text-gray-500",children:"現在、表示できる新着情報はありません。"})]}):x.jsx("div",{className:"space-y-6",children:E.map((e=>{if("news"===e.type){const a=e;return x.jsx(h,{to:`/news/${a.id}`,children:x.jsx(d,{className:"p-6 hover:shadow-lg transition-shadow",children:x.jsxs("div",{className:"flex justify-between items-start",children:[x.jsxs("div",{className:"flex-1",children:[x.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[x.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex items-center space-x-1 ${s=a.category,{news:"bg-blue-100 text-blue-800",announcement:"bg-red-100 text-red-800",sale:"bg-green-100 text-green-800"}[s]||"bg-gray-100 text-gray-800"}`,children:[D(a.category),x.jsx("span",{children:S(a.category)})]}),a.is_important&&x.jsx("span",{className:"bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-medium",children:"重要"})]}),x.jsx("h3",{className:"text-lg font-semibold mb-2",children:a.title}),x.jsx("p",{className:"text-gray-600 line-clamp-2",children:a.content})]}),x.jsxs("div",{className:"flex flex-col items-end",children:[x.jsxs("div",{className:"flex items-center text-gray-500 text-sm mb-2",children:[x.jsx(y,{className:"w-4 h-4 mr-1"}),x.jsx("span",{children:$(a.created_at)})]}),x.jsx(N,{className:"w-5 h-5 text-gray-400"})]})]})})},`news-${a.id}`)}if("park"===e.type){const s=e;return x.jsx(h,{to:`/news/park/${s.id}`,children:x.jsx(d,{className:"p-6 hover:shadow-lg transition-shadow",children:x.jsxs("div",{className:"flex justify-between items-start",children:[x.jsxs("div",{className:"flex-1",children:[x.jsx("div",{className:"flex items-center space-x-2 mb-2",children:x.jsxs("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium flex items-center space-x-1",children:[x.jsx(v,{className:"w-3 h-3"}),x.jsx("span",{children:"新規オープン"})]})}),x.jsx("h3",{className:"text-lg font-semibold mb-2",children:s.name}),x.jsx("p",{className:"text-gray-600 mb-2",children:s.address}),x.jsxs("div",{className:"flex items-center text-gray-500 text-sm",children:[x.jsx(y,{className:"w-4 h-4 mr-1"}),x.jsxs("span",{children:["オープン予定: ",$(s.opening_date)]})]})]}),x.jsxs("div",{className:"flex flex-col items-end",children:[x.jsxs("div",{className:"flex items-center text-gray-500 text-sm mb-2",children:[x.jsx(y,{className:"w-4 h-4 mr-1"}),x.jsx("span",{children:$(s.created_at)})]}),x.jsx(N,{className:"w-5 h-5 text-gray-400"})]})]})})},`park-${s.id}`)}var s}))})]})}export{C as News};
