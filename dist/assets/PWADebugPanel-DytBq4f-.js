import{j as e,e as w,X as b,aW as y,b0 as W,W as h,a0 as k,R as j}from"./ui-vendor-FlUr4cJt.js";import{r as t}from"./react-vendor-_GyjDmDn.js";import{l as f}from"./index-BSYT0262.js";import"./supabase-vendor-Df9iqQzW.js";const P=({isOpen:i,onClose:g})=>{const[s,o]=t.useState(null),[c,x]=t.useState([]),[l,m]=t.useState(navigator.onLine),[r,S]=t.useState({canInstall:!1,isInstalled:window.matchMedia("(display-mode: standalone)").matches,platform:navigator.platform,userAgent:navigator.userAgent.substring(0,50)+"..."});t.useEffect(()=>{if(!i)return;navigator.serviceWorker.getRegistration().then(d=>{o(d||null)}),"caches"in window&&caches.keys().then(d=>{x(d)});const a=()=>m(!0),n=()=>m(!1);return window.addEventListener("online",a),window.addEventListener("offline",n),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",n)}},[i]);const u=async()=>{if("caches"in window){const a=await caches.keys();await Promise.all(a.map(n=>caches.delete(n))),x([]),f("info","🗑️ 全キャッシュをクリアしました"),alert("全キャッシュをクリアしました")}},p=async()=>{s&&(await s.unregister(),o(null),f("info","🗑️ Service Worker を登録解除しました"),alert("Service Worker を登録解除しました"))},N=()=>{window.location.reload()},v=()=>{l&&alert("実際のオフラインテストはブラウザのDevToolsを使用してください")};return i?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(w,{className:"w-5 h-5 mr-2"}),"PWA デバッグパネル"]}),e.jsx("button",{onClick:g,className:"text-gray-500 hover:text-gray-700",children:e.jsx(b,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium mb-3 flex items-center",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"システム情報"]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"PWA モード:"}),e.jsx("span",{className:r.isInstalled?"text-green-600":"text-gray-600",children:r.isInstalled?"インストール済み":"未インストール"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"ネットワーク状態:"}),e.jsxs("span",{className:`flex items-center ${l?"text-green-600":"text-red-600"}`,children:[l?e.jsx(W,{className:"w-4 h-4 mr-1"}):e.jsx(h,{className:"w-4 h-4 mr-1"}),l?"オンライン":"オフライン"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"プラットフォーム:"}),e.jsx("span",{className:"text-gray-600",children:r.platform})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"User Agent:"}),e.jsx("span",{className:"text-gray-600 text-xs",children:r.userAgent})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-3",children:"Service Worker"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"状態:"}),e.jsx("span",{className:s?"text-green-600":"text-red-600",children:s?"登録済み":"未登録"})]}),s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"スコープ:"}),e.jsx("span",{className:"text-gray-600",children:s.scope})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"アクティブ:"}),e.jsx("span",{className:s.active?"text-green-600":"text-red-600",children:s.active?"はい":"いいえ"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-3",children:"キャッシュ情報"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-sm",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"キャッシュ数: "}),e.jsxs("span",{className:"text-gray-600",children:[c.length,"個"]})]}),c.length>0&&e.jsx("div",{className:"space-y-1",children:c.map((a,n)=>e.jsx("div",{className:"text-xs text-gray-500 bg-white p-1 rounded",children:a},n))})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-3",children:"操作"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:u,className:"flex items-center justify-center px-3 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"キャッシュクリア"]}),e.jsxs("button",{onClick:p,className:"flex items-center justify-center px-3 py-2 bg-orange-100 text-orange-700 rounded-lg hover:bg-orange-200 transition-colors",disabled:!s,children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"SW登録解除"]}),e.jsxs("button",{onClick:N,className:"flex items-center justify-center px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"ページ再読み込み"]}),e.jsxs("button",{onClick:v,className:"flex items-center justify-center px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),"オフラインテスト"]})]})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[e.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"注意事項"}),e.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[e.jsx("li",{children:"• このパネルは開発環境でのみ表示されます"}),e.jsx("li",{children:"• オフラインテストはブラウザのDevToolsで行ってください"}),e.jsx("li",{children:"• キャッシュクリア後はページが再読み込みされる場合があります"}),e.jsx("li",{children:"• Service Worker の変更は再登録が必要です"})]})]})]})]})}):null};export{P as PWADebugPanel,P as default};
