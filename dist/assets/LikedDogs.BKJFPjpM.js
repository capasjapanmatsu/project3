/*! Build: 2025-07-17T07:59:15.523Z
Version: 0.0.0 */
import{u as e,r as s,j as a,n as t,A as r,ag as l,K as i,$ as o,p as n,U as d}from"./vendor-react.D8SVeCGP.js";import{u as c,C as m,B as x}from"./components-admin.GT3qRZg5.js";import{S as g}from"./index.DW9BntGF.js";import{s as h}from"./utils.C9ZsMnW6.js";import"./vendor-misc.qnLj5toF.js";import"./hooks.CTtJlocA.js";import"./vendor-stripe.B5MJ2ewd.js";import"./pages-dog.BrfoFXaJ.js";import"./vendor-ui.PcbqjdkP.js";import"./vendor-supabase.RBPF72ft.js";function u(){const{user:u}=c(),j=e(),[p,f]=s.useState([]),[v,b]=s.useState([]),[N,w]=s.useState(!0),[y,_]=s.useState(""),[C,k]=s.useState(""),[S,D]=s.useState(""),[L,T]=s.useState(""),[$,q]=s.useState("latest");s.useEffect((()=>{u?M():j("/login")}),[u,j]),s.useEffect((()=>{E()}),[p,C,S,L,$]);const M=async()=>{try{w(!0),_("");const{data:e,error:s}=await h.from("dog_likes").select("\n          *,\n          dog:dogs (\n            *,\n            vaccine_certifications (*)\n          )\n        ").eq("user_id",null==u?void 0:u.id).order("created_at",{ascending:!1});if(s)throw s;f(e||[])}catch(e){_("いいねしたワンちゃんの情報を取得できませんでした。")}finally{w(!1)}},E=()=>{let e=[...p];switch(C&&(e=e.filter((e=>e.dog.name.toLowerCase().includes(C.toLowerCase())||e.dog.breed.toLowerCase().includes(C.toLowerCase())))),S&&(e=e.filter((e=>e.dog.breed===S))),L&&(e=e.filter((e=>e.dog.gender===L))),$){case"name":e.sort(((e,s)=>e.dog.name.localeCompare(s.dog.name)));break;case"breed":e.sort(((e,s)=>e.dog.breed.localeCompare(s.dog.breed)));break;default:e.sort(((e,s)=>new Date(s.created_at).getTime()-new Date(e.created_at).getTime()))}b(e)},z=e=>{const s=new Date(e),a=new Date,t=Math.abs(a.getTime()-s.getTime()),r=Math.ceil(t/864e5);return r<365?`${Math.floor(r/30)}ヶ月`:`${Math.floor(r/365)}歳`};return N?a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a.jsx("div",{className:"flex items-center justify-center py-20",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsx(g,{title:"いいねしたワンちゃん | ドッグパーク",description:"あなたがいいねしたワンちゃんの一覧です。お気に入りのワンちゃんを管理しましょう。",keywords:"いいね, ワンちゃん, ペット, 犬, お気に入り"}),a.jsxs("div",{className:"mb-8",children:[a.jsx("div",{className:"flex items-center space-x-4 mb-4",children:a.jsxs(t,{to:"/dashboard",className:"flex items-center text-blue-600 hover:text-blue-800 transition-colors",children:[a.jsx(r,{className:"w-5 h-5 mr-2"}),"マイページに戻る"]})}),a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx(l,{className:"w-8 h-8 text-pink-600"}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"いいねしたワンちゃん"})]}),a.jsxs("p",{className:"text-gray-600",children:["あなたがいいねしたワンちゃんの一覧です（",p.length,"匹）"]})]}),y&&a.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:y}),a.jsx(m,{className:"p-6 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"名前・犬種で検索...",value:C,onChange:e=>k(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("select",{value:S,onChange:e=>D(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"すべての犬種"}),[...new Set(p.map((e=>e.dog.breed)))].sort().map((e=>a.jsx("option",{value:e,children:e},e)))]}),a.jsxs("select",{value:L,onChange:e=>T(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"すべての性別"}),a.jsx("option",{value:"オス",children:"オス"}),a.jsx("option",{value:"メス",children:"メス"})]}),a.jsxs("select",{value:$,onChange:e=>q(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"latest",children:"いいねした順"}),a.jsx("option",{value:"name",children:"名前順"}),a.jsx("option",{value:"breed",children:"犬種順"})]})]})}),0===v.length?a.jsxs(m,{className:"text-center py-16",children:[a.jsx(l,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:0===p.length?"まだいいねしたワンちゃんはいません":"検索条件に合うワンちゃんがいません"}),a.jsx("p",{className:"text-gray-600 mb-6",children:0===p.length?"気になるワンちゃんがいたら、いいねしてみましょう！":"別の検索条件を試してみてください。"}),a.jsxs("div",{className:"space-x-4",children:[a.jsx(t,{to:"/community",children:a.jsx(x,{children:"コミュニティを見る"})}),p.length>0&&a.jsx(x,{variant:"secondary",onClick:()=>{k(""),D(""),T(""),q("latest")},children:"フィルターをクリア"})]})]}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:v.map((e=>a.jsxs(m,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"aspect-square bg-gray-200 overflow-hidden relative",children:[e.dog.image_url?a.jsx("img",{src:e.dog.image_url,alt:e.dog.name,className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-6xl",children:"🐕"}),a.jsx("button",{onClick:()=>(async e=>{try{const{error:s}=await h.from("dog_likes").delete().eq("dog_id",e).eq("user_id",null==u?void 0:u.id);if(s)throw s;f((s=>s.filter((s=>s.dog_id!==e))))}catch(s){}})(e.dog_id),className:"absolute top-2 right-2 p-2 bg-white bg-opacity-90 hover:bg-opacity-100 rounded-full transition-opacity",title:"いいねを取り消す",children:a.jsx(l,{className:"w-4 h-4 text-pink-500 fill-current"})})]}),a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h3",{className:"font-semibold text-lg text-gray-900 truncate",children:[e.dog.name,"オス"===e.dog.gender?"くん":"ちゃん"]}),a.jsx("span",{className:"text-sm text-gray-500",children:"オス"===e.dog.gender?"♂":"♀"})]}),a.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(o,{className:"w-4 h-4 mr-1"}),a.jsx("span",{children:e.dog.breed})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(n,{className:"w-4 h-4 mr-1"}),a.jsx("span",{children:z(e.dog.birth_date)})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(l,{className:"w-4 h-4 mr-1 text-pink-500"}),a.jsx("span",{children:new Date(e.created_at).toLocaleDateString("ja-JP")})]})]}),a.jsxs("div",{className:"mt-4 flex space-x-2",children:[a.jsx(t,{to:`/dog/${e.dog_id}`,className:"flex-1",children:a.jsx(x,{size:"sm",className:"w-full",children:"詳細を見る"})}),a.jsx(t,{to:`/profile/${e.dog.owner_id}`,title:"飼い主のプロフィール",children:a.jsx(x,{size:"sm",variant:"secondary",children:a.jsx(d,{className:"w-4 h-4"})})})]})]})]},e.id)))}),v.length>8&&a.jsx("div",{className:"mt-8 text-center",children:a.jsx(x,{variant:"secondary",onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),children:"ページトップに戻る"})})]})}export{u as LikedDogs};
