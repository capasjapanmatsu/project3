import{j as e,J as $,G as x,a0 as G,x as U,i as z,c as J}from"./ui-vendor-w2MLOks7.js";import{u as F,r as t,L as g}from"./react-vendor-_GyjDmDn.js";import{u as H,s as C,S as O,C as j,B as n}from"./index-pj4YkVsE.js";import"./supabase-vendor-Df9iqQzW.js";function Q(){const{user:c}=H(),p=F(),[l,b]=t.useState([]),[m,D]=t.useState([]),[L,v]=t.useState(!0),[N,w]=t.useState(""),[o,y]=t.useState(""),[i,k]=t.useState(""),[d,S]=t.useState(""),[h,_]=t.useState("latest");t.useEffect(()=>{if(!c){p("/login");return}E()},[c,p]),t.useEffect(()=>{T()},[l,o,i,d,h]);const E=async()=>{try{v(!0),w("");const{data:s,error:r}=await C.from("dog_likes").select(`
          *,
          dog:dogs (
            *,
            vaccine_certifications (*)
          )
        `).eq("user_id",c?.id).order("created_at",{ascending:!1});if(r)throw r;b(s||[])}catch(s){console.error("Error fetching liked dogs:",s),w("ã„ã„ã­ã—ãŸãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚")}finally{v(!1)}},T=()=>{let s=[...l];switch(o&&(s=s.filter(r=>r.dog.name.toLowerCase().includes(o.toLowerCase())||r.dog.breed.toLowerCase().includes(o.toLowerCase()))),i&&(s=s.filter(r=>r.dog.breed===i)),d&&(s=s.filter(r=>r.dog.gender===d)),h){case"name":s.sort((r,a)=>r.dog.name.localeCompare(a.dog.name));break;case"breed":s.sort((r,a)=>r.dog.breed.localeCompare(a.dog.breed));break;case"latest":default:s.sort((r,a)=>new Date(a.created_at).getTime()-new Date(r.created_at).getTime());break}D(s)},B=async s=>{try{const{error:r}=await C.from("dog_likes").delete().eq("dog_id",s).eq("user_id",c?.id);if(r)throw r;b(a=>a.filter(u=>u.dog_id!==s))}catch(r){console.error("Error unliking dog:",r)}},q=()=>[...new Set(l.map(r=>r.dog.breed))].sort(),A=s=>{const r=new Date(s),u=Math.abs(new Date().getTime()-r.getTime()),f=Math.ceil(u/(1e3*60*60*24));return f<365?`${Math.floor(f/30)}ãƒ¶æœˆ`:`${Math.floor(f/365)}æ­³`};return L?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(O,{title:"ã„ã„ã­ã—ãŸãƒ¯ãƒ³ã¡ã‚ƒã‚“ | ãƒ‰ãƒƒã‚°ãƒ‘ãƒ¼ã‚¯",description:"ã‚ãªãŸãŒã„ã„ã­ã—ãŸãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®ä¸€è¦§ã§ã™ã€‚ãŠæ°—ã«å…¥ã‚Šã®ãƒ¯ãƒ³ã¡ã‚ƒã‚“ã‚’ç®¡ç†ã—ã¾ã—ã‚‡ã†ã€‚",keywords:"ã„ã„ã­, ãƒ¯ãƒ³ã¡ã‚ƒã‚“, ãƒšãƒƒãƒˆ, çŠ¬, ãŠæ°—ã«å…¥ã‚Š"}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center space-x-4 mb-4",children:e.jsxs(g,{to:"/dashboard",className:"flex items-center text-blue-600 hover:text-blue-800 transition-colors",children:[e.jsx($,{className:"w-5 h-5 mr-2"}),"ãƒã‚¤ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹"]})}),e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(x,{className:"w-8 h-8 text-pink-600"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"ã„ã„ã­ã—ãŸãƒ¯ãƒ³ã¡ã‚ƒã‚“"})]}),e.jsxs("p",{className:"text-gray-600",children:["ã‚ãªãŸãŒã„ã„ã­ã—ãŸãƒ¯ãƒ³ã¡ã‚ƒã‚“ã®ä¸€è¦§ã§ã™ï¼ˆ",l.length,"åŒ¹ï¼‰"]})]}),N&&e.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:N}),e.jsx(j,{className:"p-6 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"åå‰ãƒ»çŠ¬ç¨®ã§æ¤œç´¢...",value:o,onChange:s=>y(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("select",{value:i,onChange:s=>k(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"ã™ã¹ã¦ã®çŠ¬ç¨®"}),q().map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{value:d,onChange:s=>S(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"ã™ã¹ã¦ã®æ€§åˆ¥"}),e.jsx("option",{value:"ã‚ªã‚¹",children:"ã‚ªã‚¹"}),e.jsx("option",{value:"ãƒ¡ã‚¹",children:"ãƒ¡ã‚¹"})]}),e.jsxs("select",{value:h,onChange:s=>_(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"latest",children:"ã„ã„ã­ã—ãŸé †"}),e.jsx("option",{value:"name",children:"åå‰é †"}),e.jsx("option",{value:"breed",children:"çŠ¬ç¨®é †"})]})]})}),m.length===0?e.jsxs(j,{className:"text-center py-16",children:[e.jsx(x,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:l.length===0?"ã¾ã ã„ã„ã­ã—ãŸãƒ¯ãƒ³ã¡ã‚ƒã‚“ã¯ã„ã¾ã›ã‚“":"æ¤œç´¢æ¡ä»¶ã«åˆã†ãƒ¯ãƒ³ã¡ã‚ƒã‚“ãŒã„ã¾ã›ã‚“"}),e.jsx("p",{className:"text-gray-600 mb-6",children:l.length===0?"æ°—ã«ãªã‚‹ãƒ¯ãƒ³ã¡ã‚ƒã‚“ãŒã„ãŸã‚‰ã€ã„ã„ã­ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼":"åˆ¥ã®æ¤œç´¢æ¡ä»¶ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚"}),e.jsxs("div",{className:"space-x-4",children:[e.jsx(g,{to:"/community",children:e.jsx(n,{children:"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚’è¦‹ã‚‹"})}),l.length>0&&e.jsx(n,{variant:"secondary",onClick:()=>{y(""),k(""),S(""),_("latest")},children:"ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ã‚¯ãƒªã‚¢"})]})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:m.map(s=>e.jsxs(j,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"aspect-square bg-gray-200 overflow-hidden relative",children:[s.dog.image_url?e.jsx("img",{src:s.dog.image_url,alt:s.dog.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-6xl",children:"ğŸ•"}),e.jsx("button",{onClick:()=>B(s.dog_id),className:"absolute top-2 right-2 p-2 bg-white bg-opacity-90 hover:bg-opacity-100 rounded-full transition-opacity",title:"ã„ã„ã­ã‚’å–ã‚Šæ¶ˆã™",children:e.jsx(x,{className:"w-4 h-4 text-pink-500 fill-current"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"font-semibold text-lg text-gray-900 truncate",children:[s.dog.name,s.dog.gender==="ã‚ªã‚¹"?"ãã‚“":"ã¡ã‚ƒã‚“"]}),e.jsx("span",{className:"text-sm text-gray-500",children:s.dog.gender==="ã‚ªã‚¹"?"â™‚":"â™€"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:s.dog.breed})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:A(s.dog.birth_date)})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(x,{className:"w-4 h-4 mr-1 text-pink-500"}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString("ja-JP")})]})]}),e.jsxs("div",{className:"mt-4 flex space-x-2",children:[e.jsx(g,{to:`/dog/${s.dog_id}`,className:"flex-1",children:e.jsx(n,{size:"sm",className:"w-full",children:"è©³ç´°ã‚’è¦‹ã‚‹"})}),e.jsx(g,{to:`/profile/${s.dog.owner_id}`,title:"é£¼ã„ä¸»ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«",children:e.jsx(n,{size:"sm",variant:"secondary",children:e.jsx(J,{className:"w-4 h-4"})})})]})]})]},s.id))}),m.length>8&&e.jsx("div",{className:"mt-8 text-center",children:e.jsx(n,{variant:"secondary",onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),children:"ãƒšãƒ¼ã‚¸ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹"})})]})}export{Q as LikedDogs};
