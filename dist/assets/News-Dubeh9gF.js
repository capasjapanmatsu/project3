import{s as w,j as e,C as h}from"./index-fyCrE4_U.js";import{r,L as f}from"./react-vendor-Co5xHYdE.js";import{I as A}from"./Input-B2nqC8Ef.js";import{B as i,a4 as J,F as N,s as b,T as y,A as B,o as g,ac as v,b as F}from"./ui-vendor-C9ptRAmi.js";import"./supabase-vendor-FDBaXLCh.js";function G(){const[o,C]=r.useState([]),[x,k]=r.useState([]),[L,p]=r.useState(!0),[c,S]=r.useState(""),[n,_]=r.useState(""),[t,l]=r.useState("all");r.useEffect(()=>{$()},[]);const $=async()=>{try{p(!0);const{data:s,error:a}=await w.from("news_announcements").select("*").order("created_at",{ascending:!1});if(a)throw a;const{data:m,error:j}=await w.from("new_park_openings").select("*").order("created_at",{ascending:!1});if(j)throw j;C(s||[]),k(m||[])}catch(s){console.error("Error fetching news:",s),S("新着情報の取得に失敗しました。")}finally{p(!1)}},I=s=>({news:"お知らせ",announcement:"重要なお知らせ",sale:"セール情報"})[s]||s,T=s=>({news:"bg-blue-100 text-blue-800",announcement:"bg-red-100 text-red-800",sale:"bg-green-100 text-green-800"})[s]||"bg-gray-100 text-gray-800",D=s=>{switch(s){case"news":return e.jsx(N,{className:"w-4 h-4"});case"announcement":return e.jsx(b,{className:"w-4 h-4"});case"sale":return e.jsx(y,{className:"w-4 h-4"});default:return e.jsx(i,{className:"w-4 h-4"})}},d=s=>new Date(s).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}),E=o.filter(s=>{const a=s.title.toLowerCase().includes(n.toLowerCase())||s.content.toLowerCase().includes(n.toLowerCase()),m=t==="all"||s.category===t;return a&&m}),P=x.filter(s=>s.name.toLowerCase().includes(n.toLowerCase())||s.address.toLowerCase().includes(n.toLowerCase())),u=[...E.map(s=>({...s,type:"news",date:s.created_at})),...P.map(s=>({...s,type:"park",date:s.created_at}))].sort((s,a)=>new Date(a.date).getTime()-new Date(s.date).getTime());return L?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"text-red-500",children:["エラー: ",c]})}):o.length===0&&x.length===0?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{children:["データがありません（APIレスポンス: news=",JSON.stringify(o),", newParks=",JSON.stringify(x),")"]})}):e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("h1",{className:"text-2xl font-bold mb-8 flex items-center",children:[e.jsx(i,{className:"w-8 h-8 text-blue-600 mr-3"}),"新着情報"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(A,{label:"",value:n,onChange:s=>_(s.target.value),placeholder:"タイトル、内容で検索...",icon:e.jsx(J,{className:"w-4 h-4 text-gray-500"})})}),e.jsx("div",{children:e.jsxs("select",{value:t,onChange:s=>l(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"すべてのカテゴリー"}),e.jsx("option",{value:"news",children:"お知らせ"}),e.jsx("option",{value:"announcement",children:"重要なお知らせ"}),e.jsx("option",{value:"sale",children:"セール情報"})]})})]}),e.jsxs("div",{className:"flex space-x-2 overflow-x-auto pb-2 mb-6",children:[e.jsxs("button",{onClick:()=>l("all"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${t==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(i,{className:"w-4 h-4"}),e.jsx("span",{children:"すべて"})]}),e.jsxs("button",{onClick:()=>l("news"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${t==="news"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{children:"お知らせ"})]}),e.jsxs("button",{onClick:()=>l("announcement"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${t==="announcement"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(b,{className:"w-4 h-4"}),e.jsx("span",{children:"重要なお知らせ"})]}),e.jsxs("button",{onClick:()=>l("sale"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${t==="sale"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{children:"セール情報"})]})]}),c&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg flex items-start",children:[e.jsx(B,{className:"w-5 h-5 text-red-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsx("p",{className:"text-red-800",children:c})]}),u.length===0?e.jsxs(h,{className:"text-center py-12",children:[e.jsx(i,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"新着情報はありません"}),e.jsx("p",{className:"text-gray-500",children:"現在、表示できる新着情報はありません。"})]}):e.jsx("div",{className:"space-y-6",children:u.map(s=>{if(s.type==="news"){const a=s;return e.jsx(f,{to:`/news/${a.id}`,children:e.jsx(h,{className:"p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex items-center space-x-1 ${T(a.category)}`,children:[D(a.category),e.jsx("span",{children:I(a.category)})]}),a.is_important&&e.jsx("span",{className:"bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-medium",children:"重要"})]}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:a.title}),e.jsx("p",{className:"text-gray-600 line-clamp-2",children:a.content})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("div",{className:"flex items-center text-gray-500 text-sm mb-2",children:[e.jsx(g,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:d(a.created_at)})]}),e.jsx(v,{className:"w-5 h-5 text-gray-400"})]})]})})},`news-${a.id}`)}else if(s.type==="park"){const a=s;return e.jsx(f,{to:`/news/park/${a.id}`,children:e.jsx(h,{className:"p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsxs("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium flex items-center space-x-1",children:[e.jsx(F,{className:"w-3 h-3"}),e.jsx("span",{children:"新規オープン"})]})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:a.name}),e.jsx("p",{className:"text-gray-600 mb-2",children:a.address}),e.jsxs("div",{className:"flex items-center text-gray-500 text-sm",children:[e.jsx(g,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{children:["オープン予定: ",d(a.opening_date)]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("div",{className:"flex items-center text-gray-500 text-sm mb-2",children:[e.jsx(g,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:d(a.created_at)})]}),e.jsx(v,{className:"w-5 h-5 text-gray-400"})]})]})})},`park-${a.id}`)}})})]})}export{G as News};
