# 🚀 フローティングアクションボタン（FAB）ガイド

## 📱 **概要**

フローティングアクションボタンは、お店での利用を想定した実用的な機能です。ユーザーが簡単にクーポンを表示したり、ワクチン証明書を提示できるように設計されています。

---

## ✨ **実装済み機能**

### **🎫 クーポン表示機能**
- ✅ ユーザーが取得したクーポンの一覧表示
- ✅ クーポンの詳細表示（QRコード付き）
- ✅ 有効期限切れクーポンの自動非表示
- ✅ 店舗での使用を想定した大きな表示

### **🛡️ ワクチン証明書表示機能**
- 🔄 **現在準備中**（段階的実装）
- 📋 将来的に実装予定の機能

---

## 🎯 **使用場面**

### **店舗での利用**
```
👨‍💼 店員: 「クーポンはお持ちですか？」
👤 ユーザー: FABをタップ → クーポン選択 → 画面提示
👨‍💼 店員: QRコードをスキャンして割引適用
```

### **施設入場時**
```
🏢 受付: 「ワクチン証明書を確認させてください」
👤 ユーザー: FAB → ワクチン証明書選択 → 証明書表示
🏢 受付: 有効期限と接種記録を確認
```

---

## 🛠️ **技術仕様**

### **ファイル構成**
```
src/components/
├── FloatingActionButton.tsx  # メインコンポーネント
├── Layout.tsx                # FABの配置
└── coupons/
    └── CouponDisplay.tsx     # クーポン表示
```

### **データ取得**
```typescript
// クーポン取得クエリ
supabase
  .from('user_coupons')
  .select(`
    *,
    facility_coupons (
      *,
      pet_facilities (name)
    )
  `)
  .eq('user_id', user.id)
  .is('used_at', null)
  .gte('facility_coupons.validity_end', new Date().toISOString());
```

---

## 🎨 **デザイン特徴**

### **アニメーション**
- ✅ スムーズな開閉アニメーション
- ✅ ホバー時のスケール効果
- ✅ 回転エフェクト（開閉時）

### **レスポンシブ対応**
- 📱 **モバイル**: 右下固定配置
- 💻 **デスクトップ**: ボトムナビゲーションと調和
- 🎯 **タッチフレンドリー**: 十分なタップエリア

---

## 🚀 **セットアップ手順**

### **1. 基本機能（既に完了）**
```bash
# 実装済み
✅ FloatingActionButton.tsx 作成
✅ Layout.tsx に組み込み
✅ クーポン表示機能
```

### **2. ワクチン証明書機能を有効化**
```sql
-- 1. Supabaseでテーブル作成
\i create_vaccine_certificates_table.sql

-- 2. サンプルデータ投入（オプション）
INSERT INTO vaccine_certificates (...);
```

```typescript
// 3. FloatingActionButton.tsx でコメントアウトを解除
const { data: vaccinesData } = await supabase
  .from('vaccine_certificates')
  .select(`...`);
```

---

## 🧪 **テスト方法**

### **動作確認チェックリスト**
```
□ FABが画面右下に表示される
□ タップでメニューが開く
□ クーポンボタンが表示される
□ クーポン選択でモーダルが開く
□ クーポン一覧が表示される
□ クーポンをタップして詳細表示
□ 閉じるボタンが動作する
□ モバイルでも適切に表示される
```

### **エラー対応**
```
問題: FABが表示されない
→ ログイン状態を確認
→ Layout.tsx のインポートを確認

問題: クーポンが0件
→ ユーザーがクーポンを取得しているか確認
→ Supabaseクエリの結果を確認

問題: アニメーションが動作しない
→ Tailwind CSS の animate-in が利用可能か確認
```

---

## 🔄 **今後の拡張予定**

### **Phase 2: ワクチン証明書**
- 🛡️ ワクチン証明書の表示機能
- 📅 有効期限アラート
- 🏥 動物病院情報の表示

### **Phase 3: 追加機能**
- 📍 近くの施設への通知
- 🔔 期限切れアラート
- 📊 使用履歴の表示

---

## 📋 **運用上の注意**

### **パフォーマンス**
- データは初回のみ取得、キャッシュ活用
- 画像は遅延読み込み対応
- アニメーションはGPUアクセラレーション使用

### **セキュリティ**
- RLSポリシーで適切なアクセス制御
- クーポン使用時のトークン検証
- 証明書画像のセキュアな配信

### **ユーザビリティ**
- 直感的なアイコンとラベル使用
- 十分なコントラスト比確保
- アクセシビリティ対応（スクリーンリーダー等）

---

**🎉 お店での実用性を重視した、使いやすいFABが完成しました！** 